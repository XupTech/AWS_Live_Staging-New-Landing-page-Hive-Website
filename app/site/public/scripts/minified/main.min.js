function MainService($http,$q){var mainService={getData:function(config,data){data.skip>1?data.skip=(parseInt(data.skip)-1)*data.limit:data.skip=0;var deferred=$q.defer();return $http({method:config.method,url:config.url,data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getSearchData:function(config,data){var deferred=$q.defer();return $http({method:config.method,url:config.url,data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getCurrentUsers:function(user){var deferred=$q.defer();return $http({method:"POST",url:"site/users/currentUser",data:{currentUserData:user}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getCurrentTaskers:function(userid){var deferred=$q.defer();return $http({method:"POST",url:"site/users/currentTasker",data:{currentUserData:userid}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},setCurrentUserValue:function(value){console.log("set"),mainService.currentValue=value},getCurrentUserValue:function(){return mainService.currentValue},getsubcategory:function(categoryid){var deferred=$q.defer();return $http({method:"POST",url:"site/category/getsubcategory",data:{categoryid:categoryid}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},searchSuggestions:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/landing/search-suggestions",data:{data:data}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},settings:function(){var deferred=$q.defer();return $http({method:"GET",url:"/settings/general"}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},subscription:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/landing/subscription",data:{email:data}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},searchchildSuggestions:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/landing/search-childSuggestions",data:{data:data}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getSliderList:function(limit,skip){var deferred=$q.defer();return $http({method:"GET",url:"/slider/list/?limit="+limit+"&skip="+skip}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getLanguage:function(){var deferred=$q.defer();return $http({method:"GET",url:"/site/landing/getLanguage"}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getBgimage:function(){var deferred=$q.defer();return $http({method:"GET",url:"/site/landing/getBgimage"}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},gettaskersignupimage:function(){var deferred=$q.defer();return $http({method:"GET",url:"/site/landing/gettaskersignupimage"}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getsetting:function(){var deferred=$q.defer();return $http({method:"GET",url:"/site/landing/getsetting"}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getDefaultLanguage:function(data){var deferred=$q.defer();return $http({method:"GET",url:"/site/landing/getDefaultLanguage?name="+data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getSocialNetworks:function(){var deferred=$q.defer();return $http({method:"GET",url:"/site/landing/getSocialNetworks"}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getDefaultCurrency:function(data){var deferred=$q.defer();return $http({method:"GET",url:"/site/landing/getDefaultCurrency?name="+data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getCurrency:function(){var deferred=$q.defer();return $http({method:"GET",url:"/site/landing/getCurrency"}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getseosetting:function(){var deferred=$q.defer();return $http({method:"GET",url:"/site/landing/getseosetting"}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getwidgets:function(){var deferred=$q.defer();return $http({method:"GET",url:"/site/landing/getwidgets"}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getNotificationsCount:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/notifications/count",data:data}).then(function(data){deferred.resolve(data.data.count)},function(err){deferred.reject(err)}),deferred.promise},getMainData:function(username){var deferred=$q.defer();return $http({method:"POST",url:"/site/main"}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getmorecategory:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/landing/getmorecategory",data:{data:data}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},otpverifications:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/otpverifications",data:{data:data}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getTransalatePage:function(pageId,languagename){var deferred=$q.defer(),data={};return data.page=pageId,data.language=languagename,$http({method:"POST",url:"/site/landing/getTransalatePage",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getPage:function(languagename){var deferred=$q.defer(),data={};return data.language=languagename,$http({method:"POST",url:"/site/landing/getPages",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getTransalatePageNames:function(languagename){var deferred=$q.defer(),data={};return data.language=languagename,$http({method:"POST",url:"/site/landing/getTransalatePageNames",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getpaymentMethod:function(){var deferred=$q.defer();return $http({method:"GET",url:"/site/landing/payment_method"}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},generateotp:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/generateotp",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},checkMobileExists:function(type,phone){var deferred=$q.defer(),data={};return data.type=type,data.phone=phone,$http({method:"POST",url:"/site/account/settings/checkmobileexist",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise}};return mainService}function notify($rootScope){var socket=io.connect("/notify");return{on:function(eventName,callback){socket.on(eventName,function(){var args=arguments;$rootScope.$apply(function(){callback.apply(socket,args)})})},emit:function(eventName,data,callback){socket.emit(eventName,data,function(){var args=arguments;$rootScope.$apply(function(){callback&&callback.apply(socket,args)})})}}}function taskerloginCtrl($scope,$rootScope,$location,AuthenticationService,$state,toastr,$cookieStore,socket,$translate){AuthenticationService.ClearCredentials(),$scope.login=function(){AuthenticationService.taskerLogin($scope.username,$scope.password,function(response){!$scope.username||response.user!=$scope.username&&response.email!=$scope.username&&response.phone!=$scope.username?$scope.error=response.message||"INVALIDUSERNAME_PASSWORD":(AuthenticationService.SetCredentials(response.user,response.user_id,response.token,response.user_type,response.tasker_status),localStorage.removeItem("TaskerData"),$rootScope.$emit("notification",{user:response.user_id,type:response.user_type}),$rootScope.$emit("webNotification",{user:response.user_id,type:response.user_type}),$state.go("account",{},{reload:!0}))},function(err){$scope.error=err})}}function userloginCtrl($scope,$http,$rootScope,$uibModal,$location,AuthenticationService,$state,toastr,$cookieStore,socket,PreviousState,$window,$translate,MainService,routes,$stateParams){var ulgc=this;"tasker"==$stateParams.type?($scope.activeUserTab=!1,$scope.activeTaskerTab=!0):($scope.activeUserTab=!0,$scope.activeTaskerTab=!1),ulgc.showuserotpform=!1,ulgc.showtaskermobileform=!0,ulgc.showtaskerotpform=!1,AuthenticationService.ClearCredentials(),ulgc.generateotp=function(isValid,type,phone){isValid&&AuthenticationService.phonecheck(type,phone).then(function(err,data){if("Phone Number Exist"==err.message){(data={}).code=phone.code,data.phone=phone.number,MainService.generateotp(data).then(function(response,err){response&&("user"==type?(ulgc.showuserotpform=!0,"development"==response.sms&&(ulgc.userotp=response.otpkey,ulgc.oldotp=response.otpkey),toastr.success("OTP sent successfully")):(ulgc.showtaskerotpform=!0,"development"==response.sms&&(ulgc.taskerotp=response.otpkey,ulgc.oldotp=response.otpkey),toastr.success("OTP sent successfully")))})}else"Phone Number not exist"==err.message&&toastr.error("Please enter your registered mobile number")})},ulgc.resendotp=function(type){if("user"==type){(data={}).code=ulgc.usermobile.code,data.phone=ulgc.usermobile.number}else{var data={};data.code=ulgc.taskermobile.code,data.phone=ulgc.taskermobile.number}MainService.generateotp(data).then(function(response,err){response&&("user"==type?(ulgc.showuserotpform=!0,"development"==response.sms&&(ulgc.userotp=response.otpkey,ulgc.oldotp=response.otpkey),toastr.success("OTP sent successfully")):(ulgc.showtaskerotpform=!0,"development"==response.sms&&(ulgc.taskerotp=response.otpkey,ulgc.oldotp=response.otpkey),toastr.success("OTP sent successfully")))})},ulgc.checkotp=function(valid,type,otp){if(valid)if("user"==type)if(ulgc.oldotp==otp){(data={}).phone=ulgc.usermobile,ulgc.showuserotpform=!1,MainService.getData(routes.userLogin,data).then(function(userdata,err){if(err)toastr.error("Unable to fetch data");else if(AuthenticationService.SetCredentials(userdata.user,userdata.user_id,userdata.token,userdata.user_type,userdata.status,0,userdata.avatar),localStorage.removeItem("TaskerData"),$rootScope.$emit("notification",{user:userdata.user_id,type:userdata.user_type}),$rootScope.$emit("webNotification",{user:userdata.user_id,type:userdata.user_type}),$cookieStore.get("categeoryslug")){var tempdata=$cookieStore.get("categeoryslug");$cookieStore.remove("categeoryslug"),$state.go("search",{task:tempdata.task,query:JSON.stringify(tempdata)},{reload:!1})}else $rootScope.currentState&&"becometasker.step1"!==$rootScope.currentState.name?$state.go($rootScope.currentState.name,$rootScope.currentparams,{reload:!0}):$state.go("landing",{},{reload:!0})})}else toastr.error("The OTP entered is incorrect.");else if(ulgc.oldotp==otp){var data={};data.phone=ulgc.taskermobile,ulgc.showtaskerotpform=!1,AuthenticationService.taskerLogin(data).then(function(taskerdata,err){err?toastr.error("Unable to fetch data"):(AuthenticationService.SetCredentials(taskerdata.user,taskerdata.user_id,taskerdata.token,taskerdata.user_type,taskerdata.status,0,taskerdata.avatar),localStorage.removeItem("TaskerData"),$rootScope.$emit("notification",{user:taskerdata.user_id,type:taskerdata.user_type}),$rootScope.$emit("webNotification",{user:taskerdata.user_id,type:taskerdata.user_type}),$rootScope.currentState&&"becometasker.step1"!==$rootScope.currentState.name&&"search"!==$rootScope.currentState.name?$state.go($rootScope.currentState.name,$rootScope.currentparams,{reload:!0}):$state.go("landing",{},{reload:!0}))})}else toastr.error("The OTP entered is incorrect.")},$scope.facebookLogin=function(){var top=(window.outerHeight-650)/2,left=(window.outerWidth-1e3)/2;$window.open("/auth/facebook","facebook_login","width=1000,height=650,scrollbars=0,top="+top+",left="+left)},$window.app={authState:function(data){var username=data.username;username=username.replace(/^"(.*)"$/,"$1");var _id=data._id;_id=_id.replace(/^"(.*)"$/,"$1");var role=data.role;role=role.replace(/^"(.*)"$/,"$1");var token=data.token;token=token.replace(/^"(.*)"$/,"$1"),AuthenticationService.SetCredentials(username,_id,token,"user",1),$rootScope.$emit("notification",{user:_id,type:"user"}),$rootScope.$emit("webNotification",{user:_id,type:"user"}),$rootScope.currentState?$state.go($rootScope.currentState.name,$rootScope.currentparams,{reload:!0}):$state.go("landing",{},{reload:!0})},failauthState:function(data){var err=data.err.error[0],str=err.match(/\$(.*)/);if(str){var currenterr=str[0].substring(1,5);(user=currenterr)&&$translate("Username already exist").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})}else toastr.error(err);$rootScope.currentState?$state.go($rootScope.currentState.name,$rootScope.currentparams,{reload:!0}):$state.go("landing",{},{reload:!0})}},$scope.user={},$scope.logged=!1,$scope.byebye=!1,$scope.salutation=!1}function registerCtrl($scope,$compile,$rootScope,uiCalendarConfig,$uibModal,CategoryserviceResolve,$location,AuthenticationService,$state,$filter,toastr,$cookieStore,$stateParams,$translate,accountService,NgMap,$timeout,MainService,routes,settingsResolve){function taskerLatLongAddress(lat,long){console.log("worklocation lat long",lat,long);var latlng=new google.maps.LatLng(lat,long);console.log("latlng",latlng);var geocoder=geocoder=new google.maps.Geocoder;geocoder.geocode({latLng:latlng},function(results,status){status==google.maps.GeocoderStatus.OK&&results[1]&&(console.log("results[1]",results[1]),$scope.$apply(function(){rgc.data.availability_address=results[1].formatted_address,rgc.taskerareaaddress=results[1].formatted_address,rgc.temp_taskerareaaddress=rgc.taskerareaaddress}))}),rgc.data.location.lng=long,rgc.data.location.lat=lat}function calculate_age(birth_month,birth_day,birth_year,dobdate){console.log("dobdate",dobdate);var names=dobdate.getDate(),month=dobdate.getMonth()+1,year=dobdate.getFullYear(),date=new Date,currentDate=date.getDate(),currentMonth=date.getMonth()+1,conditionyear=date.getFullYear()-18;return conditionyear==year?month<=currentMonth&&names<=currentDate:!(conditionyear<year)&&(conditionyear>year||void 0)}var rgc=this;rgc.showUserRegisterForm=!1,rgc.showuserotpform=!1,rgc.showusermobileform=!0,rgc.showtaskermobileform=!0,rgc.showtaskerotpform=!1,rgc.UserDetails={},$scope.location={},rgc.UserDetails.address={},rgc.type=$stateParams.type,rgc.settings=settingsResolve.settings,rgc.checkTaskerDetail=!0,$rootScope.user_mobile={},$rootScope.userotp="",$rootScope.taskerotp="",$scope.maps=[],$scope.$on("mapInitialized",function(evt,evtMap){$scope.maps.push(evtMap)}),$scope.oneAtATime=!0,$scope.tabs=[{active:!0},{active:!1},{active:!1}];var availableTimingSlotList=[{slot:0,time:"12AM - 1AM",selected:!1},{slot:1,time:"1AM - 2AM",selected:!1},{slot:2,time:"2AM - 3AM",selected:!1},{slot:3,time:"3AM - 4AM",selected:!1},{slot:4,time:"4AM - 5AM",selected:!1},{slot:5,time:"5AM - 6AM",selected:!1},{slot:6,time:"6AM - 7AM",selected:!1},{slot:7,time:"7AM - 8AM",selected:!1},{slot:8,time:"8AM - 9AM",selected:!1},{slot:9,time:"9AM - 10AM",selected:!1},{slot:10,time:"10AM - 11AM",selected:!1},{slot:11,time:"11AM - 12PM",selected:!1},{slot:12,time:"12PM - 1PM",selected:!1},{slot:13,time:"1PM - 2PM",selected:!1},{slot:14,time:"2PM - 3PM",selected:!1},{slot:15,time:"3PM - 4PM",selected:!1},{slot:16,time:"4PM - 5PM",selected:!1},{slot:17,time:"5PM - 6PM",selected:!1},{slot:18,time:"6PM - 7PM",selected:!1},{slot:19,time:"7PM - 8PM",selected:!1},{slot:20,time:"8PM - 9PM",selected:!1},{slot:21,time:"9PM - 10PM",selected:!1},{slot:22,time:"10PM - 11PM",selected:!1},{slot:23,time:"11PM - 12AM",selected:!1}],workingDays=[{day:"Sunday",slot:JSON.parse(JSON.stringify(availableTimingSlotList)),selected:!1,wholeday:!1},{day:"Monday",slot:JSON.parse(JSON.stringify(availableTimingSlotList)),selected:!1,wholeday:!1},{day:"Tuesday",slot:JSON.parse(JSON.stringify(availableTimingSlotList)),selected:!1,wholeday:!1},{day:"Wednesday",slot:JSON.parse(JSON.stringify(availableTimingSlotList)),selected:!1,wholeday:!1},{day:"Thursday",slot:JSON.parse(JSON.stringify(availableTimingSlotList)),selected:!1,wholeday:!1},{day:"Friday",slot:JSON.parse(JSON.stringify(availableTimingSlotList)),selected:!1,wholeday:!1},{day:"Saturday",slot:JSON.parse(JSON.stringify(availableTimingSlotList)),selected:!1,wholeday:!1}];$scope.clearSlots=function(day,wholeday,parentkey,event){angular.forEach(rgc.data.working_days,function(days,key){angular.forEach(days.slot,function(slot,skey){day&&!wholeday&&parentkey==key&&(slot.selected=!1)})}),event.stopPropagation()},rgc.submitPersonalInfo=function(valid){$scope.$on("mapInitialized",function(evt,evtMap){$scope.maps.push(evtMap)}),valid&&(rgc.data.avatar=rgc.myCroppedImage,rgc.data.avatarBase64=rgc.myCroppedImage,rgc.data.radius||(rgc.data.radius=50),navigator.geolocation.getCurrentPosition(function(pos){console.log("pos",pos),taskerLatLongAddress(pos.coords.latitude,pos.coords.longitude)},function(failure){$.getJSON("https://ipinfo.io/geo",function(response){var loc=response.loc.split(",");taskerLatLongAddress(loc[0],loc[1])})}),calculate_age(rgc.data.birthdate.month,rgc.data.birthdate.date,rgc.data.birthdate.year,rgc.data.WorkingDate)?(rgc.data.showCrop=!1,localStorage.setItem("TaskerData",JSON.stringify(rgc.data)),$scope.tabs[1].active=!0):$translate("YOUR AGE SHOULD BE 18").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)}))},rgc.submitWorkInfo=function(){localStorage.setItem("TaskerData",JSON.stringify(rgc.data)),$scope.tabs[2].active=!0,rgc.addnewcategories=rgc.categories.filter(function(data){return rgc.data.taskerskills.some(function(data2){return data2.childid==data._id})}).map(function(mapdata){return mapdata})},rgc.saveCatArray=function(){rgc.addnewcategories=rgc.categories.filter(function(data){return rgc.data.taskerskills.some(function(data2){return data2.childid==data._id})}).map(function(mapdata){return mapdata})},rgc.addCategory=function(category){$uibModal.open({animation:!0,templateUrl:"app/site/modules/tasker/views/addcategory.html",windowClass:"addcatpop",controller:"CategoriesModalInstanceCtrl",controllerAs:"ACP",resolve:{categories:function(){return rgc.categories}}}).result.then(function(selectedCategoryData){selectedCategoryData.hour_rate=selectedCategoryData.hour_rate/$scope.DefaultCurrency.value,MainService.getData(routes.addUpdateCat,selectedCategoryData).then(function(response){1===response.nModified&&$translate("UPDATED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)}),updateCat()}).catch(function(err){console.error("err = ",err),$translate("PLEASE ENTER THE VALID DATA").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})})})},"tasker"==$stateParams.type?(rgc.activeUserTab=!1,rgc.activeTaskerTab=!0):(rgc.activeUserTab=!0,rgc.activeTaskerTab=!1),rgc.generateotp=function(isValid,type,phone){isValid&&AuthenticationService.phonecheck(type,phone).then(function(err,data){if("Phone Number Exist"==err.message)$translate("SORRY PHONE NUMBER ALREADY EXIST").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)});else if("Phone Number not exist"==err.message){(data={}).code=phone.code,data.phone=phone.number,MainService.generateotp(data).then(function(response,err){response&&("user"==type?(rgc.showusermobileform=!1,rgc.showuserotpform=!0,"development"==response.sms&&(rgc.userotp=response.otpkey,rgc.oldotp=response.otpkey),toastr.success("OTP sent successfully")):(rgc.showtaskermobileform=!1,rgc.showtaskerotpform=!0,"development"==response.sms&&(rgc.taskerotp=response.otpkey,rgc.oldotp=response.otpkey),toastr.success("OTP sent successfully")))})}})},rgc.resendotp=function(type){if("user"==type){(data={}).code=rgc.UserDetails.phone.code,data.phone=rgc.UserDetails.phone.number}else{var data={};data.code=rgc.data.phone.code,data.phone=rgc.data.phone.number}MainService.generateotp(data).then(function(response,err){response&&("user"==type?(rgc.showusermobileform=!1,rgc.showuserotpform=!0,"development"==response.sms&&(rgc.userotp=response.otpkey,rgc.oldotp=response.otpkey),toastr.success("OTP sent successfully")):(rgc.showtaskermobileform=!1,rgc.showtaskerotpform=!0,"development"==response.sms&&(rgc.taskerotp=response.otpkey,rgc.oldotp=response.otpkey),toastr.success("OTP sent successfully")))})},rgc.checkotp=function(isvalid,type,otp){isvalid&&("user"==type?rgc.oldotp==otp?(rgc.showUserRegisterForm=!0,rgc.showuserotpform=!1,rgc.showusermobileform=!1):toastr.error("The OTP entered is incorrect."):rgc.oldotp==otp?(rgc.showtaskerotpform=!1,rgc.data.showCrop=!0,rgc.data.visibleValue=!1,rgc.data.avatarBase64=rgc.myCroppedImage,localStorage.setItem("TaskerData",JSON.stringify(rgc.data)),$state.go("becometasker.step1",{},{reload:!1})):toastr.error("The OTP entered is incorrect."))},rgc.registerUser=function(isValid){rgc.Error="";var today=$filter("date")(new Date,"yyyy-MM-dd HH:mm:ss");rgc.UserDetails.today=today,rgc.UserDetails.role=rgc.type,rgc.UserDetails.username=rgc.UserDetails.firstname+" "+rgc.UserDetails.lastname,isValid?MainService.getData(routes.userRegister,rgc.UserDetails).then(function(userdata){if(AuthenticationService.SetCredentials(userdata.user,userdata.user_id,userdata.token,userdata.user_type,userdata.status,0,userdata.avatar),$cookieStore.get("categeoryslug")){var tempdata=$cookieStore.get("categeoryslug");$cookieStore.remove("categeoryslug"),$state.go("search",{task:tempdata.task,query:JSON.stringify(tempdata)},{reload:!1})}else $state.go("landing",{},{reload:!0});$translate("REGISTER SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)})},function(err){$translate(err.data).then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})}):$translate("PLEASE FILL ALL MANDATORY FIELDS").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})},rgc.change=function(referalcode){referalcode&&AuthenticationService.checkreferal(referalcode).then(function(err,data){"Invalid referal code"==err.message?(rgc.UserDetails.referalcode="",$translate("INVALID REFERAL CODE").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})):"Success"==err.message&&$translate("VALID REFERAL CODE").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)})})},rgc.useremailchange=function(email){void 0!=email&&AuthenticationService.checkemail(email).then(function(err,data){"Email Exist"==err.message?$translate("SORRY EMAIL ID ALREADY EXIST").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)}):"Email not exist"==err.message&&rgc.UserDetails.email})},rgc.checkingphone=function(phone){void 0!=phone&&AuthenticationService.phonecheck(phone).then(function(err,data){"Phone Number Exist"==err.message?(console.log("number exists"),rgc.showotpform=!1,$translate("SORRY PHONE NUMBER ALREADY EXIST").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})):"Phone Number not exist"==err.message&&rgc.UserDetails.phone&&(console.log("number not exists"),rgc.showotpform=!0)})},rgc.taskeremailchange=function(email){void 0!=email&&AuthenticationService.checktaskeremail(email).then(function(err,data){if("Email Exist"==err.message)return rgc.checkTaskerDetail=!1,$translate("SORRY EMAIL ID ALREADY EXIST").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)}),!1;"Email not exist"==err.message&&(rgc.checkTaskerDetail=!0)})},rgc.taskerphone=function(phone){void 0!=phone&&AuthenticationService.taskerphone(phone).then(function(err,data){"Phone Exist"==err.message?(rgc.checkTaskerDetail=!1,$translate("SORRY PHONE NUMBER ALREADY EXIST").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})):"Phone not exist"==err.message&&(rgc.checkTaskerDetail=!0)})},rgc.categoryList=CategoryserviceResolve,rgc.radiusby=$rootScope.settings.distanceby,"km"==rgc.radiusby?rgc.radiusval=1e3:rgc.radiusval=1609.34,angular.forEach(rgc.categoryList,function(parentvalue,parentIndex){angular.forEach(parentvalue.category,function(value,index){0==index?(value.active=!0,value.terms=!1,value.quick_pitch="",value.hour_rate="",value.experience=""):(value.active=!1,value.terms=!1,value.quick_pitch="",value.hour_rate="",value.experience=""),angular.forEach(value.skills,function(skills){skills.selected=!1})})}),rgc.selectedcategory=[],rgc.selectedcategory=rgc.categoryList[0].category[0];AuthenticationService.GetCredentials();$scope.avatar="",rgc.data={gender:"",phone:"",birthdate:{year:"",month:"",date:""},WorkingDate:"",working_days:workingDays,avatar:"",next:"step2",taskerskills:[],Map:[]},rgc.data.radius=$rootScope.settings.tasker_radius,rgc.data=JSON.parse(localStorage.getItem("TaskerData"))||rgc.data,console.log("rgc.data",rgc.data),rgc.data.centerMap=rgc.data.location,rgc.data.WorkingDate?rgc.data.WorkingDate=new Date(rgc.data.WorkingDate):rgc.data.WorkingDate="",$scope.myImage="",rgc.myCroppedImage="",$scope.handleFileSelect=function(evt){var file=evt.currentTarget.files[0];if("1MB"==file.$errorParam||"pattern"==file.$error?(rgc.data.showCrop=!1,rgc.data.visibleValue=!1,file=null):(rgc.data.showCrop=!0,rgc.data.visibleValue=!0),file){var reader=new FileReader;reader.onload=function(evt){$scope.$apply(function($scope){$scope.myImage=evt.target.result})},reader.readAsDataURL(file)}},angular.forEach(rgc.data.taskerskills,function(taskerskills){angular.forEach(rgc.categoryList,function(categoryList){taskerskills.categoryid==categoryList._id&&(categoryList.terms=taskerskills.terms,categoryList.quick_pitch=taskerskills.quick_pitch,categoryList.hour_rate=taskerskills.hour_rate,categoryList.experience=taskerskills.experience,angular.forEach(taskerskills.skills,function(taskerskillArr){angular.forEach(categoryList.skills,function(categoryskillArr){categoryskillArr.tags==taskerskillArr.tags&&(categoryskillArr.selected=!0)})}))})}),accountService.getExperience().then(function(respo){rgc.experience=respo}),rgc.placeChanged=function(){rgc.data.address.line1="",rgc.data.address.line2="",rgc.data.address.city="",rgc.data.address.state="",rgc.data.address.country="",rgc.data.address.zipcode="",rgc.details={},rgc.place=this.getPlace(),rgc.data.tasker_area={},rgc.data.tasker_area.lng=rgc.place.geometry.location.lng(),rgc.data.tasker_area.lat=rgc.place.geometry.location.lat(),rgc.details.location=rgc.data.tasker_area,rgc.data.address.line1=rgc.place.formatted_address;var locationa=rgc.place;rgc.data.address.formatted_address=locationa.formatted_address,locationa.name&&(rgc.data.address.line1=locationa.name);for(i=0;i<locationa.address_components.length;i++)for(var j=0;j<locationa.address_components[i].types.length;j++)"neighborhood"==locationa.address_components[i].types[j]&&rgc.data.address.line1!=locationa.address_components[i].long_name&&(""!=rgc.data.address.line1?rgc.data.address.line1=rgc.data.address.line1+","+locationa.address_components[i].long_name:rgc.data.address.line1=locationa.address_components[i].long_name),"route"==locationa.address_components[i].types[j]&&rgc.data.address.line1!=locationa.address_components[i].long_name&&(""!=rgc.data.address.line2?rgc.data.address.line2=rgc.data.address.line2+","+locationa.address_components[i].long_name:rgc.data.address.line2=locationa.address_components[i].long_name),"street_number"==locationa.address_components[i].types[j]&&(""!=rgc.data.address.line2?rgc.data.address.line2=rgc.data.address.line2+","+locationa.address_components[i].long_name:rgc.data.address.line2=locationa.address_components[i].long_name),"sublocality_level_1"==locationa.address_components[i].types[j]&&(""!=rgc.data.address.line2?rgc.data.address.line2=rgc.data.address.line2+","+locationa.address_components[i].long_name:rgc.data.address.line2=locationa.address_components[i].long_name),"locality"==locationa.address_components[i].types[j]&&(rgc.data.address.city=locationa.address_components[i].long_name),"country"==locationa.address_components[i].types[j]&&(rgc.data.address.country=locationa.address_components[i].long_name),"postal_code"==locationa.address_components[i].types[j]&&(rgc.data.address.zipcode=locationa.address_components[i].long_name),"administrative_area_level_1"!=locationa.address_components[i].types[j]&&"administrative_area_level_2"!=locationa.address_components[i].types[j]||(rgc.data.address.state=locationa.address_components[i].long_name);for(var componentForm={street_number:"short_name",route:"long_name",locality:"long_name",administrative_area_level_1:"short_name",country:"long_name",postal_code:"short_name"},i=0;i<locationa.address_components.length;i++){var addressType=locationa.address_components[i].types[0];if(componentForm[addressType]){var val=locationa.address_components[i][componentForm[addressType]];componentForm[addressType].value=val}}},rgc.taskerareaChanged=function(){rgc.place=this.getPlace(),rgc.data.location={},rgc.data.location.lng=rgc.place.geometry.location.lng(),rgc.data.location.lat=rgc.place.geometry.location.lat(),rgc.data.tasker_area={},rgc.data.tasker_area.lng=rgc.place.geometry.location.lng(),rgc.data.tasker_area.lat=rgc.place.geometry.location.lat(),rgc.data.availability_address=rgc.place.formatted_address,rgc.data.radius||(rgc.data.radius=50)},rgc.filter={},rgc.format="dd-MM-yyyy",rgc.filterDate=function(){rgc.data.birthdate={},console.log("inside",rgc.data.birthdate),console.log("rgc.data.WorkingDate",rgc.data.WorkingDate),rgc.data.birthdate.year=rgc.data.WorkingDate.getFullYear(),rgc.data.birthdate.month=rgc.data.WorkingDate.getMonth()+1,rgc.data.birthdate.date=rgc.data.WorkingDate.getDate(),console.log("ggg",rgc.data.birthdate.month,rgc.data.birthdate.date,rgc.data.birthdate.year),calculate_age(rgc.data.birthdate.month,rgc.data.birthdate.date,rgc.data.birthdate.year,rgc.data.WorkingDate)?(rgc.data.birthdate.year=rgc.data.WorkingDate.getFullYear(),rgc.data.birthdate.month=rgc.data.WorkingDate.getMonth()+1,rgc.data.birthdate.date=rgc.data.WorkingDate.getDate()):$translate("YOURS AGE SHOULD BE 18").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})},rgc.selectedCategory=function(parentindex,index){rgc.selectedcategory=$filter("filter")(rgc.categoryList[parentindex].category,{active:!0}),rgc.selectedcategory[0].active=!1,rgc.categoryList[parentindex].category[index].active=!0,rgc.selectedcategory=rgc.categoryList[parentindex].category[index],rgc.flag=!1},rgc.emailchange=function(email){void 0==email?$translate("INVALID EMAIL ID").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)}):AuthenticationService.checktaskeremail(email).then(function(err,data){"Email Exist"==err.message?$translate("SORRY EMAIL ID ALREADY EXIST").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)}):"Email not exist"==err.message&&$translate("VALID EMAIL ID").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)})})},rgc.phonechange=function(phone){void 0==phone?$translate("INVALID PHONE NUMBER").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)}):AuthenticationService.taskerphone(phone).then(function(err,data){"Phone Exist"==err.message?(rgc.data.phone={code:"",number:""},$translate("SORRY PHONE NUMBER ALREADY EXIST").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})):"Phone not exist"==err.message&&$translate("VALID PHONE NUMBER").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)})})},rgc.emptyLatLng=function(){rgc.data.tasker_area=void 0},rgc.data.location={},rgc.mapToInput=function(event){if(console.log("$scope.maps[0]=========",$scope.maps[0]),$scope.maps[0]){rgc.data.radius=parseInt($scope.maps[0].shapes.circle.radius/rgc.radiusval);var lat=$scope.maps[0].shapes.circle.center.lat(),lng=$scope.maps[0].shapes.circle.center.lng(),latlng=new google.maps.LatLng(lat,lng),geocoder=geocoder=new google.maps.Geocoder;geocoder.geocode({latLng:latlng},function(results,status){"OK"==status&&$scope.$apply(function(){rgc.place={},rgc.data.availability_address=results[0].formatted_address,rgc.taskerareaaddress=results[0].formatted_address,rgc.temp_taskerareaaddress=rgc.taskerareaaddress,rgc.data.location={},rgc.data.location.lng=lng,rgc.data.location.lat=lat})})}},$scope.surveyFiles=[],rgc.taskerData={},rgc.taskerData.profile_details=[],rgc.TaskerRegister=function(valid){if(rgc.taskerData={},valid>0){var selected_days=[];rgc.data.working_days&&angular.forEach(rgc.data.working_days,function(days){if(days.selected)if(days.wholeday)selected_days.push({day:days.day,slots:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],selected:days.selected,wholeday:days.wholeday});else{var selected_slots=[];angular.forEach(days.slot,function(slot){slot.selected&&selected_slots.push(slot.slot)}),selected_days.push({day:days.day,slots:selected_slots,selected:days.selected,wholeday:days.wholeday})}}),rgc.data.working_days=selected_days,rgc.taskerData=angular.copy(rgc.data),rgc.taskerData.taskerfile=[],rgc.taskerData.taskerfile=$scope.surveyFiles,AuthenticationService.BecomeTaskerRegister(rgc.taskerData,function(err,response){if(err)$translate("YOUR CREDENTIALS ARE WRONG"+err).then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)});else if("Email ID already exists"==response)toastr.error("Email ID already exists");else if("Unable to register"==response)toastr.error("Unable to register");else{var avatar=response.avatar?response.avatar:"";AuthenticationService.SetCredentials(response.firstname,response._id,"","tasker",response.status,0,avatar),$rootScope.$emit("eventName",{count:0}),localStorage.removeItem("TaskerData"),$translate("TASKER ADDED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)}),$state.go("landing",{},{reload:!0})}})}else $translate("SELECT ATLEAST ONE OF THE SKILLS").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})},rgc.taskerskills=angular.copy(rgc.data.taskerskills),rgc.addskills=function(valid){if(valid){var skills=$filter("filter")(rgc.selectedcategory.skills,{selected:!0});angular.forEach(skills,function(value){delete value.selected});var DefaultCurrency={};DefaultCurrency=$scope.DefaultCurrency;var data={categoryid:rgc.selectedcategory.parent,childid:rgc.selectedcategory._id,terms:rgc.selectedcategory.terms,quick_pitch:rgc.selectedcategory.quick_pitch,hour_rate:rgc.selectedcategory.hour_rate/DefaultCurrency[0].value,experience:rgc.selectedcategory.experience,file:rgc.selectedcategory.file,skills:skills},insetflag=!0;angular.forEach(rgc.taskerskills,function(value,key){value.childid==rgc.selectedcategory._id&&(insetflag=!1,rgc.taskerskills[key]=data)}),insetflag&&rgc.taskerskills.push(data),rgc.data.taskerskills=angular.copy(rgc.taskerskills),localStorage.setItem("TaskerData",JSON.stringify(rgc.data)),$translate("SKILLS UPDATED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)}),rgc.flag=!1}},rgc.emptyLatLng=function(temp_taskerareaaddress){temp_taskerareaaddress!=rgc.taskerareaaddress&&(rgc.data.location="")},accountService.getCategories().then(function(respo){rgc.categories=respo}),accountService.getExperience().then(function(respo){rgc.experiences=respo}),rgc.selectedCat=[],rgc.categoryModal=function(category){$uibModal.open({animation:!0,templateUrl:"app/site/modules/tasker/views/addcategory.html",controller:"ModalInstancecategory",controllerAs:"ACM",resolve:{experiences:function(){return rgc.experiences},defaultcurrency:function(){return $scope.DefaultCurrency},user:function(){return rgc.data},selectedCat:function(){return rgc.selectedCat},categories:function(){return rgc.categories},category:function(){return category}}}).result.then(function(selectedCategoryData){var mode=selectedCategoryData.mode;if(delete selectedCategoryData.mode,"Add"==mode)rgc.taskerskills.push(selectedCategoryData),rgc.selectedCat.push(selectedCategoryData.childid);else for(var i=0;i<rgc.taskerskills.length;i++)rgc.taskerskills[i].childid==selectedCategoryData.childid&&(rgc.taskerskills[i]=selectedCategoryData);rgc.data.taskerskills=rgc.taskerskills,localStorage.setItem("TaskerData",JSON.stringify(rgc.data)),rgc.addnewcategories=rgc.categories.filter(function(data){return rgc.data.taskerskills.some(function(data2){return data2.childid==data._id})}).map(function(mapdata){return mapdata})},function(){})},rgc.deletecategoryitem=function(data){var indexx=rgc.selectedCat.indexOf(data);rgc.selectedCat.splice(indexx,1),angular.forEach(rgc.addnewcategories,function(value,key){value._id==data&&rgc.addnewcategories.splice(key,1)}),angular.forEach(rgc.data.taskerskills,function(value,key){value.childid==data&&rgc.taskerskills.splice(key,1)})}}function DeactivateController($scope,$rootScope,$location,AuthenticationService,$state,$filter,toastr,$cookieStore){var user=AuthenticationService.GetCredentials();AuthenticationService.Logout(user).then(function(data){AuthenticationService.ClearCredentials(),$state.go("landing",{},{reload:!0})})}function AuthenticationService($http,$cookieStore,$rootScope,toastr,$q,$cookies,Upload,socket,notify){var service={};return service.taskerLogin=function(data,callback){var deferred=$q.defer();return $http({method:"post",url:"/site/taskerlogin",data:data}).then(function(response){deferred.resolve(response.data)},function(err){deferred.reject(err)}),deferred.promise},service.userLogin=function(username,password,callback){$http.post("/site",{username:username,password:password}).then(function(response){callback(response.data)},function(err){toastr.error("login error","Error")})},service.facebookuser=function(facebookdata){var deferred=$q.defer();return $http({method:"post",url:"/site/users/facebooksiteregister",data:{facebookdata:facebookdata}}).then(function(response){deferred.resolve(response.data)},function(err){deferred.reject(err)}),deferred.promise},service.checkreferal=function(referalcode){var deferred=$q.defer();return $http({method:"post",url:"/site/users/checkreferal",data:{referalcode:referalcode}}).then(function(response){deferred.resolve(response.data)},function(err){deferred.reject(err)}),deferred.promise},service.checkemail=function(email){var deferred=$q.defer();return $http({method:"post",url:"/site/users/checkemail",data:{email:email}}).then(function(response){deferred.resolve(response.data)},function(err){deferred.reject(err)}),deferred.promise},service.currentmsgcount=function(data){var deferred=$q.defer();return $http({method:"post",url:"/site/chat/msgcount",data:data}).then(function(response){deferred.resolve(response.data.count)},function(err){deferred.reject(err)}),deferred.promise},service.unreadmsg=function(data){var deferred=$q.defer();return $http({method:"Post",url:"/site/chat/unreadmsg",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},service.BecomeTaskerRegister=function(value,callback){if(value.files=[],value.taskerfile.length>0)for(var i=0;i<value.taskerfile.length;i++)delete value.taskerfile[i].$$hashKey,value.files.push(value.taskerfile[i]);$http({method:"post",url:"/site/users/taskerRegister",data:value}).then(function(response){callback(null,response.data)},function(err){callback(err,null)})},service.facebook=function(){var deferred=$q.defer();return $http({method:"get",url:"/auth/facebook"}).then(function(data){deferred.resolve(data)},function(err){deferred.reject(err)}),deferred.promise},service.getMyLastName=function(){var deferred=$q.defer();return FB.api("/me",{fields:"last_name"},function(response){!response||response.data.error?deferred.reject("Error occured"):deferred.resolve(response.data)}),deferred.promise},service.Logout=function(currentuser){var deferred=$q.defer();return $http({method:"Post",url:"/site-logout",data:currentuser}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},service.checktaskeremail=function(email){var deferred=$q.defer();return $http({method:"Post",url:"/site/users/checktaskeremail",data:{email:email}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},service.SetCredentials=function(user_name,user_id,token,user_type,tasker_status,vstatus,avatar){var authdata=token;$rootScope.siteglobals={currentUser:{username:user_name,user_id:user_id,authdata:authdata,user_type:user_type,tasker_status:tasker_status,verify_status:vstatus,avatar:avatar}},console.log($rootScope.siteglobals.currentUser.avatar),socket.emit("create room",{user:user_id}),notify.emit("join network",{user:user_id}),$http.defaults.headers.common.Authorization=authdata,$cookieStore.put("siteglobals",$rootScope.siteglobals),console.log("eventName",avatar),$rootScope.$emit("eventName",{avatar:avatar,count:0})},service.GetCredentials=function(){return $rootScope.siteglobals},service.isAuthenticated=function(){var isAuthenticated=!1;return $cookieStore.get("siteglobals")&&(isAuthenticated=!0),isAuthenticated},service.isTaskerAuthenticated=function(){var isAuthenticated=!1;return 0!=Object.keys($rootScope.siteglobals).length&&1==$rootScope.siteglobals.currentUser.tasker_status&&(isAuthenticated=!0),isAuthenticated},service.ClearCredentials=function(){$rootScope.siteglobals={},$cookieStore.remove("siteglobals"),$rootScope.$emit("eventName",{avatar:"",count:0})},service.phonecheck=function(type,phone){var deferred=$q.defer();return $http({method:"post",url:"/site/users/phonecheck",data:{type:type,phone:phone}}).then(function(response){deferred.resolve(response.data)},function(err){deferred.reject(err)}),deferred.promise},service.taskerphone=function(phone){var deferred=$q.defer();return $http({method:"Post",url:"/site/users/taskerphone",data:{phone:phone}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},service}function becomeTaskerCtrl($scope,$compile,uiCalendarConfig,$uibModal,$state,$cookieStore,CategoryserviceResolve,$filter,toastr,AuthenticationService,$rootScope,$location,accountService,$translate,NgMap,$timeout){function taskerLatLongAddress(lat,long){var latlng=new google.maps.LatLng(lat,long),geocoder=geocoder=new google.maps.Geocoder;geocoder.geocode({latLng:latlng},function(results,status){status==google.maps.GeocoderStatus.OK&&results[1]&&$scope.$apply(function(){btc.data.availability_address=results[1].formatted_address,btc.taskerareaaddress=results[1].formatted_address,btc.temp_taskerareaaddress=btc.taskerareaaddress})}),btc.data.location.lng=long,btc.data.location.lat=lat}function calculate_age(birth_month,birth_day,birth_year,dobdate){var names=dobdate.getDate(),month=dobdate.getMonth()+1,year=dobdate.getFullYear();console.log("names,month,year",names,month,year);var date=new Date,currentDate=date.getDate(),currentMonth=date.getMonth()+1,conditionyear=date.getFullYear()-18;return console.log("names,month,year",conditionyear,currentMonth,currentDate),conditionyear==year?month<=currentMonth&&names<=currentDate:!(conditionyear<year)&&(conditionyear>year||void 0)}var btc=this;$scope.oneAtATime=!0;var workingDays=[{day:"Sunday",hour:{morning:!1,afternoon:!1,evening:!1},not_working:!0},{day:"Monday",hour:{morning:!1,afternoon:!1,evening:!1},not_working:!0},{day:"Tuesday",hour:{morning:!1,afternoon:!1,evening:!1},not_working:!0},{day:"Wednesday",hour:{morning:!1,afternoon:!1,evening:!1},not_working:!0},{day:"Thursday",hour:{morning:!1,afternoon:!1,evening:!1},not_working:!0},{day:"Friday",hour:{morning:!1,afternoon:!1,evening:!1},not_working:!0},{day:"Saturday",hour:{morning:!1,afternoon:!1,evening:!1},not_working:!0}],workingTimes={};workingTimes.morning={from:moment.tz(new Date(99,5,24,8,0,0,0),$scope.date.timezone).format($scope.date.time_format),to:moment.tz(new Date(99,5,24,12,0,0,0),$scope.date.timezone).format($scope.date.time_format)},workingTimes.afternoon={from:moment.tz(new Date(99,5,24,12,0,0,0),$scope.date.timezone).format($scope.date.time_format),to:moment.tz(new Date(99,5,24,16,0,0,0),$scope.date.timezone).format($scope.date.time_format)},workingTimes.evening={from:moment.tz(new Date(99,5,24,16,0,0,0),$scope.date.timezone).format($scope.date.time_format),to:moment.tz(new Date(99,5,24,20,0,0,0),$scope.date.timezone).format($scope.date.time_format)},btc.workingDays=workingDays;var DaysData=[{Morning:"MORNING",afternoon:"AFTERNOON",evening:"EVENING",Save:"SAVE"}];angular.forEach(btc.workingDays,function(workingDays,key){angular.forEach(antsc.tasker.working_days,function(UserWorkingdays){UserWorkingdays.day==workingDays.day&&(btc.workingDays[key]=UserWorkingdays)})}),btc.categoryList=CategoryserviceResolve,btc.radiusby=$rootScope.settings.distanceby,"km"==btc.radiusby?btc.radiusval=1e3:btc.radiusval=1609.34,angular.forEach(btc.categoryList,function(parentvalue,parentIndex){angular.forEach(parentvalue.category,function(value,index){0==index?(value.active=!0,value.terms=!1,value.quick_pitch="",value.hour_rate="",value.experience=""):(value.active=!1,value.terms=!1,value.quick_pitch="",value.hour_rate="",value.experience=""),angular.forEach(value.skills,function(skills){skills.selected=!1})})}),btc.selectedcategory=[],btc.selectedcategory=btc.categoryList[0].category[0];var user=AuthenticationService.GetCredentials();$scope.avatar="",btc.data={gender:"",birthdate:{year:"",month:"",date:""},working_days:workingDays,avatar:"",next:"step2",taskerskills:[],Map:[]},btc.data=$cookieStore.get("TaskerData")||btc.data,btc.data.centerMap=btc.data.location,btc.WorkingDate,$scope.visibleValue=!1,$scope.myImage="",btc.myCroppedImage="",$scope.handleFileSelect=function(evt){var file=evt.currentTarget.files[0];if("1MB"==file.$errorParam||"pattern"==file.$error?($scope.visibleValue=!1,file=null):$scope.visibleValue=!0,file){var reader=new FileReader;reader.onload=function(evt){$scope.$apply(function($scope){$scope.myImage=evt.target.result})},reader.readAsDataURL(file)}},angular.forEach(btc.data.taskerskills,function(taskerskills){angular.forEach(btc.categoryList,function(categoryList){taskerskills.categoryid==categoryList._id&&(categoryList.terms=taskerskills.terms,categoryList.quick_pitch=taskerskills.quick_pitch,categoryList.hour_rate=taskerskills.hour_rate,categoryList.experience=taskerskills.experience,angular.forEach(taskerskills.skills,function(taskerskillArr){angular.forEach(categoryList.skills,function(categoryskillArr){categoryskillArr.tags==taskerskillArr.tags&&(categoryskillArr.selected=!0)})}))})}),accountService.getExperience().then(function(respo){btc.experience=respo}),btc.placeChanged=function(){btc.data.address.line1="",btc.data.address.line2="",btc.data.address.city="",btc.data.address.state="",btc.data.address.country="",btc.data.address.zipcode="",btc.details={},btc.place=this.getPlace(),btc.data.tasker_area={},btc.data.tasker_area.lng=btc.place.geometry.location.lng(),btc.data.tasker_area.lat=btc.place.geometry.location.lat(),btc.details.location=btc.data.tasker_area,btc.data.address.line1=btc.place.formatted_address;var locationa=btc.place;locationa.name&&(btc.data.address.line1=locationa.name);for(i=0;i<locationa.address_components.length;i++)for(var j=0;j<locationa.address_components[i].types.length;j++)"neighborhood"==locationa.address_components[i].types[j]&&btc.data.address.line1!=locationa.address_components[i].long_name&&(""!=btc.data.address.line1?btc.data.address.line1=btc.data.address.line1+","+locationa.address_components[i].long_name:btc.data.address.line1=locationa.address_components[i].long_name),"route"==locationa.address_components[i].types[j]&&btc.data.address.line1!=locationa.address_components[i].long_name&&(""!=btc.data.address.line2?btc.data.address.line2=btc.data.address.line2+","+locationa.address_components[i].long_name:btc.data.address.line2=locationa.address_components[i].long_name),"street_number"==locationa.address_components[i].types[j]&&(""!=btc.data.address.line2?btc.data.address.line2=btc.data.address.line2+","+locationa.address_components[i].long_name:btc.data.address.line2=locationa.address_components[i].long_name),"sublocality_level_1"==locationa.address_components[i].types[j]&&(""!=btc.data.address.line2?btc.data.address.line2=btc.data.address.line2+","+locationa.address_components[i].long_name:btc.data.address.line2=locationa.address_components[i].long_name),"locality"==locationa.address_components[i].types[j]&&(btc.data.address.city=locationa.address_components[i].long_name),"country"==locationa.address_components[i].types[j]&&(btc.data.address.country=locationa.address_components[i].long_name),"postal_code"==locationa.address_components[i].types[j]&&(btc.data.address.zipcode=locationa.address_components[i].long_name),"administrative_area_level_1"!=locationa.address_components[i].types[j]&&"administrative_area_level_2"!=locationa.address_components[i].types[j]||(btc.data.address.state=locationa.address_components[i].long_name);for(var componentForm={street_number:"short_name",route:"long_name",locality:"long_name",administrative_area_level_1:"short_name",country:"long_name",postal_code:"short_name"},i=0;i<locationa.address_components.length;i++){var addressType=locationa.address_components[i].types[0];if(componentForm[addressType]){var val=locationa.address_components[i][componentForm[addressType]];componentForm[addressType].value=val}}},btc.taskerareaChanged=function(){btc.place=this.getPlace(),btc.data.location={},btc.data.location.lng=btc.place.geometry.location.lng(),btc.data.location.lat=btc.place.geometry.location.lat(),btc.data.availability_address=btc.place.formatted_address;var dummy=btc.place.address_components.filter(function(value){return"locality"==value.types[0]}).map(function(data){return data});btc.dummyAddress=dummy.length},btc.filter={},btc.format="dd-MM-yyyy",btc.filterDate=function(){btc.data.birthdate.year=btc.WorkingDate.getFullYear(),btc.data.birthdate.month=btc.WorkingDate.getMonth()+1,btc.data.birthdate.date=btc.WorkingDate.getDate(),console.log("ggg",btc.data.birthdate.month,btc.data.birthdate.date,btc.data.birthdate.year),calculate_age(btc.data.birthdate.month,btc.data.birthdate.date,btc.data.birthdate.year,btc.WorkingDate)?(btc.data.birthdate.year=btc.WorkingDate.getFullYear(),btc.data.birthdate.month=btc.WorkingDate.getMonth()+1,btc.data.birthdate.date=btc.WorkingDate.getDate()):$translate("YOURS AGE SHOULD BE 18").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})},btc.selectedCategory=function(parentindex,index){btc.selectedcategory=$filter("filter")(btc.categoryList[parentindex].category,{active:!0}),btc.selectedcategory[0].active=!1,btc.categoryList[parentindex].category[index].active=!0,btc.selectedcategory=btc.categoryList[parentindex].category[index],btc.flag=!1},btc.booleanValue=!1,btc.emailchange=function(email){void 0==email?$translate("INVALID EMAIL ID").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)}):AuthenticationService.checktaskeremail(email).then(function(err,data){"Email Exist"==err.message?(btc.booleanValue=!0,$translate("SORRY EMAIL ID ALREADY EXIST").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})):"Email not exist"==err.message&&(btc.booleanValue=!1,$translate("VALID EMAIL ID").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)}))})},btc.taskernamechange=function(tasker){void 0==tasker?$translate("INVALID TASKER").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)}):AuthenticationService.taskername(tasker).then(function(err,data){"Tasker Exist"==err.message?(btc.booleanValue=!0,btc.data.username="",$translate("SORRY USERNAME ALREADY EXIST").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})):"Tasker not exist"==err.message&&(btc.booleanValue=!1,$translate("VALID USERNAME").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)}))})},btc.phonechange=function(phone){void 0==phone?$translate("INVALID PHONE NUMBER").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)}):AuthenticationService.taskerphone(phone).then(function(err,data){"Phone Exist"==err.message?(btc.data.phone={code:"",number:""},btc.booleanValue=!0,$translate("SORRY PHONE NUMBER ALREADY EXIST").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})):"Phone not exist"==err.message&&(btc.booleanValue=!1,$translate("VALID PHONE NUMBER").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)}))})},btc.emptyLatLng=function(){btc.data.tasker_area=void 0},btc.SubmitinfoTasker=function(valid){valid?(btc.data.avatarBase64=btc.myCroppedImage,1==btc.booleanValue?$translate("SORRY EMAIL ID ALREADY EXIST").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)}):void 0!==btc.data.tasker_area&&void 0!==btc.data.tasker_area.lat&&void 0!==btc.data.tasker_area.lng?void 0!==btc.data.phone&&void 0!==btc.data.phone.code&&void 0!==btc.data.phone.number?accountService.checkphoneno(btc.data.phone).then(function(response){response.length>0?$translate("Phone Number Already Existed!").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)}):($cookieStore.put("TaskerData",btc.data),$state.go("becometasker."+btc.data.next,{},{reload:!1}))}):$translate("Phone Number is required!").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)}):$translate("Invalid City").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})):$translate("PLEASE FILL ALL MANDATORY FIELDS").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})},btc.data.location={},$scope.maps=[],btc.SubmitTasker=function(page,valid){$scope.$on("mapInitialized",function(evt,evtMap){$scope.maps.push(evtMap)}),valid&&(btc.data.avatar=btc.myCroppedImage,btc.data.radius||(btc.data.radius=50),btc.taskerareaaddress||navigator.geolocation.getCurrentPosition(function(pos){taskerLatLongAddress(pos.coords.latitude,pos.coords.longitude)},function(failure){$.getJSON("https://ipinfo.io/geo",function(response){var loc=response.loc.split(",");taskerLatLongAddress(loc[0],loc[1])})}),btc.data.avatar&&1!=page?($cookieStore.put("TaskerData",btc.data),$state.go("becometasker."+btc.data.next,{},{reload:!1})):btc.data.birthdate.month&&btc.data.birthdate.date&&btc.data.birthdate.year?calculate_age(btc.data.birthdate.month,btc.data.birthdate.date,btc.data.birthdate.year,btc.WorkingDate)?($cookieStore.put("TaskerData",btc.data),$state.go("becometasker."+btc.data.next,{},{reload:!1})):$translate("YOURS AGE SHOULD BE 18").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)}):toastr.error("please select age"))},btc.mapToInput=function(event){if($scope.maps[0]){btc.data.radius=parseInt($scope.maps[0].shapes.circle.radius/btc.radiusval);var lat=$scope.maps[0].shapes.circle.center.lat(),lng=$scope.maps[0].shapes.circle.center.lng(),latlng=new google.maps.LatLng(lat,lng),geocoder=geocoder=new google.maps.Geocoder;geocoder.geocode({latLng:latlng},function(results,status){"OK"==status&&$scope.$apply(function(){btc.place={},btc.data.availability_address=results[0].formatted_address,btc.taskerareaaddress=results[0].formatted_address,btc.temp_taskerareaaddress=btc.taskerareaaddress,btc.data.location={},btc.data.location.lng=lng,btc.data.location.lat=lat})})}},$scope.surveyFiles=[],btc.taskerData={},btc.taskerData.profile_details=[],btc.TaskerRegister=function(valid){btc.taskerData={},valid>0?(btc.taskerData=angular.copy(btc.data),console.log(btc.taskerData),btc.taskerData.taskerfile=[],btc.taskerData.taskerfile=$scope.surveyFiles,AuthenticationService.BecomeTaskerRegister(btc.taskerData,function(err,response){err?$translate("YOUR CREDENTIALS ARE WRONG"+err).then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)}):(response.ok&&(AuthenticationService.SetCredentials(user.currentUser.username,user.currentUser.user_id,user.currentUser.authdata,"tasker",1),$rootScope.$emit("eventName",{count:0}),$cookieStore.remove("TaskerData"),$translate("TASKER ADDED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)}),$location.path("/account")),response.errors?toastr.error(response.errors):($cookieStore.remove("TaskerData"),$state.go("becometasker.success",{},{reload:!1})))})):$translate("SELECT ATLEAST ONE OF THE SKILLS").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})},btc.taskerskills=angular.copy(btc.data.taskerskills),btc.addskills=function(valid){if(valid){var skills=$filter("filter")(btc.selectedcategory.skills,{selected:!0});angular.forEach(skills,function(value){delete value.selected});var DefaultCurrency={};DefaultCurrency=$scope.DefaultCurrency;var data={categoryid:btc.selectedcategory.parent,childid:btc.selectedcategory._id,terms:btc.selectedcategory.terms,quick_pitch:btc.selectedcategory.quick_pitch,hour_rate:btc.selectedcategory.hour_rate/DefaultCurrency[0].value,experience:btc.selectedcategory.experience,file:btc.selectedcategory.file,skills:skills},insetflag=!0;angular.forEach(btc.taskerskills,function(value,key){value.childid==btc.selectedcategory._id&&(insetflag=!1,btc.taskerskills[key]=data)}),insetflag&&btc.taskerskills.push(data),btc.data.taskerskills=angular.copy(btc.taskerskills),$cookieStore.put("TaskerData",btc.data),$translate("SKILLS UPDATED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)}),btc.flag=!1}},btc.emptyLatLng=function(temp_taskerareaaddress){temp_taskerareaaddress!=btc.taskerareaaddress&&(btc.data.location="")},btc.SubmitTaskerlocation=function(valid,radiusvalue){btc.data.radius=radiusvalue,0==btc.data.working_days[6].not_working||0==btc.data.working_days[5].not_working||0==btc.data.working_days[4].not_working||0==btc.data.working_days[3].not_working||0==btc.data.working_days[2].not_working||0==btc.data.working_days[1].not_working||0==btc.data.working_days[0].not_working?calculate_age(btc.data.birthdate.month,btc.data.birthdate.date,btc.data.birthdate.year,btc.WorkingDate)?($cookieStore.put("TaskerData",btc.data),$state.go("becometasker."+btc.data.next,{},{reload:!1})):$translate("YOURS AGE SHOULD BE 18").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)}):$translate("PLEASE SELECT YOUR WORKING DAYS").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})},btc.availabilitiesModelOpen=function(size,index){$uibModal.open({animation:!0,backdrop:"static",keyboard:!1,templateUrl:"app/site/modules/tasker/views/availabilitypop.modal.tab.html",controller:"ModalInstanceWorkingDayCtrl",size:size,resolve:{WorkingDays:function(){return btc.data.working_days},workingTimes:function(){return workingTimes},DaysData:function(){return DaysData},selectedIndex:function(){return index}}}).result.then(function(WorkingDays,selectedIndex){btc.data.working_days[selectedIndex]=WorkingDays},function(){})},accountService.getCategories().then(function(respo){btc.categories=respo}),accountService.getExperience().then(function(respo){btc.experiences=respo}),btc.data.taskerskills=[],btc.selectedCat=[],btc.categoryModal=function(category){$uibModal.open({animation:!0,templateUrl:"app/site/modules/tasker/views/addcategory.model.tab.html",controller:"ModalInstancecategory",controllerAs:"ACM",resolve:{experiences:function(){return btc.experiences},defaultcurrency:function(){return $scope.DefaultCurrency},user:function(){return btc.data},selectedCat:function(){return btc.selectedCat},categories:function(){return btc.categories},category:function(){return category}}}).result.then(function(selectedCategoryData){var mode=selectedCategoryData.mode;if(delete selectedCategoryData.mode,"Add"==mode)btc.taskerskills.push(selectedCategoryData),btc.selectedCat.push(selectedCategoryData.childid);else for(var i=0;i<btc.taskerskills.length;i++)btc.taskerskills[i].childid==selectedCategoryData.childid&&(btc.taskerskills[i]=selectedCategoryData);btc.data.taskerskills=btc.taskerskills,btc.addnewcategories=btc.categories.filter(function(data){return btc.data.taskerskills.some(function(data2){return data2.childid==data._id})}).map(function(mapdata){return mapdata})},function(){})},btc.deletecategoryitem=function(data){var indexx=btc.selectedCat.indexOf(data);btc.selectedCat.splice(indexx,1),angular.forEach(btc.addnewcategories,function(value,key){value._id==data&&btc.addnewcategories.splice(key,1)}),angular.forEach(btc.data.taskerskills,function(value,key){value.childid==data&&btc.taskerskills.splice(key,1)})}}function contactCtrl($scope,ContactService,$rootScope,$location,$filter,$state,toastr,$translate,$sce){var cttc=this;cttc.Messagedetails={},cttc.site_address=$sce.trustAsResourceUrl("https://www.google.com/maps/embed/v1/place?key=AIzaSyCJQdst8aA_VwrK6IXxqfnfbv8tuL5BYFQ&q="+$rootScope.site_address),cttc.userMessage=function(isValid,formData){isValid&&void 0!=cttc.Messagedetails.mobile?(console.log("cttc.Messagedetails.mobile",cttc.Messagedetails.mobile),cttc.Messagedetails.mobile=cttc.Messagedetails.mobile.code+"-"+cttc.Messagedetails.mobile.number,ContactService.savemessage(cttc.Messagedetails).then(function(response){$translate("WELL GET IN TOUCH WITH YOU SHORTLY").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)}),$state.go("landing")},function(err){err.msg&&toastr.error("danger",err.msg)})):$translate("PLEASE ENTER THE VALID DATA").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})},cttc.subscription=function(data){}}function ContactService($http,$q){return{savemessage:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/contact/savecontactusmessage",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise}}}function categoryCtrl($scope,$rootScope,$location,$stateParams,CategoryserviceResolve,CategoryService,$state,$translate,ngMeta,$cookieStore){var cac=this;cac.data=CategoryserviceResolve,cac.itemsPerPage=6,cac.currentPage=1,cac.totalItems=0;$cookieStore.get("text")&&$cookieStore.remove("text"),cac.categoryDatails=cac.data.response.ActiveCategory.parentcategory,cac.subcategory=cac.data.response.ActiveCategory.subcategory,cac.totalItems=cac.data.response.ActiveCategory.totalsubcategory,cac.categoryDatails.name&&(ngMeta.setTitle(cac.categoryDatails.seo.title),ngMeta.setTag("description",cac.categoryDatails.seo.description),ngMeta.setTag("keyword",cac.categoryDatails.seo.keyword)),cac.getSubcategoryResponse=!0,cac.getSubcategory=function(){cac.subcategory=[],angular.isDefined(cac.categoryDatails._id)&&(cac.getSubcategoryResponse=!1,CategoryService.getcategory(cac.categoryDatails.slug,cac.currentPage,cac.itemsPerPage).then(function(data){data.response.ActiveCategory.subcategory.length>0&&(cac.subcategory=data.response.ActiveCategory.subcategory,cac.totalItems=data.response.ActiveCategory.totalsubcategory)},function(error){}))}}function CategoryService($http,$q){return{getcategory:function(data,page,itemsPerPage){if(skip=0,page>1)var skip=(parseInt(page)-1)*itemsPerPage;var deferred=$q.defer();return $http({method:"POST",url:"/site/category/getcategory",data:{slug:data,skip:skip,itemsCount:itemsPerPage}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getcategoryList:function(data,page,itemsPerPage){var deferred=$q.defer();return $http({method:"GET",url:"/site/category/getCategoryList"}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise}}}function taskCtrl($scope,$rootScope,$location,$stateParams,$uibModal,TaskService,TaskserviceResolve,toastr,$state,AuthenticationService,CurrentUserTaskserviceResolve,MainService,$translate,ngMeta,$cookieStore){function changeAddressDefault(){if(!tac.filter.address){tac.filter.address="";var addlist=tac.addressList.filter(function(el){return 3==el.status});addlist.length>0?tac.filter.address=addlist[0]._id:tac.addressList[0]&&(tac.filter.address=tac.addressList[0]._id)}var address=tac.addressList.filter(function(el){return el._id==tac.filter.address})[0];address?tac.filter.location=address.location:tac.addressList[0]&&(tac.filter.address=tac.addressList[0]._id,tac.filter.location=tac.addressList[0].location)}var tac=this;if(tac.category=TaskserviceResolve[0],tac.taskbaseinfo={},$scope.location={},tac.filter={},tac.filter.location={lat:"",lng:""},tac.taskbaseinfo.address={},tac.addressList=[],tac.category.SubCategoryInfo.name&&ngMeta.setTitle(tac.category.SubCategoryInfo.name),TaskserviceResolve.length>0?tac.taskbaseinfo.SubCategoryInfo=tac.category.SubCategoryInfo:($translate("WE ARE LOOKING FOR THIS TROUBLE SORRY UNABLE TO FETCH DATA").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)}),$state.go("landing",{},{reload:!1})),CurrentUserTaskserviceResolve[0].user_id?(tac.user=CurrentUserTaskserviceResolve[0],tac.currentuserid=tac.user._id,tac.type=1,tac.addressList=[]):(tac.addressList=[],tac.user={}),changeAddressDefault(),tac.task_details=$cookieStore.get("task_details"),console.log("tac.task_details--------",tac.task_details),tac.task_details){tac.filter.about=tac.task_details.task_description;var add={};tac.addressList=[],add.address=tac.task_details.task_address,add.location={lat:tac.task_details.location.lat,lng:tac.task_details.location.log},tac.addressList.push(add),tac.filter.location=add.location,tac.showaddress=tac.addressList[0].address}tac.placeChanged=function(){var address=tac.addressList.filter(function(el){return el._id==tac.filter.address})[0];tac.filter.location=address.location},tac.addressInfo=function(data){TaskService.address(data).then(function(result){})},tac.deleteaddress=function(index){swal({title:"Are you sure?",text:"You like to delete your favourite address",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes",cancelButtonText:"No"}).then(function(response){var data={};data.userid=tac.user._id,data.id=index,TaskService.deleteaddress(data).then(function(response){MainService.getCurrentUsers(tac.user.username).then(function(refdata){tac.addressList=refdata[0].addressList,changeAddressDefault()})})}).catch(function(err){})},tac.makeDefault=function(id){TaskService.addressStatus(id,tac.user._id).then(function(response){MainService.getCurrentUsers(tac.user.username).then(function(refdata){tac.addressList=refdata[0].addressList,$translate("PREFERRED ADDRESS ADDED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)})})})},tac.Addaddress=function(data,isvalid){if(tac.details={},tac.showaddress="",isvalid&&(data?data.location:data)){if(""!=data.location.lat&&"undefined"!=data.location.lan)if(tac.user._id)TaskService.AddAddress(tac.user._id,data).then(function(response){0===response.status?$translate(response.message).then(function(headline){toastr.info(headline)},function(headline){toastr.info(headline)}):$translate("ADDRESS ADDED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)}),MainService.getCurrentUsers(tac.user.username).then(function(refdata){tac.addressList=refdata[0].addressList})});else{var add={};tac.addressList=[],add.address=data.address,add.location={lat:data.location.lat,lng:data.location.lng},tac.addressList.push(add),tac.filter.location=add.location,$cookieStore.put("addressdetail",add)}}else $translate("PLEASE ENTER VALID LOCATION").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})},tac.placeChangeddd=function(){tac.dat={},tac.details={},tac.place=this.getPlace(),tac.dat.tasker_area={},tac.dat.tasker_area.lng=tac.place.geometry.location.lng(),tac.dat.tasker_area.lat=tac.place.geometry.location.lat(),tac.details.location=tac.dat.tasker_area,tac.details.address=tac.place.formatted_address;var add={};tac.addressList=[],add.address=tac.details.address,add.location={lat:tac.dat.tasker_area.lat,lng:tac.dat.tasker_area.lng},tac.addressList.push(add),tac.filter.location=add.location},tac.SearchTasker=function(taskavailable){tac.filter.location.lat&&tac.filter.location.lng?TaskService.checktaskeravailability(tac.filter.location,tac.taskbaseinfo.SubCategoryInfo._id).then(function(response){if(console.log("tasker countttttttttttttt",response.count),response.count<=0)$translate("THE TASKER IS UN AVILABLE ON SELECTED ADDRESS").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)});else if(tac.filter.about){var data={},address=tac.addressList;address[0]?(tac.filter.location=address[0].location,1==tac.type&&(data.userid=tac.currentuserid),data.categoryid=tac.taskbaseinfo.SubCategoryInfo._id,data.address=tac.taskbaseinfo.address.line1,tac.user.address?data.billing_address={zipcode:tac.user.address.zipcode||"",country:tac.user.address.country||"",state:tac.user.address.state||"",city:tac.user.address.city||"",line2:tac.user.address.line2||"",line1:tac.user.address.line1||""}:data.billing_address={line1:address[0].address||""},data.categoryid=tac.taskbaseinfo.SubCategoryInfo._id,data.task_description=tac.filter.about,data.location={lat:tac.filter.location.lat,log:tac.filter.location.lng},data.task_address=address[0].address,TaskService.addtask(data).then(function(result){var option={task:result._id};$cookieStore.put("slug",$stateParams.slug),$cookieStore.put("task_details",data),$state.go("search",{task:result._id,query:JSON.stringify(option)},{reload:!1})},function(error){toastr.error(error)})):toastr.error("Add address to proceed")}else toastr.error("Tell Us About Your Task")},function(error){$translate("THE TASKER IS UN AVILABLE ON SELECTED ADDRESS").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})}):toastr.error("Add address to proceed")}}function taskProfileCtrl($scope,$rootScope,$location,$stateParams,$uibModal,TaskService,TaskProfileResolve,toastr,$state,$translate,$cookieStore){var tpc=this;if(angular.isDefined($stateParams.taskerId)&&(tpc.taskerId=$stateParams.taskerId),angular.isDefined($stateParams.slug)&&(tpc.cate=$stateParams.slug),tpc.taskDetailInfo={},tpc.availableSymbal=!1,angular.isDefined($stateParams.date)&&(tpc.date=$stateParams.date),angular.isDefined($stateParams.minprice)&&(tpc.minvalue=$stateParams.minprice),angular.isDefined($stateParams.maxprice)&&(tpc.maxvalue=$stateParams.maxprice),angular.isDefined($stateParams.kmmaxvalue)&&(tpc.kmmaxvalue=$stateParams.kmmaxvalue),angular.isDefined($stateParams.kmminvalue)&&(tpc.kmminvalue=$stateParams.kmminvalue),angular.isDefined($stateParams.time)&&(tpc.time=$stateParams.time),angular.isDefined($stateParams.task)&&(tpc.task=$stateParams.task),angular.isDefined($stateParams.hour)&&(tpc.hour=$stateParams.hour),angular.isDefined($stateParams.day)&&(tpc.day=$stateParams.day),angular.isDefined($stateParams.current_page)&&(tpc.current_page=$stateParams.current_page),angular.isDefined($stateParams.user)&&(tpc.user=$stateParams.user),TaskProfileResolve){if(TaskProfileResolve.location){var latlng=new google.maps.LatLng(TaskProfileResolve.location.lat,TaskProfileResolve.location.lng),geocoder=geocoder=new google.maps.Geocoder;geocoder.geocode({latLng:latlng},function(results,status){status==google.maps.GeocoderStatus.OK&&results[1]&&(TaskProfileResolve.availability_address?TaskProfileResolve.availability_address=TaskProfileResolve.availability_address:TaskProfileResolve.availability_address=results[1].formatted_address)})}tpc.taskDetailInfo=TaskProfileResolve,0==tpc.taskDetailInfo.availability?(tpc.availabilityValue="Tasker is Unavailable",tpc.availableSymbal=!1):(tpc.availabilityValue="Tasker is Available",tpc.availableSymbal=!0),tpc.questionValue="Tasker has not provided any details",tpc.answerValue="Answer is Unavailable",tpc.taskDetailInfo.profile_details[0]&&(tpc.taskDetailInfo.profile_details[0].answer&&(tpc.checkVAlue=1,tpc.answerValue=tpc.taskDetailInfo.profile_details),tpc.taskDetailInfo.profile_details[0].question&&(tpc.questionValue=tpc.taskDetailInfo.profile_details))}else $translate("WE ARE LOOKING FOR THIS TROUBLE SORRY UNABLE TO FETCH DATA").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)}),$state.go("landing");TaskService.taskerreviews(tpc.taskerId).then(function(response){response[0]&&(tpc.taskprofile=response[0],console.log("tpc.taskprofile",tpc.taskprofile),tpc.taskertempid=tpc.taskprofile[0]._id,tpc.profilelength=tpc.taskprofile.length,tpc.overallRating=0,angular.forEach(tpc.taskprofile,function(value,key){value.rate&&(tpc.overallRating=tpc.overallRating+value.rate.rating)}),tpc.overallrate=tpc.overallRating/tpc.profilelength,tpc.taskprofile[0].createdAt&&(tpc.convertdate=new Date(tpc.taskprofile[0].createdAt)),tpc.dateConversion=tpc.convertdate.getFullYear(),tpc.induvidualrating=parseInt(response[1]),TaskProfileResolve.taskerskills&&angular.forEach(TaskProfileResolve.taskerskills,function(value1,key1){value1.childid==$stateParams.sub_id&&(tpc.experience=value1.experience.name)}))},function(err){toastr.error(err)}),tpc.clearvalue=function(){console.log("hai"),$cookieStore.remove("text")},tpc.confirmatask=function(message,hourlyprice){tpc.user?swal({title:"Confirm & Book",text:"Are You Sure Want To Confirm This Task",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, Confirm!"}).then(function(response){TaskService.taskdetails($stateParams.task).then(function(response){var newData=response[0],data={};data._id=newData._id,data.status=1,data.user=tpc.user,data.tasker=TaskProfileResolve._id,data.hourly_rate=hourlyprice,data.task_hour=newData.task_hour,data.task_date=newData.task_date,data.task_day=newData.task_day,data.invoice={amount:{minimum_cost:newData.category.commision,task_cost:newData.category.commision,total:newData.category.commision,grand_total:newData.category.commision}},data.booking_information={service_type:newData.category.name,work_type:newData.category.name,work_id:newData.category._id,instruction:newData.task_description,booking_date:"",reach_date:"",est_reach_date:"",location:newData.billing_address.line1+","+newData.billing_address.line2+","+newData.billing_address.city+","+newData.billing_address.state+","+newData.billing_address.country+","+newData.billing_address.zipcode},data.history={},data.history.job_booking_time=new Date,data.history.est_reach_date="",TaskService.profileconfirmtask(data).then(function(result){$translate("REQUEST HAS BEEN SENT TO TASKER SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)}),$state.go("landing",{reload:!1})},function(error){toastr.error(error)})})}).catch(function(err){}):swal({title:"Information",text:"To Proceed Further, Please Login or Signup",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, Confirm!"}).then(function(response){tpc.query={},tpc.query.task=tpc.task,$cookieStore.put("categeoryslug",tpc.query),$state.go("login",{type:"user"})}).catch(function(err){})}}function taskFilterCtrl($scope,$rootScope,$location,$stateParams,SearchResolve,TaskService,toastr,$state,$filter,AuthenticationService,$modal,MainService,$translate,ngMeta,NgMap,$scope,$q,$log,$uibModal,swal,$cookieStore){function filterDate(){tfc.timinglist=[{value:"morning",time:"0:00 AM",data:"00:00"},{value:"morning",time:"0:30 AM",data:"00:30"},{value:"morning",time:"1:00 AM",data:"01:00"},{value:"morning",time:"1:30 AM",data:"01:30"},{value:"morning",time:"2:00 AM",data:"02:00"},{value:"morning",time:"2:30 AM",data:"02:30"},{value:"morning",time:"3:00 AM",data:"03:00"},{value:"morning",time:"3:30 AM",data:"03:30"},{value:"morning",time:"4:00 AM",data:"04:00"},{value:"morning",time:"4:30 AM",data:"04:30"},{value:"morning",time:"5:00 AM",data:"05:00"},{value:"morning",time:"5:30 AM",data:"05:30"},{value:"morning",time:"6:00 AM",data:"06:00"},{value:"morning",time:"6:30 AM",data:"06:30"},{value:"morning",time:"7:00 AM",data:"07:00"},{value:"morning",time:"7:30 AM",data:"07:30"},{value:"morning",time:"8:00 AM",data:"08:00"},{value:"morning",time:"8:30 AM",data:"08:30"},{value:"morning",time:"9:00 AM",data:"09:00"},{value:"morning",time:"9:30 AM",data:"09:30"},{value:"morning",time:"10:00 AM",data:"10:00"},{value:"morning",time:"10:30 AM",data:"10:30"},{value:"morning",time:"11:00 AM",data:"11:00"},{value:"morning",time:"11:30 AM",data:"11:30"},{value:"afternoon",time:"12:00 PM",data:"12:00"},{value:"afternoon",time:"12:30 PM",data:"12:30"},{value:"afternoon",time:"1:00 PM",data:"13:00"},{value:"afternoon",time:"1:30 PM",data:"13:30"},{value:"afternoon",time:"2:00 PM",data:"14:00"},{value:"afternoon",time:"2:30 PM",data:"14:30"},{value:"afternoon",time:"3:00 PM",data:"15:00"},{value:"afternoon",time:"3:30 PM",data:"15:30"},{value:"evening",time:"4:00 PM",data:"16:00"},{value:"evening",time:"4:30 PM",data:"16:30"},{value:"evening",time:"5:00 PM",data:"17:00"},{value:"evening",time:"5:30 PM",data:"17:30"},{value:"evening",time:"6:00 PM",data:"18:00"},{value:"evening",time:"6:30 PM",data:"18:30"},{value:"evening",time:"7:00 PM",data:"19:00"},{value:"evening",time:"7:30 PM",data:"19:30"},{value:"evening",time:"8:00 PM",data:"20:00"},{value:"evening",time:"8:30 PM",data:"20:30"},{value:"evening",time:"9:00 PM",data:"21:00"},{value:"evening",time:"9:30 PM",data:"21:30"},{value:"evening",time:"10:00 PM",data:"22:00"},{value:"evening",time:"10:30 PM",data:"22:30"},{value:"evening",time:"11:00 PM",data:"23:00"},{value:"evening",time:"11:30 PM",data:"23:30"}],tfc.filterTiming=[];var startDate=moment(tfc.filters.date.date,"DD-MMMM-YYYY"),endDate=moment().set({hour:0,minute:0,second:0,millisecond:0});if(startDate.diff(endDate,"days")<=0){for(var i=0;i<tfc.timinglist.length;i++)tfc.timinglist[i].data>(new Date).getHours()+":00"&&tfc.filterTiming.push(tfc.timinglist[i]);tfc.category.hours&&(tfc.filterTiming.length<=2*tfc.category.hours?tfc.timeout=!0:tfc.timeout=!1)}else tfc.filterTiming=tfc.timinglist;tfc.filterTiming=tfc.filterTiming.length>0?tfc.filterTiming:tfc.timinglist;var isAvailable=tfc.filterTiming.find(function(o){return o.data==tfc.filters.time});tfc.filters.time=tfc.filters.time&&isAvailable?tfc.filters.time:tfc.filterTiming[0].data}function getTaskerDetails(){tfc.tasker_list=!1,tfc.TaskerDetails=[],tfc.TaskerDetails.length=1;var search={};tfc.user?(search.user=tfc.user.user_id,tfc.filters.type=1):tfc.filters.type=0,search.category=tfc.category._id,search.task=tfc.taskinfo._id,search.date=moment(tfc.filters.date.date,"DD-MMMM-YYYY").format("YYYY-MM-DD"),search.time=tfc.filters.time,search.timeout=tfc.timeout,search.price=[tfc.priceFilter.min,tfc.priceFilter.max],search.distance=tfc.distanceFilter.value,search.sort=tfc.filters.sort,search.skip=(parseInt(tfc.filters.page)-1)*tfc.filters.perPage,search.limit=tfc.filters.limit||tfc.filters.perPage,search.view=tfc.filters.view,TaskService.getTaskerByGeoFilter(search).then(function(response){console.log("Available tasker data",response),response.count>0?(tfc.tasker_list=!0,tfc.TaskerDetails=response.taskers,tfc.filters.totalTasker=response.count,"map"==tfc.filters.view&&NgMap.getMap().then(function(map){$scope.map=map,$scope.lat=tfc.taskinfo.location.lat,$scope.lng=tfc.taskinfo.location.lng,$scope.markerData=[],$scope.getCityInfo=function(){for(var i=0;i<tfc.TaskerDetails.length;i++)$scope.markerData.push({id:i,latitude:tfc.TaskerDetails[i].location.lat,longitude:tfc.TaskerDetails[i].location.lng,title:tfc.TaskerDetails[i].availability_address,tasker:tfc.TaskerDetails[i],icon:tfc.TaskerDetails[i].avatar,avatar:tfc.TaskerDetails[i].avatar,position:[tfc.TaskerDetails[i].location.lat,tfc.TaskerDetails[i].location.lng]})},$scope.getCityInfo(),tfc.showCity=function(event,cityItem){$scope.selectedCity=cityItem,$scope.map.showInfoWindow("myInfoWindow","m"+cityItem.id)}})):0==response.count&&(tfc.TaskerDetails=[],tfc.tasker_list=!0),tfc.query={},tfc.query.sort=tfc.filters.sort,tfc.query.page=tfc.filters.page,tfc.query.date=tfc.filters.date.date,tfc.query.time=tfc.filters.time,tfc.query.price=search.price,tfc.query.distance=search.distance,tfc.query.view=tfc.filters.view,$state.go("search",{query:JSON.stringify(tfc.query)},{notify:!1,reload:!1,location:"replace",inherit:!0})},function(error){})}var tfc=this;tfc.slug=$cookieStore.get("slug");var searchConfig=SearchResolve.response,filtersInit=searchConfig.filtersInit||{};tfc.taskinfo=searchConfig.task,tfc.category=searchConfig.category,tfc.user=AuthenticationService.GetCredentials().currentUser,searchConfig.category.name&&ngMeta.setTitle(searchConfig.category.name),tfc.filters={view:"list",sort:"1",page:1,perPage:5,price:[filtersInit.pricemin||0,filtersInit.pricemax||1e3],distance:filtersInit.dstmax||100};var queryString=$stateParams.query;console.log("$stateParams--------",$stateParams),queryString&&(tfc.query=JSON.parse(queryString),tfc.filters.view=tfc.query.view?tfc.query.view:tfc.filters.view,tfc.filters.sort=tfc.query.sort?tfc.query.sort:tfc.filters.sort,tfc.filters.time=tfc.query.time?tfc.query.time:tfc.filters.time,tfc.filters.price=tfc.query.price?tfc.query.price:tfc.filters.price,tfc.filters.distance=tfc.query.distance?tfc.query.distance:tfc.filters.distance,tfc.filters.page=tfc.query.page?tfc.query.page:tfc.filters.page),$scope.formattedDate=[];for(var i=0;i<=30;i++){var date=moment().add(i,"day");$scope.formattedDate.push({date:date.format("DD-MMMM-YYYY"),day:date.format("dddd")})}var isAvailable=tfc.query.date?$scope.formattedDate.find(function(o){return o.date==tfc.query.date}):null;tfc.filters.date=isAvailable||$scope.formattedDate[0],filterDate(),tfc.priceFilter={min:tfc.filters.price[0]||0,max:tfc.filters.price[1]||0,options:{floor:filtersInit.pricemin||0,ceil:filtersInit.pricemax||1e3,onEnd:function(){tfc.filters.page=1,getTaskerDetails()},translate:function(value,sliderId,label){return $rootScope.currency.symbol+""+$rootScope.currency.value*value}}},tfc.radiustext="mi"==$rootScope.settings.distanceby?"MILE":"KILOMETER",tfc.radiusval="km"==$rootScope.settings.distanceby?1e3:1609.34,tfc.distanceFilter={value:tfc.filters.distance,max:1e3,options:{floor:1,ceil:filtersInit.dstmax||1e3,showSelectionBar:!0,onEnd:function(){tfc.filters.page=1,getTaskerDetails()}}},$scope.$watchCollection("DefaultCurrency",function(newNames,oldNames){$rootScope.currency=newNames,$scope.$broadcast("rzSliderForceRender")}),tfc.changeViewType=function(){getTaskerDetails()},tfc.filterDate=function(){filterDate(),tfc.filters.page=1,getTaskerDetails()},tfc.filterTime=function(){tfc.filters.page=1,getTaskerDetails()},getTaskerDetails(),angular.extend(tfc,{confirmatask:function(tasker){tfc.user?swal({title:"Confirm & Book",text:"Are You Sure Want To Confirm This Task.",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, Confirm!"}).then(function(response){if(response){var task={};task.tasker=tasker,task.user=tfc.user.user_id,task.task=tfc.taskinfo._id,task.time=tfc.filters.time;var from=moment(tfc.filters.time,"HH:mm").format("HH"),to=moment(tfc.filters.time,"HH:mm").add(tfc.category.hours,"h").format("HH"),tasktime=[];to-from>1?tasktime.push(parseInt(from),parseInt(from)+1,parseInt(to)):tasktime.push(parseInt(from),parseInt(to)),task.slots=tasktime,TaskService.confirmtask(task).then(function(result){1==result.status?($translate("REQUEST HAS BEEN SENT TO TASKER SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)}),$state.go("account.tasks",{reload:!1})):toastr.error("Unable to book this tasker")},function(error){toastr.error(error)})}}).catch(function(err){}):swal({title:"Information",text:"To Proceed Further, Please Login or Signup",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, Confirm!"}).then(function(response){tfc.query.task=tfc.taskinfo._id,$cookieStore.put("categeoryslug",tfc.query),$state.go("login",{type:"user"})}).catch(function(err){})},getTaskerDetails:getTaskerDetails})}function TaskService($http,$q){return{taskbaseinfo:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/task/taskbaseinfo/",data:{slug:data}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},checktaskeravailability:function(location,categoryId){var url="/site/task/taskerAvailabilitybyWorkingAreaCount?lat="+location.lat+"&lon="+location.lng+"&categoryid="+categoryId,deferred=$q.defer();return $http({method:"GET",url:url}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getTaskerByGeoFilter:function(data){var deferred=$q.defer(),result=1;if(1==result)return $http({method:"POST",url:"/site/task/taskeravailabilitybyWorkingArea",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),result=2,deferred.promise},gettaskuser:function(filter){var deferred=$q.defer();return $http({method:"POST",url:"/site/task/gettaskuser",data:{user:filter.tasker,categoryid:filter.categoryid,hour:filter.hour,day:filter.day,loginUser:filter.loginUser,vehicle:filter.vechile}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},taskprofileinfo:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/task/taskprofileinfo",data:{slug:data}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},taskerreviews:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/task/taskerreviews",data:{slug:data}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},saveuser:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/task/saveuser",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},addtask:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/task/addnewtask",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getTaskDetailsbyid:function(id){var deferred=$q.defer();return $http({method:"POST",url:"/site/task/gettaskdetailsbyid",data:{id:id}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},confirmtask:function(data,time){var deferred=$q.defer();return $http({method:"POST",url:"/site/task/confirmtask",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},deleteaddress:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/task/deleteaddress/",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getaddressdata:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/task/getaddressdata/",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},AddAddress:function(userid,data){var deferred=$q.defer();return $http({method:"POST",url:"/site/task/addaddress",data:{userid:userid,data:data}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},addressStatus:function(add_id,userid){var deferred=$q.defer();return $http({method:"POST",url:"/site/task/addressStatus",data:{add_id:add_id,userid:userid}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},searchTasker:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/task/search-tasker",data:{task:data}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},taskerCount:function(task,itemsPerPage,page){var url="/site/task/taskerCount?page="+page+"&skip="+(parseInt(page)-1)*itemsPerPage+"&limit="+itemsPerPage+"&task="+task,deferred=$q.defer();return $http({method:"GET",url:url}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getuserdata:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/task/getuserdata/",data:{data:data}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},taskdetails:function(task){console.log(task);var deferred=$q.defer();return $http({method:"POST",url:"/site/task/gettask",data:{task:task}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},taskerconfirmtask:function(data,time){var deferred=$q.defer();return $http({method:"POST",url:"/site/task/taskerconfirmtask",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},profileconfirmtask:function(task){console.log(task);var deferred=$q.defer();return $http({method:"POST",url:"/site/task/profileConfirm",data:task}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise}}}function accountService($http,$q,Upload){return{saveAccount:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/settings/save",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},savePassword:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/password/save",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},saveProfile:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/updateprofiledetails",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getCategories:function(){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/categories/get"}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},edit:function(id){var data={id:id},deferred=$q.defer();return $http({method:"POST",url:"/site/account/edit",data:data}).then(function(data){deferred.resolve(data[0].data)},function(err){deferred.reject(err)}),deferred.promise},updatetaskstatus:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/updatetaskstatus",data:{data:data}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},updatetaskstatuscash:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/updatetaskstatuscash",data:{data:data}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},updatewalletdata:function(data,user){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/updatewalletdata",data:{data:data,user:user}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getmaincatname:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/getmaincatname",data:{data:data}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getwalletdetails:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/getwalletdetails",data:{data:data}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getsettings:function(){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/getsettings"}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getQuestion:function(){var deferred=$q.defer();return $http({method:"GET",url:"/site/account/question/getQuestion"}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getChild:function(id){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/categories/getchild",data:{id:id}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getCategoriesofuser:function(id){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/getcategoriesofuser",data:{_id:id}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},taskListService:function(Id,status,page,itemsPerPage){var skip=0;page>1&&(skip=(parseInt(page)-1)*itemsPerPage);var deferred=$q.defer();return $http({method:"POST",url:"/site/account/getTaskList",data:{_id:Id,status:status,skip:skip,limit:itemsPerPage}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getTaskDetailsByStaus:function(Id,status,page,itemsPerPage){var skip=0;page>1&&(skip=(parseInt(page)-1)*itemsPerPage);var deferred=$q.defer();return $http({method:"POST",url:"/site/account/getTaskDetailsByStaus",data:{_id:Id,status:status,skip:skip,limit:itemsPerPage}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getSearchTaskDetailsByStaus:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/getSearchTaskDetailsByStaus",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getTaskDetailsBytaskid:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/getTaskDetailsBytaskid",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},updateTask:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/updateTask",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},inserttaskerreview:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/insertaskerReview",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},updateTaskcompletion:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/updateTaskcompletion",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},usercanceltask:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/usercanceltask",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},ignoreTask:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/ignoreTask",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},taskerconfirmTask:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/taskerconfirmtask",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},saveAvailability:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/availability/save",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getExperience:function(){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/categories/get-experience"}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},updateCategory:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/updatecategoryinfo",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},deleteCategory:function(categoryinfo){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/deleteCategory",data:categoryinfo}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},deactivateAccount:function(userid){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/deactivateAccount",data:{userid:userid}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getReview:function(id,page,itemsPerPage,role){var skip=0;page>1&&(skip=(parseInt(page)-1)*itemsPerPage);var deferred=$q.defer();return $http({method:"POST",url:"/site/account/getreview",data:{id:id,skip:skip,limit:itemsPerPage,role:role}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getuserReview:function(id,page,itemsPerPage,role){var skip=0;page>1&&(skip=(parseInt(page)-1)*itemsPerPage);var deferred=$q.defer();return $http({method:"POST",url:"/site/account/getuserReview",data:{id:id,skip:skip,limit:itemsPerPage,role:role}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},setReview:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/addReview",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getTransactionHis:function(id,page,itemsPerPage){var skip=0;page>1&&(skip=(parseInt(page)-1)*itemsPerPage);var deferred=$q.defer();return $http({method:"POST",url:"/site/account/transcationhis",data:{id:id,skip:skip,limit:itemsPerPage}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},saveTaskerPassword:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/tasker/password/save",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},deactivateTaskerAccount:function(userid){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/deactivateTaskertAccount",data:{userid:userid}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},taskinfo:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/taskinfo",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},confirmtask:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/taskinfo",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},addUserReview:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/addReview",data:{data:data}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},gettaskinfobyid:function(taskid){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/gettaskbyid",data:{task:taskid}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},disputeUpdateTask:function(data,status){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/disputeupdateTask",data:{data:data,status:status}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getTaskDetails:function(userid){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/getTaskDetails",data:{_id:userid}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},gettaskreview:function(taskid){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/gettaskreview",data:{taskid:taskid}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},updateAvailability:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/availability/update",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},downloadPdf:function(_id){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/downloadPdf",data:{_id:_id}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getcancelreason:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/getcancelreason",data:{type:data}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},saveaccountinfo:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/saveaccountinfo",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getUserTransaction:function(id,page,itemsPerPage){var skip=0;page>1&&(skip=(parseInt(page)-1)*itemsPerPage);var deferred=$q.defer();return $http({method:"POST",url:"/site/account/usertranscation",data:{id:id,skip:skip,limit:itemsPerPage}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getUserTaskDetailsByStaus:function(Id,status,page,itemsPerPage){var skip=0;page>1&&(skip=(parseInt(page)-1)*itemsPerPage);var deferred=$q.defer();return $http({method:"POST",url:"/site/account/getUserTaskDetailsByStaus",data:{_id:Id,status:status,skip:skip,limit:itemsPerPage}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getseosetting:function(){var deferred=$q.defer();return $http({method:"GET",url:"/site/landing/getseosetting"}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},updatewalletdatapaypal:function(data,user){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/updatewalletdatapaypal",data:{data:data,user:user}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getUserWalletTransaction:function(id,page,itemsPerPage){var skip=0;page>1&&(skip=(parseInt(page)-1)*itemsPerPage);var deferred=$q.defer();return $http({method:"POST",url:"/site/account/getuserwallettransaction",data:{id:id,skip:skip,limit:itemsPerPage}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},checkphoneno:function(data){console.log("data",data);var deferred=$q.defer();return $http({method:"POST",url:"/site/account/checkphoneno",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getPaymentdetails:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/getPaymentdetails",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise}}}function accountWalletCtrl($scope,$rootScope,toastr,$window,$stateParams,MainService,routes,$uibModal,$translate){function WalletRechargeByPaypal(defaultCurrency){$scope.walletMinAmt=($scope.settings.wallet.amount.minimum*defaultCurrency.value).toFixed(2),$scope.walletWelAmt=($scope.settings.wallet.amount.welcome*defaultCurrency.value).toFixed(2),$scope.walletMaxAmt=($scope.settings.wallet.amount.maximum*defaultCurrency.value).toFixed(2);var data={};if(data.amount=$scope.walletAmount,data.currencyvalue=defaultCurrency.value,data.amount)if(parseFloat(data.amount)>=$scope.walletMinAmt&&parseFloat(data.amount)<=$scope.walletMaxAmt){var user=$rootScope.userId;MainService.getData(routes.walletRechargePaypal,{data:data,user:user}).then(function(response){1==response.status&&"paypal"==response.payment_mode?$window.location.href=response.redirectUrl:$translate("UNABLE PROCESS YOUR PAYMENT").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})}).catch(function(err){console.error("err = ",err)})}else $translate("PLEASE ENTER THE AMOUNT TO ADD TO THE WALLET").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)});else $translate("PLEASE ENTER THE AMOUNT TO ADD TO THE WALLET").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})}$scope.wallet_recharge=!0,$scope.trans=!1,$scope.wrbtn=!0,$scope.w_rech=function(event){$scope.wallet_recharge=!0,$scope.trans=!1,$scope.wrbtn=!0,$scope.wtbtn=!1},$scope.w_trans=function(event){$scope.wallet_recharge=!1,$scope.trans=!0,$scope.wtbtn=!0,$scope.wrbtn=!1},$scope.stripe_status=0,$scope.paypal_status=0,angular.forEach($scope.payment_method,function(value){"Stripe"==value.gateway_name?$scope.stripe_status=value.status:"PayPal"==value.gateway_name&&($scope.paypal_status=value.status)}),this.inter=parseInt($scope.settings.wallet.amount.minimum)+parseInt($scope.settings.wallet.amount.maximum),this.interamount=this.inter/2,this.interminimum=parseInt($scope.settings.wallet.amount.minimum),this.intermaximum=parseInt($scope.settings.wallet.amount.maximum).toFixed(2),$scope.walletDetails={},angular.isDefined($rootScope.settings)&&($scope.settings=$rootScope.settings),angular.extend($scope,{ChangeWalletAmount:function(amt){$scope.walletAmount=parseFloat(amt).toFixed(2),console.log("$scope.walletAmount",$scope.walletAmount)},WalletRechargeByStripe:function(defaultCurrency){$scope.walletMinAmt=($scope.settings.wallet.amount.minimum*defaultCurrency.value).toFixed(2),$scope.walletWelAmt=($scope.settings.wallet.amount.welcome*defaultCurrency.value).toFixed(2),$scope.walletMaxAmt=($scope.settings.wallet.amount.maximum*defaultCurrency.value).toFixed(2);var data={};data.amount=$scope.walletAmount,data.currencyvalue=defaultCurrency.value,data.amount&&"NaN"!=data.amount?(console.log("parseFloat(data.amount)",parseFloat(data.amount)),console.log("$scope.walletMinAmt",$scope.walletMinAmt),parseFloat(data.amount)>=$scope.walletMinAmt?parseFloat(data.amount)<=$scope.walletMaxAmt?$uibModal.open({animation:!0,templateUrl:"app/site/modules/accounts/views/wallet.modal.tab.html",controller:"WalletRechargeModal",controllerAs:"WRM",resolve:{Rechargeamount:function(){return data}}}).result.then(function(data){var user=$rootScope.userId;MainService.getData(routes.walletRechargeStripe,{data:data,user:user}).then(function(response){0==response.status?toastr.error(response.message):($translate("WALLET MONEY HAS BEEN UPDATED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)}),$scope.walletDetails=response.wallet)}).catch(function(err){console.error("err = ",err)})}):$translate("PLEASE ENTER THE AMOUNT  BELOW "+$scope.walletMaxAmt).then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)}):$translate("PLEASE ENTER THE AMOUNT ABOVE  "+$scope.walletMinAmt).then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})):$translate("PLEASE ENTER THE AMOUNT TO ADD TO THE WALLET").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})},getWalletBalanceDetails:function(){var userId=$rootScope.userId;MainService.getData(routes.walletDetails,{userId:userId}).then(function(response){response?$scope.walletDetails=response:$scope.walletDetails.total=0}).catch(function(err){console.error("err = ",err)})},WalletRechargeByPaypal:WalletRechargeByPaypal,WalletRechargeByPaypal:WalletRechargeByPaypal,UserWalletTransactionList:function(){var userId=$rootScope.userId;MainService.getData(routes.walletTransaction,{userId:userId}).then(function(response){function CategoryList(from,perPage){$scope.SubCategoryList=[];for(var i=from;i<perPage;i++){if(i===$scope.totalitem.length)return!1;$scope.SubCategoryList.push($scope.totalitem[i])}}response&&($scope.currentPage=1,$scope.numPerPage=10,$scope.totalitems=response.count,$scope.totalitem=response.transaction,$scope.SubCategoryList=response.transaction,CategoryList(0,$scope.numPerPage),console.log("$scope.SubCategoryList$scope.SubCategoryList",$scope.SubCategoryList),$scope.WalletTransactionPagination=function(currentPage,numPerPage){if(currentPage){var spliceFrom=(currentPage-1)*numPerPage;CategoryList(spliceFrom,spliceFrom+numPerPage)}})})}})}function WalletRechargeModal($uibModalInstance,$state,$translate,Rechargeamount,toastr){var wrm=this;wrm.rechargeamount=Rechargeamount;var walletamount=wrm.rechargeamount.amount.replace(/,/g,""),currencyvalue=wrm.rechargeamount.currencyvalue,result=parseFloat(walletamount)/parseFloat(currencyvalue),walletamount="";wrm.walletamount=result.toFixed(2),angular.extend(wrm,{ok:function(isValid){1==isValid?$uibModalInstance.close(wrm):$translate("FORM IS INVALID").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})},cancel:function(){$uibModalInstance.dismiss("cancel")}})}function AccountPasswordCtrl($scope,$rootScope,toastr,MainService,routes,$state,$translate){angular.isDefined($rootScope.accountProfile)&&(this.user=$rootScope.accountProfile),this.currentUser=$rootScope.userId,angular.extend($scope,{accountUserPasswordChange:function(isvalid,form){var userId=$rootScope.userId;isvalid?MainService.getData(routes.userPassword,{userId:userId,form:form}).then(function(response){1===response.status?($translate("Password Updated Successfully").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)}),$state.go("account.profile",{},{reload:!1})):$translate(response.message).then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})}).catch(function(err){$translate("Unable to Save User Password Changed").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})}):$translate("Please fill all fields").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})},accountTaskerPasswordChange:function(isvalid,form){if(isvalid){var userId=$rootScope.userId;MainService.getData(routes.taskerPassword,{userId:userId,form:form}).then(function(response){1===response.status?($translate("Password Updated Successfully").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)}),$state.go("account.profile",{},{reload:!1})):$translate(response.message).then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})}).catch(function(err){$translate(err).then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})})}else toastr.error("Please fill all fields")}})}function AccountTasksCtrl($scope,$rootScope,toastr,$stateParams,MainService,accountService,routes,$uibModal,$state,$cookieStore){function getTaskLists(status,page){atc.status=status,atc.taskList=[],atc.getTaskListResponse=!1,atc.taskListCurrentPage=void 0==page?1:page;var data={};data._id=userId,data.status=status,data.skip=atc.taskListCurrentPage,data.limit=atc.itemsPerPage,atc.action_menu=-1,flag=!0,MainService.getData(routes.taskList,data).then(function(response){response.length>0&&(atc.taskList=response[0].TaskDetails,atc.totalItem=response[0].count),atc.getTaskListResponse=!0}).catch(function(err){console.error("err = ",err)})}var atc=this;angular.isDefined($rootScope.accountProfile)&&angular.isDefined($rootScope.defaultCurrency)&&(atc.user=$rootScope.accountProfile,atc.currency=$rootScope.defaultCurrency),atc.itemsPerPage=5,atc.totalItem=0,atc.taskList=[],atc.taskinfobyid=[],atc.getTaskListResponse=!1,atc.taskListCurrentPage=1;var userId=$rootScope.userId,flag=!0;$scope.job_id={},$scope.job_id="HFA-",$scope.checkDefaultValue=function(){$scope.job_id&&"HFA-"===$scope.job_id.substring(0,4)||($scope.job_id="HFA-")},$scope.checkSearchDate=function(){atc.searchTaskFrom>atc.searchTaskTo&&(atc.searchTaskFrom=void 0,atc.searchTaskTo=void 0,toastr.error("Invalid date"))},$scope.clearSearch=function(){$scope.job_id="HFA-",atc.searchTaskFrom=void 0,atc.searchTaskTo=void 0,getTaskLists(atc.status)},MainService.getData(routes.taskCancelReason,{type:atc.user.role}).then(function(response){angular.isDefined(response)&&(atc.getcancelreason=response.length>0?response:{})}).catch(function(err){console.error("err = ",err)});var notification_status=$cookieStore.get("notification_status");notification_status?(2==notification_status||3==notification_status||4==notification_status||5==notification_status?($("#assigned").removeClass("new-active"),$("#ongoing").addClass("new-active"),getTaskLists("ongoing")):6==notification_status||7==notification_status?($("#assigned").removeClass("new-active"),$("#completed").addClass("new-active"),getTaskLists("completed")):8==notification_status?($("#assigned").removeClass("new-active"),$("#cancelled").addClass("new-active"),getTaskLists("cancelled")):1==notification_status&&($("#cancelled").addClass("new-active"),getTaskLists("assigned")),$cookieStore.remove("notification_status")):getTaskLists("assigned"),angular.extend(atc,{getTaskLists:getTaskLists,getSearchTaskLists:function(){var data={};data._id=userId,data.status=atc.status,data.jobid=$scope.job_id,data.taskfrom=atc.searchTaskFrom,data.taskto=atc.searchTaskTo,data.limit=atc.itemsPerPage,data.skip=atc.taskListCurrentPage,atc.action_menu=-1,flag=!0,$scope.job_id.length<=4&&void 0==atc.searchTaskFrom&&void 0==atc.searchTaskTo?toastr.error("Choose atleast one search option"):0==atc.taskList.length?toastr.warning("Search results not found"):MainService.getSearchData(routes.taskSearchList,data).then(function(response){response.length>0?(atc.taskList=response[0].TaskDetails,atc.totalItem=response[0].count):atc.taskList=[],atc.getTaskListResponse=!0}).catch(function(err){console.error("err = ",err)})},taskChat:function(data){$state.go("chat",data)},taskPayment:function(data){$state.go("carddeatil",data)},taskDetailsViewModal:function(index){$uibModal.open({animation:!0,templateUrl:"app/site/modules/accounts/views/taskdetails.view.modal.tab.html",controller:"TaskViewModalInstanceCtrl",controllerAs:"TDVMI",resolve:{TaskDetails:function(){return atc.taskList[index]},DefaultCurrency:function(){return atc.currency}}})},actionMenu:function(index){flag?(atc.action_menu=index,flag=!1):(flag=!0,atc.action_menu=-1)},taskCancelModal:function(id,status){$uibModal.open({animation:!0,templateUrl:"app/site/modules/accounts/views/task-cancel.modal.tab.html",controller:"TaskCancelModalInstanceCtrl",controllerAs:"TDCMI",resolve:{userid:function(){return id},status:function(){return status},cancelreason:function(){return atc.getcancelreason}}}).result.then(function(taskcanceldata){MainService.getData(routes.taskCancel,taskcanceldata).then(function(response){$("#assigned").removeClass("new-active"),$("#cancelled").addClass("new-active"),atc.getTaskLists("cancelled"),atc.taskCurrentPage=1}).catch(function(err){console.error("err = ",err)})})},addReviewModal:function(taskdetails){MainService.getData(routes.taskReview,{taskid:taskdetails._id}).then(function(response){$uibModal.open({animation:!0,templateUrl:"app/site/modules/accounts/views/userreview.modal.tab.html",controller:"AddReviewModalInstanceCtrl",controllerAs:"ARM",resolve:{TaskDetails:function(){return taskdetails}}}).result.then(function(data){MainService.getData(routes.addUserReview,data).then(function(response){atc.reviewdata=response,atc.getTaskLists("completed")})})})},taskDetailsViewModalforstatus:function(index){$uibModal.open({animation:!0,templateUrl:"app/site/modules/accounts/views/taskdetailsforstatus.modal.tab.html",controller:"TaskDetailsViewforstatusModalInstanceCtrl",controllerAs:"TDVSMI",resolve:{TaskDetails:function(){return atc.taskList[index]},defaultcurrency:function(){return atc.currency}}})}})}function TaskViewModalInstanceCtrl($uibModalInstance,TaskDetails,DefaultCurrency){this.TaskDetails=TaskDetails,this.DefaultCurrency=DefaultCurrency,console.log(this.DefaultCurrency,"jjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjj"),this.taskdescription=TaskDetails.task_description,angular.extend(this,{cancel:function(){$uibModalInstance.dismiss("cancel")}})}function TaskCancelModalInstanceCtrl($uibModalInstance,userid,status,cancelreason,toastr,$translate){var tdcmi=this;tdcmi.userid=userid,tdcmi.taskstatus=status,tdcmi.cancelreason=cancelreason,tdcmi.other=0,angular.extend(tdcmi,{click:function(other){tdcmi.other=0},otherclick:function(other){tdcmi.other=1},cancel:function(){$uibModalInstance.dismiss("cancel")},ok:function(data){data.reason||data.otherreason?$uibModalInstance.close(tdcmi):$translate("REASON FIELD IS EMPTY").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})}})}function AddReviewModalInstanceCtrl($uibModalInstance,TaskDetails,$scope,$state){var arm=this;arm.user=TaskDetails.user,arm.tasker=TaskDetails.tasker._id,arm.task=TaskDetails._id,arm.type="user",angular.extend(arm,{cancel:function(){$uibModalInstance.dismiss("cancel")},ok:function(){$uibModalInstance.close(arm),$state.go("account.tasks")}})}function TaskDetailsViewforstatusModalInstanceCtrl($uibModalInstance,TaskDetails,defaultcurrency){this.defaultcurrency=defaultcurrency,this.TaskDetails=TaskDetails;var a=TaskDetails.invoice.worked_hours,hours=Math.trunc(a/60),minutes=a%60;this.Task_time=0==hours?.1==minutes?minutes+" min":minutes+" mins":hours+" hours "+minutes+" mins",this.taskdescription=TaskDetails.task_description,angular.extend(this,{ok:function(){$uibModalInstance.close()},cancel:function(){$uibModalInstance.dismiss("cancel")}})}function AccountProfileCtrl($scope,$rootScope,$translate,MainService,routes,toastr,AuthenticationService,$cookieStore,$state,$uibModal){var acc=this;acc.phn=$rootScope.accountProfile.phone,$scope.currentUser=$rootScope.userId,$scope.visibleValue=!1,$scope.myImage="",acc.myCroppedImage="",$scope.imageChangeValue=!1,$scope.handleFileSelect=function(evt){var file=evt.currentTarget.files[0];if("1MB"==file.$errorParam||"pattern"==file.$error?($scope.visibleValue=!1,file=null):($scope.visibleValue=!0,$scope.imageChangeValue=!0),file){var reader=new FileReader;reader.onload=function(evt){$scope.$apply(function($scope){$scope.myImage=evt.target.result})},reader.readAsDataURL(file)}},angular.isDefined($rootScope.accountProfile)&&(user=$rootScope.accountProfile||{},acc.account=$rootScope.accountProfile||{}),console.log("acc.account",acc.account),$scope.account=!0,$scope.editProfile=!1,$scope.editBtn=!0,$rootScope.taskerotp="",$rootScope.tasker_mobile={},MainService.getData(routes.getQuestion,{}).then(function(response){acc.getQuestion=response}).catch(function(err){console.error("error = ",err)}),acc.account.profile_details&&(acc.account.profile_details.length>0?acc.profileDetails=acc.account.profile_details.reduce(function(total,current){return total[current.question]=current.answer,total},{}):(acc.profileDetails=[],acc.account.profile_details=[])),angular.extend($scope,{user:user,EditProfileBtn:function(){$scope.editBtn=!1,$scope.account=!1,$scope.editProfile=!0},CancelEditBtn:function(){$scope.editBtn=!0,$scope.account=!0,$scope.editProfile=!1,console.log("view"),$state.reload()},UpdateUserProfile:function(isvalid,form){isvalid?($rootScope.mode="",$rootScope.otp="",$rootScope.mobile={},acc.account.avatarBase64=acc.myCroppedImage,MainService.checkMobileExists("user",acc.account.phone).then(function(userdata){0==userdata.length?MainService.generateotp(acc.account.phone).then(function(otpdetails){otpdetails?($scope.showUserOTPForm=!0,(otpdetails.sms="development")&&($rootScope.otp=otpdetails.otpkey,$rootScope.mode=otpdetails.sms,$rootScope.mobile=acc.account.phone),$uibModal.open({animation:!0,templateUrl:"app/site/modules/accounts/views/otp.modal.tab.html",controller:"OTPModelCtrl",controllerAs:"OTPC"}).result.then(function(otp){$rootScope.otp==otp?MainService.getData(routes.userUpdateAcc,acc.account).then(function(response){if(1==response.status)$translate(response.message).then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)}),user=$rootScope.accountProfile||{},acc.account.phone=acc.phn;else if(1===response.result.nModified){var userdata=AuthenticationService.GetCredentials();$rootScope.siteglobals={currentUser:{username:userdata.currentUser.username,user_id:userdata.currentUser.user_id,authdata:userdata.currentUser.authdata,user_type:userdata.currentUser.user_type,tasker_status:userdata.currentUser.tasker_status,avatar:userdata.currentUser.avatar}},$scope.visibleValue=!1,$rootScope.currAccAvatar=userdata.currentUser.avatar,$cookieStore.remove("siteglobals"),$cookieStore.put("siteglobals",$rootScope.siteglobals),$state.reload(),$translate("UPDATED PROFILE SUCCESFULLY").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)})}}).catch(function(err){console.log("err",err),400==err.status?$translate(err.data.msg).then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)}):$translate("UNABLE TO UPDATE PROFILE SUCCESFULLY").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})}):toastr.error("OTP Mismatched")})):toastr.error("Unable to generate OTP")}):MainService.getData(routes.userUpdateAcc,acc.account).then(function(response){if(1==response.status)$translate(response.message).then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)}),user=$rootScope.accountProfile||{},acc.account.phone=acc.phn;else if(1===response.result.nModified){var userdata=AuthenticationService.GetCredentials();$rootScope.siteglobals={currentUser:{username:userdata.currentUser.username,user_id:userdata.currentUser.user_id,authdata:userdata.currentUser.authdata,user_type:userdata.currentUser.user_type,tasker_status:userdata.currentUser.tasker_status,avatar:userdata.currentUser.avatar}},$scope.visibleValue=!1,$rootScope.currAccAvatar=userdata.currentUser.avatar,$cookieStore.remove("siteglobals"),$cookieStore.put("siteglobals",$rootScope.siteglobals),$state.reload(),$translate("UPDATED PROFILE SUCCESFULLY").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)})}}).catch(function(err){console.log("err",err),400==err.status?$translate(err.data.msg).then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)}):$translate("UNABLE TO UPDATE PROFILE SUCCESFULLY").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})})})):$translate("PLEASE FILL ALL MANDATORY FIELDS").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})},UpdateTaskerProfile:function(isvalid,form){isvalid?(acc.account.avatarBase64=acc.myCroppedImage,$rootScope.mode="",$rootScope.otp="",$rootScope.mobile={},MainService.checkMobileExists("tasker",acc.account.phone).then(function(taskerdata){0==taskerdata.length?MainService.generateotp(acc.account.phone).then(function(otpdetails){otpdetails?($scope.showTaskerOTPForm=!0,(otpdetails.sms="development")&&($rootScope.otp=otpdetails.otpkey,$rootScope.mode=otpdetails.sms,$rootScope.mobile=acc.account.phone),$uibModal.open({animation:!0,templateUrl:"app/site/modules/accounts/views/otp.modal.tab.html",controller:"OTPModelCtrl",controllerAs:"OTPC"}).result.then(function(otp){$rootScope.otp==otp&&MainService.getData(routes.taskerUpdateAcc,acc.account).then(function(response){if(1==response.status)$translate(response.message).then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)});else if(1===response.result.nModified){var userdata=AuthenticationService.GetCredentials();$rootScope.siteglobals={currentUser:{username:userdata.currentUser.username,user_id:userdata.currentUser.user_id,authdata:userdata.currentUser.authdata,user_type:userdata.currentUser.user_type,tasker_status:userdata.currentUser.tasker_status,avatar:userdata.currentUser.avatar}},$rootScope.currAccAvatar=userdata.currentUser.avatar,$cookieStore.remove("siteglobals"),$cookieStore.put("siteglobals",$rootScope.siteglobals),$state.reload(),$translate("UPDATED PROFILE SUCCESFULLY").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)})}}).catch(function(err){$translate("UNABLE TO UPDATE PROFILE SUCCESFULLY").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})})})):toastr.error("Unable to generate OTP")}):MainService.getData(routes.taskerUpdateAcc,acc.account).then(function(response){if(1==response.status)$translate(response.message).then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)});else if(1===response.result.nModified){var userdata=AuthenticationService.GetCredentials();$rootScope.siteglobals={currentUser:{username:userdata.currentUser.username,user_id:userdata.currentUser.user_id,authdata:userdata.currentUser.authdata,user_type:userdata.currentUser.user_type,tasker_status:userdata.currentUser.tasker_status,avatar:userdata.currentUser.avatar}},$rootScope.currAccAvatar=userdata.currentUser.avatar,$cookieStore.remove("siteglobals"),$cookieStore.put("siteglobals",$rootScope.siteglobals),$state.reload(),$translate("UPDATED PROFILE SUCCESFULLY").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)})}}).catch(function(err){$translate("UNABLE TO UPDATE PROFILE SUCCESFULLY").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})})})):$translate("PLEASE FILL ALL MANDATORY FIELDS").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})},accountPlaceChanged:function(){var place=this.getPlace();acc.lng=place.geometry.location.lng(),acc.lat=place.geometry.location.lat(),acc.formatted_address=place.formatted_address;var locationa=place;acc.account.address.formatted_address=place.formatted_address,acc.account.address.line1=place.formatted_address,acc.account.address.line2="",locationa.name&&(acc.account.address.line1=locationa.name);for(var i=0;i<locationa.address_components.length;i++)for(var j=0;j<locationa.address_components[i].types.length;j++)"neighborhood"==locationa.address_components[i].types[j]&&acc.account.address.line1!=locationa.address_components[i].long_name&&(""!=acc.account.address.line1?acc.account.address.line1=acc.account.address.line1+","+locationa.address_components[i].long_name:acc.account.address.line1=locationa.address_components[i].long_name),"route"==locationa.address_components[i].types[j]&&acc.account.address.line1!=locationa.address_components[i].long_name&&(""!=acc.account.address.line2?acc.account.address.line2=acc.account.address.line2+","+locationa.address_components[i].long_name:acc.account.address.line2=locationa.address_components[i].long_name),"street_number"==locationa.address_components[i].types[j]&&(""!=acc.account.address.line2?acc.account.address.line2=acc.account.address.line2+","+locationa.address_components[i].long_name:acc.account.address.line2=locationa.address_components[i].long_name),"sublocality_level_1"==locationa.address_components[i].types[j]&&(""!=acc.account.address.line2?acc.account.address.line2=acc.account.address.line2+","+locationa.address_components[i].long_name:acc.account.address.line2=locationa.address_components[i].long_name),"locality"==locationa.address_components[i].types[j]&&(acc.account.address.city=locationa.address_components[i].long_name),"country"==locationa.address_components[i].types[j]&&(acc.account.address.country=locationa.address_components[i].long_name),"postal_code"==locationa.address_components[i].types[j]&&(acc.account.address.zipcode=locationa.address_components[i].long_name),"administrative_area_level_1"!=locationa.address_components[i].types[j]&&"administrative_area_level_2"!=locationa.address_components[i].types[j]||(acc.account.address.state=locationa.address_components[i].long_name)},UpdateTaskerAbout:function(isvalid,profileDetails){var i=0;for(var key in acc.profileDetails)acc.account.profile_details.filter(function(obj){return obj.question===key})[0]?acc.account.profile_details[i].answer=acc.profileDetails[key]:acc.account.profile_details.push({question:key,answer:acc.profileDetails[key]}),i++;var data={_id:acc.account._id,profile_details:acc.account.profile_details};MainService.getData(routes.updateAbout,data).then(function(response){1===response.nModified?$translate("UPDATED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)}):$translate("UNABLE TO SAVE YOUR DATA").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})}).catch(function(err){console.log("error === ",err),$translate("UNABLE TO SAVE YOUR DATA").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})})}})}function OTPModelCtrl($scope,$rootScope,toastr,$uibModalInstance,MainService){var otpc=this;"development"==$rootScope.mode&&(otpc.otp=$rootScope.otp),angular.extend(otpc,{ok:function(){$rootScope.otp!=otpc.otp?toastr.error("OTP Mismatched"):$uibModalInstance.close(otpc.otp)},cancel:function(){otpc.otp="",$uibModalInstance.dismiss("cancel")},resend:function(){var data={};data.code=$rootScope.mobile.code,data.phone=$rootScope.mobile.number,MainService.generateotp(data).then(function(response,err){"development"==response.sms?(otpc.otp=response.otpkey,$rootScope.otp=response.otpkey):$rootScope.otp=response.otpkey,toastr.success("OTP sent successfully")})}})}function AccountInviteFriends($scope,$rootScope,$state,MainService,routes,$window){if(angular.isDefined($rootScope.settings)&&angular.isDefined($rootScope.seoSettings)&&angular.isDefined($rootScope.accountProfile)&&angular.isDefined($rootScope.defaultCurrency)){$rootScope.seoSettings;var settingsData=$rootScope.settings,user=$rootScope.accountProfile,defaultCurrency=$rootScope.defaultCurrency}angular.extend($scope,{facebookInviteFriends:function(){var invite={};invite.name="Signup with my code - "+settingsData.site_title,invite.link=settingsData.site_url,invite.description="Signup with my code "+user.unique_code+" to earn "+defaultCurrency.symbol+settingsData.referral.amount.referral+" on your "+settingsData.site_title+" wallet",invite.picture=settingsData.site_url+"uploads/default/facebook-share.jpg",FB.ui({method:"send",name:invite.name,link:invite.link,description:invite.description,picture:invite.picture})},googleInviteFriends:function(){var bodyText="Refer and Earn, when your friend signup with your referral code, you earn "+settingsData.referral.amount.referrer+" in your wallet and your friend earn "+settingsData.referral.amount.referral+" A Signup using the code "+user.unique_code+" and earn money in your wallet !Download: "+settingsData.site_url;$window.open("mailto:?subject=Invitation for Registration&body="+bodyText,"_blank")}})}function AccountDeactivateCtrl($scope,$rootScope,$state,MainService,routes,toastr,$translate,$uibModal,swal,AuthenticationService){var adc=this,userId=$rootScope.userId;angular.isDefined($rootScope.accountProfile)&&(adc.user=$rootScope.accountProfile),angular.extend($scope,{deactivateACC:function(){swal({title:"Are you sure?",text:"You will be deactivate from this site!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, Deactivate!"}).then(function(response){if(response&&(adc.user._id===userId&&"user"===adc.user.role&&(userid=$rootScope.userId,MainService.getData(routes.userDeactiveAcc,{userid:userid}).then(function(response){$translate("YOUR ACCOUNT DEACTIVATED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)}),AuthenticationService.ClearCredentials(),$state.go("landing",{},{reload:!0})}).catch(function(err){console.error("err = ",err),$translate("UNABLE TO SAVE YOUR DATA").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})})),adc.user._id===userId&&"tasker"===adc.user.role)){var userid=$rootScope.userId;MainService.getData(routes.taskerDeactiveAcc,{userid:userid}).then(function(response){$translate("YOUR ACCOUNT DEACTIVATED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)}),AuthenticationService.ClearCredentials(),$state.go("landing",{},{reload:!0})}).catch(function(err){console.error("err = ",err),$translate("UNABLE TO SAVE YOUR DATA").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})})}}).catch(function(err){})}})}function DeactivateModalCtrl($scope,$rootScope,$state,toastr,$translate,$uibModalInstance,userResolve){angular.isDefined(userResolve)&&($scope.user=userResolve),angular.extend($scope,{ok:function(){$uibModalInstance.close($scope.user),$state.go("account.deactivate",{},{reload:!1})},cancel:function(){$uibModalInstance.dismiss("cancel")}})}function AccountTransactionCtrl($scope,$rootScope,$state,MainService,routes,toastr,$translate,$uibModal){var atc=this,userId=$rootScope.userId;atc.itemsPerPage=5,atc.transtotalItem=0,atc.transCurrentPage=1,angular.isDefined($rootScope.accountProfile)&&(atc.user=$rootScope.accountProfile,$scope.currency=$rootScope.currency),angular.extend(atc,{getTransaction:function(page){var transURL="user"===atc.user.role?routes.userTransactions:routes.taskerTransactions,curpage=page||atc.transCurrentPage,data={id:userId,skip:curpage,limit:atc.itemsPerPage};MainService.getData(transURL,data).then(function(response){response&&(atc.usertranscation=response.result,atc.transtotalItem=response.count)}).catch(function(err){console.error("err = ",err)})},taskUserTranscationViewModal:function(index,catid){var taskUserTransaction=atc.usertranscation[index],transcation={};transcation.date=taskUserTransaction.updatedAt,transcation.invoice=taskUserTransaction.invoice,transcation.bookingid=taskUserTransaction._id,taskUserTransaction.transactions&&(transcation.transcationid=taskUserTransaction.transactions[0]),transcation.categoryname=taskUserTransaction.category.name;var taskerskills=taskUserTransaction.tasker.taskerskills;angular.forEach(taskerskills,function(key,value){key.childid==taskUserTransaction.category._id&&(transcation.perHour=key.hour_rate)}),transcation.worked_hours=taskUserTransaction.invoice.worked_hours,transcation.username=taskUserTransaction.user.username,transcation.addresss=taskUserTransaction.billing_address.city,transcation.tasker_earn=taskUserTransaction.invoice.amount.admin_commission,$uibModal.open({animation:!0,templateUrl:"app/site/modules/accounts/views/model/usertransaction.modal.html",controller:"TaskUserTranscationViewModalCtrl",controllerAs:"TTEMC",size:"lg",resolve:{TaskDetails:function(){return transcation},task:function(){return atc.usertranscation[index]},defaultcurrency:function(){return $scope.currency},getsettings:function(MainService){return MainService.getData(routes.settingUrl,{})},getmaincatname:function(MainService){var data=catid;return MainService.getData(routes.getmaincat,{data:data})}}}).result.then(function(data){},function(){})},taskTranscationViewModal:function(index,catid){var taskUserTransaction=atc.usertranscation[index],transcation={};transcation.date=taskUserTransaction.updatedAt,transcation.invoice=taskUserTransaction.invoice,transcation.bookingid=taskUserTransaction._id,taskUserTransaction.transactions&&(transcation.transcationid=taskUserTransaction.transactions[0]),transcation.categoryname=taskUserTransaction.category.name;var taskerskills=taskUserTransaction.tasker.taskerskills;angular.forEach(taskerskills,function(key,value){key.childid==taskUserTransaction.category._id&&(transcation.perHour=key.hour_rate)}),transcation.worked_hours=taskUserTransaction.invoice.worked_hours,transcation.username=taskUserTransaction.user.username,transcation.addresss=taskUserTransaction.billing_address.city,transcation.tasker_earn=taskUserTransaction.invoice.amount.admin_commission,$uibModal.open({animation:!0,templateUrl:"app/site/modules/accounts/views/model/transaction.modal.html",controller:"TaskTranscationViewModalCtrl",controllerAs:"TTEMS",size:"lg",resolve:{TaskDetails:function(){return transcation},task:function(){return atc.usertranscation[index]},defaultcurrency:function(){return $scope.currency},getsettings:function(MainService){return MainService.getData(routes.settingUrl,{})},getmaincatname:function(MainService){var data=catid;return MainService.getData(routes.getmaincat,{data:data})}}}).result.then(function(data){},function(){})}})}function TaskUserTranscationViewModalCtrl($scope,task,$uibModalInstance,TaskDetails,defaultcurrency,getsettings,getmaincatname,MainService,routes){var ttemc=this;ttemc.TaskDetails=TaskDetails,ttemc.task=task,ttemc.maincategoryname=getmaincatname.name,ttemc.defaultcurrency=defaultcurrency,ttemc.getsettings=getsettings,(ttemc.TaskDetails.invoice.amount.total+ttemc.TaskDetails.invoice.amount.service_tax)*ttemc.defaultcurrency.value>ttemc.TaskDetails.invoice.amount.coupon*ttemc.defaultcurrency.value?(ttemc.checkvalue="big",ttemc.total=(((ttemc.TaskDetails.invoice.amount.total+ttemc.TaskDetails.invoice.amount.service_tax+ttemc.TaskDetails.invoice.amount.extra_amount)*ttemc.defaultcurrency.value-ttemc.TaskDetails.invoice.amount.coupon)*ttemc.defaultcurrency.value).toFixed(2)):(ttemc.checkvalue="small",ttemc.total=((ttemc.TaskDetails.invoice.amount.extra_amount+ttemc.TaskDetails.invoice.amount.service_tax)*ttemc.defaultcurrency.value).toFixed(2)),angular.extend(ttemc,{cancel:function(){$uibModalInstance.dismiss("cancel")},ok:function(){$uibModalInstance.close(ttemc.review)},downloadPdf:function(){var _id=ttemc.TaskDetails.bookingid;MainService.getData(routes.pdf,{_id:_id}).then(function(response){}).catch(function(err){})}})}function TaskTranscationViewModalCtrl($scope,task,$uibModalInstance,TaskDetails,defaultcurrency,getsettings,getmaincatname,MainService,routes){var ttemc=this;ttemc.TaskDetails=TaskDetails,ttemc.task=task,ttemc.maincategoryname=getmaincatname.name,ttemc.defaultcurrency=defaultcurrency,ttemc.getsettings=getsettings,(ttemc.TaskDetails.invoice.amount.total+ttemc.TaskDetails.invoice.amount.service_tax)*ttemc.defaultcurrency.value>ttemc.TaskDetails.invoice.amount.coupon*ttemc.defaultcurrency.value?(ttemc.checkvalue="big",ttemc.total=(((ttemc.TaskDetails.invoice.amount.total+ttemc.TaskDetails.invoice.amount.service_tax+ttemc.TaskDetails.invoice.amount.extra_amount)*ttemc.defaultcurrency.value-ttemc.TaskDetails.invoice.amount.coupon)*ttemc.defaultcurrency.value).toFixed(2)):(ttemc.checkvalue="small",ttemc.total=((ttemc.TaskDetails.invoice.amount.extra_amount+ttemc.TaskDetails.invoice.amount.service_tax)*ttemc.defaultcurrency.value).toFixed(2)),angular.extend(ttemc,{cancel:function(){$uibModalInstance.dismiss("cancel")},ok:function(){$uibModalInstance.close(ttemc.review)},downloadPdf:function(){var _id=ttemc.TaskDetails.bookingid;MainService.getData(routes.pdf,{_id:_id}).then(function(response){}).catch(function(err){console.error("err = ",err)})}})}function AccountReviewCtrl($scope,$rootScope,$state,MainService,routes,$uibModal,toastr){var arc=this;angular.isDefined($rootScope.accountProfile)&&(arc.user=$rootScope.accountProfile||{}),arc.reviewListitemsPerPage=2,arc.reviewListtotalItem=0,arc.taskeractive=1,angular.extend(arc,{getUserReviewDetails:function(page){arc.pagination_status="review by you",arc.taskeractive=0,arc.index=1,arc.reviewListCurrentPage=void 0==page?1:page,1!=arc.reviewListCurrentPage?arc.sno=2*arc.reviewListCurrentPage-1:arc.sno=arc.reviewListCurrentPage;var data={id:$rootScope.userId,role:arc.user.role,skip:arc.reviewListCurrentPage,limit:arc.reviewListitemsPerPage};MainService.getData(routes.userReview,data).then(function(response){arc.reviewListtotalItem=response.count,arc.getReview=response.result,arc.finalResult=[],angular.forEach(arc.getReview,function(value,key){value.task&&arc.finalResult.push(value)})}).catch(function(err){console.error("err = ",err)})},getTaskerReviewDetails:function(page){arc.pagination_status="review to you",arc.taskeractive=1,arc.index=0;var role=arc.user.role;arc.reviewListCurrentPage=void 0==page?1:page,1!=arc.reviewListCurrentPage?arc.sno=2*arc.reviewListCurrentPage-1:arc.sno=arc.reviewListCurrentPage;var data={id:$rootScope.userId,role:role,skip:arc.reviewListCurrentPage,limit:arc.reviewListitemsPerPage};MainService.getData(routes.taskerReview,data).then(function(response){arc.reviewListtotalItem=response.count,arc.getReview=response.result,arc.finalResult=[],angular.forEach(arc.getReview,function(value,key){value.task&&arc.finalResult.push(value)})}).catch(function(err){console.error("err = ",err)})},reviewsModal:function(data,role){$uibModal.open({animation:!0,templateUrl:"app/site/modules/accounts/views/reviewdetails.view.modal.tab.html",controller:"ReviewModelCtrl",controllerAs:"RMC",resolve:{data:function(){return data},role:function(){return role||arc.user.role}}}).result.then(function(data){})}})}function ReviewModelCtrl($scope,$rootScope,$state,MainService,routes,toastr,$uibModalInstance,data,role){var rmc=this;rmc.reviewData=data,rmc.role=role,angular.extend(rmc,{ok:function(){$uibModalInstance.close(rmc)},cancel:function(){$uibModalInstance.dismiss("cancel")}})}function AccountHeaderCtrl($scope,$rootScope,$state,toastr,accountProfileResolve,seoSettingsResolve,settingsResolve,defaultCurrency,$cookieStore){var ahc=this;angular.isDefined(accountProfileResolve)&&angular.isDefined(seoSettingsResolve)&&angular.isDefined(settingsResolve)&&(ahc.currentAcc=accountProfileResolve.result[0],ahc.avatarImage=accountProfileResolve.result[0].avatar||"/uploads/default/user.jpg",$rootScope.accountProfile=accountProfileResolve.result[0],ahc.settings=settingsResolve.settings,$rootScope.seoSettings=seoSettingsResolve,$cookieStore.get("Currency")?$rootScope.defaultCurrency=$cookieStore.get("Currency"):$rootScope.defaultCurrency=defaultCurrency),"account.wallet"==$state.current.name&&0==ahc.settings.wallet.status&&$state.go("account.profile"),"account.invites"==$state.current.name&&0==ahc.settings.referral.status&&$state.go("account.profile");var currentUser=$rootScope.userId;$scope.menus=[],currentUser===ahc.currentAcc._id&&"tasker"===ahc.currentAcc.role?$scope.menus=[{link:"account.profile",status:"active",name:"Profile"},{link:"account.about",status:"active",name:"About"},{link:"account.information",status:"active",name:"Account"},{link:"account.category",status:"active",name:"Category"},{link:"account.availabity",status:"active",name:"Availability"},{link:"account.job",status:"active",name:"Task Details"},{link:"account.transactions",status:"active",name:"Transactions"},{link:"account.reviews",status:"active",name:"Reviews"}]:currentUser===ahc.currentAcc._id&&"user"===ahc.currentAcc.role&&($scope.menus=[{link:"account.profile",status:"active",name:"Profile"},{link:"account.tasks",status:"active",name:"Task Details"},{link:"account.invites",status:"active",name:"Invite Friends"},{link:"account.wallet",status:"active",name:"Wallet"},{link:"account.transactions",status:"active",name:"Transactions"},{link:"account.reviews",status:"active",name:"Reviews"}],0==ahc.settings.wallet.status&&($scope.menus=$scope.menus.filter(function(menu){return"account.wallet"!=menu.link})),0==ahc.settings.referral.status&&($scope.menus=$scope.menus.filter(function(menu){return"account.invites"!=menu.link})))}function AccountInformationCtrl($scope,$rootScope,$state,toastr,$translate,MainService,routes){var aic=this;angular.isDefined($rootScope.accountProfile)&&(aic.user=$rootScope.accountProfile),aic.banking={},aic.banking=aic.user.banking,angular.extend(aic,{saveAccInfo:function(isvalid,form){aic.banking&&(aic.banking.userId=aic.user._id),isvalid?MainService.getData(routes.bank,form).then(function(response){1===response.nModified&&$translate("SAVED SUCCESSFULLY").then(function(headline){toastr.success(headline),$state.reload()},function(headline){toastr.error(headline)}),0===response.status&&$translate(response.message.msg).then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})}).catch(function(err){$translate("Error in save account info").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})}):$translate("please fill all mandatory fileds").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})}})}function AccountCategoryCtrl($scope,$rootScope,$state,toastr,MainService,routes,$uibModal,$translate){function updateCat(){var _id=$rootScope.userId;MainService.getData(routes.usercat,{_id:_id}).then(function(response){angular.isDefined(response)&&(acc.usercategories=response||[],$state.go("account.category",{},{reload:!1}))}).catch(function(err){console.error("err = ",err)})}var acc=this;angular.isDefined($rootScope.accountProfile)&&(acc.user=$rootScope.accountProfile,acc.currency=$rootScope.defaultCurrency);var id=$rootScope.userId;MainService.getData(routes.category,{}).then(function(response){return angular.isDefined(response)&&(acc.categories=response||[]),MainService.getData(routes.usercat,{_id:id})}).then(function(response1){return angular.isDefined(response1)&&(acc.usercategories=response1||[]),MainService.getData(routes.catexp,{})}).then(function(response2){angular.isDefined(response2)&&(acc.experiences=response2||[])}).catch(function(err){console.error("err = ",err)}),angular.extend(acc,{CategoryModal:function(category){$uibModal.open({animation:!0,templateUrl:"app/site/modules/accounts/views/category.modal.tab.html",controller:"CategoriesModalInstanceCtrl",controllerAs:"ACM",resolve:{experiences:function(){return acc.experiences},defaultcurrency:function(){return acc.currency},user:function(MainService,routes){return MainService.getData(routes.accEdit,{id:id})},categories:function(){return acc.categories},category:function(){return category}}}).result.then(function(selectedCategoryData){console.log("selectedCategoryData",selectedCategoryData),selectedCategoryData.hour_rate=selectedCategoryData.hour_rate/$scope.DefaultCurrency.value,MainService.getData(routes.addUpdateCat,selectedCategoryData).then(function(response){1===response.nModified&&$translate("UPDATED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)}),updateCat()}).catch(function(err){console.error("err = ",err),$translate("PLEASE ENTER THE VALID DATA").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})})})},DeletecategoryModal:function(category,catname){swal({title:"Delete Category",text:"Are you sure want to delete this category?",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, Delete!"}).then(function(response){if(response){var categoryinfo={};categoryinfo.userid=acc.user._id,categoryinfo.categoryid=category,categoryinfo.categoryname=catname,MainService.getData(routes.delCat,categoryinfo).then(function(response){1===response.nModified&&($translate("CATEGORY DELETED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)}),updateCat())}).catch(function(err){console.error("err = ",err)})}}).catch(function(err){})}}),console.log("$rootScope.accountProfile",$rootScope.accountProfile)}function CategoriesModalInstanceCtrl($scope,$rootScope,$state,toastr,MainService,routes,experiences,defaultcurrency,user,categories,category,$uibModalInstance,$translate){var acm=this;category?(acm.role="Edit",acm.user=user[0]):(acm.user=user[0],acm.role="New"),acm.defaultcurrency=defaultcurrency,acm.categories=categories,acm.experiences=experiences,acm.category=acm.categories.filter(function(obj){return obj._id===category})[0],acm.selectedCategoryData={},acm.selectedCategoryData.skills=[];for(var i=0;i<acm.user.taskerskills.length;i++)acm.user.taskerskills[i].childid==category&&(acm.selectedCategoryData=acm.user.taskerskills[i]);if(acm.selectedCategoryData.userid=acm.user._id,acm.category?acm.mode="EDIT":acm.mode="ADD",acm.selectedCategoryData.childid){var childid=acm.selectedCategoryData.childid;MainService.getData(routes.catChild,{id:childid}).then(function(response){response.ratetype&&(acm.ratetype=response.ratetype),acm.MinimumAmount=response.commision,"Flat"==acm.ratetype&&(acm.selectedCategoryData.hour_rate=parseFloat((response.commision*acm.defaultcurrency[0].value).toFixed(2))),acm.selectedCategoryData.ratetype=acm.ratetype}).catch(function(err){console.error("err = ",err)})}angular.extend(acm,{ok:function(valid){valid?$uibModalInstance.close(acm.selectedCategoryData):$translate("FORM IS INVALID").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})},cancel:function(){$uibModalInstance.dismiss("cancel")},onChangeCategoryChild:function(catchild){var id=catchild;MainService.getData(routes.catChild,{id:id}).then(function(response){console.log("response",response),response.ratetype&&(acm.ratetype=response.ratetype),acm.MinimumAmount=response.commision,acm.selectedCategoryData.hour_rate=parseFloat((response.commision*acm.defaultcurrency[0].value).toFixed(2)),acm.selectedCategoryData.ratetype=acm.ratetype}).catch(function(err){console.error("err = ",err)}),acm.category=acm.user.taskerskills.filter(function(obj){if(obj.childid!==catchild)return obj._id===catchild;$translate("ALREADY THE CATEGORY IS EXISTS").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)}),$uibModalInstance.dismiss("cancel")})[0]},onChangeCategory:function(category){acm.category=acm.categories.filter(function(obj){return obj._id===category})[0]}})}function AccountAvailabityCtrl($scope,$rootScope,$state,toastr,MainService,routes,$uibModal,$translate,$filter){var aac=this,userId=$rootScope.userId;if(angular.isDefined($rootScope.accountProfile)&&(aac.user=JSON.parse(JSON.stringify($rootScope.accountProfile))),"tasker"==aac.user.role&&aac.user._id===userId){var availableTimingSlotList=[{slot:0,time:"12AM - 1AM",selected:!1},{slot:1,time:"1AM - 2AM",selected:!1},{slot:2,time:"2AM - 3AM",selected:!1},{slot:3,time:"3AM - 4AM",selected:!1},{slot:4,time:"4AM - 5AM",selected:!1},{slot:5,time:"5AM - 6AM",selected:!1},{slot:6,time:"6AM - 7AM",selected:!1},{slot:7,time:"7AM - 8AM",selected:!1},{slot:8,time:"8AM - 9AM",selected:!1},{slot:9,time:"9AM - 10AM",selected:!1},{slot:10,time:"10AM - 11AM",selected:!1},{slot:11,time:"11AM - 12PM",selected:!1},{slot:12,time:"12PM - 1PM",selected:!1},{slot:13,time:"1PM - 2PM",selected:!1},{slot:14,time:"2PM - 3PM",selected:!1},{slot:15,time:"3PM - 4PM",selected:!1},{slot:16,time:"4PM - 5PM",selected:!1},{slot:17,time:"5PM - 6PM",selected:!1},{slot:18,time:"6PM - 7PM",selected:!1},{slot:19,time:"7PM - 8PM",selected:!1},{slot:20,time:"8PM - 9PM",selected:!1},{slot:21,time:"9PM - 10PM",selected:!1},{slot:22,time:"10PM - 11PM",selected:!1},{slot:23,time:"11PM - 12AM",selected:!1}],workingDays=[{day:"Sunday",slot:JSON.parse(JSON.stringify(availableTimingSlotList)),selected:!1,wholeday:!1},{day:"Monday",slot:JSON.parse(JSON.stringify(availableTimingSlotList)),selected:!1,wholeday:!1},{day:"Tuesday",slot:JSON.parse(JSON.stringify(availableTimingSlotList)),selected:!1,wholeday:!1},{day:"Wednesday",slot:JSON.parse(JSON.stringify(availableTimingSlotList)),selected:!1,wholeday:!1},{day:"Thursday",slot:JSON.parse(JSON.stringify(availableTimingSlotList)),selected:!1,wholeday:!1},{day:"Friday",slot:JSON.parse(JSON.stringify(availableTimingSlotList)),selected:!1,wholeday:!1},{day:"Saturday",slot:JSON.parse(JSON.stringify(availableTimingSlotList)),selected:!1,wholeday:!1}];aac.user.working_days&&(angular.forEach(workingDays,function(item){angular.forEach(aac.user.working_days,function(selecteditem){item.day==selecteditem.day&&(selecteditem.slots&&selecteditem.slots.length>0&&angular.forEach(item.slot,function(slots,skey){selecteditem.slots.includes(skey)&&(slots.selected=1!=selecteditem.wholeday)}),item.selected=1==selecteditem.selected,item.wholeday=1==selecteditem.wholeday)})}),aac.user.working_days=workingDays),$scope.clearSlots=function(day,wholeday,parentkey,event){angular.forEach(aac.user.working_days,function(days,key){angular.forEach(days.slot,function(slot,skey){day&&!wholeday&&parentkey==key&&(slot.selected=!1)})}),event.stopPropagation()},aac.taskerareaaddress=aac.user.availability_address,aac.radiusby=$rootScope.settings.distanceby,"km"==aac.radiusby?aac.radiusval=1e3:aac.radiusval=1609.34,aac.user.radius=$rootScope.settings.tasker_radius,$scope.maps=[],$scope.$on("mapInitialized",function(evt,evtMap){$scope.maps.push(evtMap)})}angular.extend(aac,{taskerareaChanged:function(){aac.place=this.getPlace(),aac.user.location={},aac.user.location.lng=aac.place.geometry.location.lng(),aac.user.location.lat=aac.place.geometry.location.lat(),aac.user.availability_address=aac.place.formatted_address;var dummy=aac.place.address_components.filter(function(value){return"locality"==value.types[0]}).map(function(data){return data});aac.dummyAddress=dummy.length},mapToInput:function(event){if($scope.maps[0]){aac.user.radius=parseInt($scope.maps[0].shapes.circle.radius/aac.radiusval);var lat=$scope.maps[0].shapes.circle.center.lat(),lng=$scope.maps[0].shapes.circle.center.lng(),latlng=new google.maps.LatLng(lat,lng),geocoder=geocoder=new google.maps.Geocoder;geocoder.geocode({latLng:latlng},function(results,status){"OK"==status&&$scope.$apply(function(){aac.taskerareaaddress=results[0].formatted_address,aac.user.availability_address=results[0].formatted_address,aac.user.location.lng=lng,aac.user.location.lat=lat})})}},saveAvailability:function(){var selected_days=[];aac.user.working_days&&angular.forEach(aac.user.working_days,function(days){if(days.selected)if(days.wholeday)selected_days.push({day:days.day,slots:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],selected:days.selected,wholeday:days.wholeday});else{var selected_slots=[];angular.forEach(days.slot,function(slot){slot.selected&&selected_slots.push(slot.slot)}),selected_days.push({day:days.day,slots:selected_slots,selected:days.selected,wholeday:days.wholeday})}}),aac.user.working_days=selected_days,""!=aac.user.location.lat&&""!=aac.user.location.lng?MainService.getData(routes.availabity,aac.user).then(function(response){$translate("UPDATED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}),$state.reload()}).catch(function(err){console.error("err = ",err),$translate("UNABLE TO SAVE YOUR DATA").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})}):toastr.error("Invalid Address")}})}function AccountUnavailabilityCtrl($scope,$rootScope,$state,toastr,MainService,routes,$uibModal,$translate,$filter){var auc=this,userId=$rootScope.userId;angular.isDefined($rootScope.accountProfile)&&(auc.user=$rootScope.accountProfile),"tasker"==auc.user.role&&auc.user._id===userId&&($scope.today=moment(),$scope.disable6MonthsFromNow=function(event,month){(month.isBefore(moment().subtract(2,"month"),"month")||month.isAfter(moment().add(2,"month"),"month"))&&(event.preventDefault(),toastr.error("Only 3 months allowed"))},auc.unavailable=[],auc.getUnavailableData=function(){auc.unavailable_dates=[],auc.unavailable_hours=[],auc.wholeday=0;$uibModal.open({animation:!0,backdrop:"static",keyboard:!1,templateUrl:"app/site/modules/accounts/views/new-account/unavailability.modal.html",controller:"UnavailabilityModalCtrl",controllerAs:"UAMIC"}).result.then(function(data){if(void 0!=data){for(var i=0;i<data.unavailableTimingSlotList.length;i++)data.unavailableTimingSlotList[i].selected&&auc.unavailable_hours.push(data.unavailableTimingSlotList[i].slot);for(var j=0;j<auc.unavailabledates.length;j++)auc.unavailable_dates.push(moment(auc.unavailabledates[j]).format("YYYY-MM-DD"))}}),auc.unavailable.push({date:auc.unavailable_dates,time:auc.unavailable_hours})}),angular.extend(auc,{saveUnavailability:function(){auc.user.unavailable_data=[],angular.forEach(auc.unavailable,function(value1,key1){angular.forEach(value1.date,function(value2,key2){key1==key2&&(value1.time.length>0?auc.user.unavailable_data.push({date:value2,slot:value1.time,wholeday:0}):auc.user.unavailable_data.push({date:value2,slot:value1.time,wholeday:1}))})}),MainService.getData(routes.unavailability,auc.user).then(function(response){$translate("UPDATED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}),$state.reload()}).catch(function(err){console.error("err = ",err),$translate("UNABLE TO SAVE YOUR DATA").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})})}})}function AccountTaskerJobCtrl($scope,$rootScope,$state,toastr,$uibModal,$translate,MainService,routes,$cookieStore){function getTaskDetailsByStaus(status,page){ajc.taskInvitation=[],ajc.status=status,"6"==status||"7"==status?status="completed":"8"==status?status="cancelled":"2"==status||"3"==status||"4"==status||"5"==status?status="ongoing":"1"==status&&(status="assigned"),ajc.CurrentPage=void 0==page?1:page;var data={_id:userId,status:status,skip:ajc.CurrentPage,limit:ajc.taskitemsPerPage};MainService.getData(routes.taskerTaskDetails,data).then(function(response){response.length>0&&(ajc.taskInvitationDetails=response,ajc.taskInvitation=response[0].TaskDetails,ajc.tasktotalItem=response[0].count),ajc.getTaskDetailsByStausResponse=!0}).catch(function(err){console.error("error = ",err)})}var ajc=this;angular.isDefined($rootScope.accountProfile)&&angular.isDefined($rootScope.settings)&&(ajc.user=$rootScope.accountProfile,ajc.getsettings=$rootScope.settings,ajc.currency=$rootScope.defaultCurrency);var userId=$rootScope.userId;ajc.taskitemsPerPage=5,ajc.CurrentPage=1,ajc.tasktotalItem=0,ajc.taskInvitation=[],ajc.getwalletdetails={},ajc.getsettings={},ajc.taskInvitationDetails=[],ajc.tasker=[],ajc.getTaskDetailsByStausResponse=!1;$scope.job_id={},$scope.job_id="HFA-",$scope.checkDefaultValue=function(){$scope.job_id&&"HFA-"===$scope.job_id.substring(0,4)||($scope.job_id="HFA-")},$scope.checkSearchDate=function(){ajc.searchTaskFrom>ajc.searchTaskTo&&(ajc.searchTaskFrom=void 0,ajc.searchTaskTo=void 0,toastr.error("Invalid date"))},$scope.clearSearch=function(){$scope.job_id="HFA-",ajc.searchTaskFrom=void 0,ajc.searchTaskTo=void 0,getTaskDetailsByStaus(ajc.status)};var flag=!0;MainService.getData(routes.taskCancelReason,{type:ajc.user.role}).then(function(response){angular.isDefined(response)&&(ajc.getcancelreason=response.length>0?response:{})}).catch(function(err){console.error("err = ",err)});var notification_status=$cookieStore.get("notification_status");notification_status?(2==notification_status||3==notification_status||4==notification_status||5==notification_status?($("#assigned").removeClass("new-active"),$("#ongoing").addClass("new-active"),getTaskDetailsByStaus("ongoing")):6==notification_status||7==notification_status?($("#assigned").removeClass("new-active"),$("#completed").addClass("new-active"),getTaskDetailsByStaus("completed")):8==notification_status?($("#assigned").removeClass("new-active"),$("#cancelled").addClass("new-active"),getTaskDetailsByStaus("cancelled")):1==notification_status&&($("#cancelled").addClass("new-active"),getTaskDetailsByStaus("assigned")),$cookieStore.remove("notification_status")):getTaskDetailsByStaus("assigned"),angular.extend(ajc,{taskChat:function(data){$state.go("chat",data)},getTaskDetailsByStaus:getTaskDetailsByStaus,getSearchTaskDetailsByStaus:function(status){ajc.status=status,"6"==status||"7"==status?status="completed":"8"==status?status="cancelled":"2"==status||"3"==status||"4"==status||"5"==status?status="ongoing":"1"==status&&(status="assigned");var data={_id:userId,status:status,jobid:$scope.job_id,taskfrom:ajc.searchTaskFrom,taskto:ajc.searchTaskTo,skip:ajc.CurrentPage,limit:ajc.taskitemsPerPage};$scope.job_id.length<=4&&void 0==ajc.searchTaskFrom&&void 0==ajc.searchTaskTo?toastr.error("Choose atleast one search option"):0==ajc.taskInvitation.length?toastr.warning("Search Results not found"):MainService.getSearchData(routes.searchTaskerTaskDetails,data).then(function(response){response.length>0?(ajc.taskInvitationDetails=response,ajc.taskInvitation=response[0].TaskDetails,ajc.tasktotalItem=response[0].count):ajc.taskInvitation=[],ajc.getTaskDetailsByStausResponse=!0}).catch(function(err){console.error("error = ",err)})},actionMenu:function(index){flag?(ajc.action_menu=index,flag=!1):(flag=!0,ajc.action_menu=-1)},TaskInviteViewModal:function(index){$uibModal.open({animation:!0,templateUrl:"app/site/modules/accounts/views/taskinvite.view.modal.tab.html",controller:"TaskInviteViewModalInstanceCtrl",controllerAs:"TVMI",resolve:{TaskInvite:function(){return console.log("ajc.taskInvitation[index]",ajc.taskInvitation[index]),ajc.taskInvitation[index]},DefaultCurrency:function(){return ajc.currency},getsettings:function(){return ajc.getsettings}}}).result.then(function(data){},function(){})},taskRejectModal:function(id,status){$uibModal.open({animation:!0,templateUrl:"app/site/modules/accounts/views/task-cancel.modal.tab.html",controller:"TaskDetailsCancelModalInstanceCtrl",controllerAs:"TDCMI",resolve:{userid:function(){return id},status:function(){return status},cancelreason:function(){return ajc.getcancelreason}}}).result.then(function(taskignoredata){MainService.getData(routes.ignoreTask,taskignoredata).then(function(response){ajc.currentPage=1,ajc.tabFourActive=!0,1==response.nModified?($("#assigned").removeClass("new-active"),$("#cancelled").addClass("new-active"),getTaskDetailsByStaus("cancelled")):getTaskDetailsByStaus("assigned")},function(){err.msg?$scope.addAlert(err.msg):$translate("UNABLE TO SAVE YOUR DATA").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})})},function(){})},updatetaskstatus:function(taskid,status,currentpage){var data={};data.taskid=taskid,data.status=status,MainService.getData(routes.UpdateTaskStatus,{data:data}).then(function(response){response.error?$translate(response.error).then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)}):3==response.status?$translate("YOU START-OFF THE TASK").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}):4==response.status?$translate("YOU ARRIVED TO THE TASK LOCATION").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}):6==response.status?$translate("YOUR REQUEST FOR CASH").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}):$translate("YOU STARTED TASK").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}),getTaskDetailsByStaus("ongoing",currentpage),6==response.status&&getTaskDetailsByStaus("completed"),ajc.currentPage=currentpage}).catch(function(err){console.error("err = ",err)})},taskerconfirmtask:function(taskid,taskerid,status){swal({title:"Confirm Task",text:"Are You Sure Want to Confirm",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, Confirm!"}).then(function(response){if(response){var data={};data.taskid=taskid,data.taskstatus=status,data.taskerid=taskerid,MainService.getData(routes.confirmTask,data).then(function(response){1==response.nModified?($("#assigned").removeClass("new-active"),$("#ongoing").addClass("new-active"),getTaskDetailsByStaus("ongoing")):getTaskDetailsByStaus("assigned"),response.error?toastr.error(response.error):"You have already booked a job in the chosen time, please choose a different time slot to perform job."==response&&toastr.warning(response)}).catch(function(err){err.msg?toastr.error(err.msg):$translate("UNABLE TO SAVE YOUR DATA").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})})}}).catch(function(err){})},TaskReviewModal:function(index){var modalInstance=$uibModal.open({animation:!0,templateUrl:"app/site/modules/accounts/views/task-review.modal.html",controller:"TaskReviewModalCtrl",controllerAs:"TREM",resolve:{TaskDetails:function(){return ajc.taskInvitation[index]}}}),userdata=ajc.taskInvitation[index];modalInstance.result.then(function(data){console.log("dddaaaattttaaaa",data);var reviewdata={};reviewdata.rating=data.review.rating,reviewdata.comments=data.review.comments,reviewdata.user=userdata.user._id,reviewdata.tasker=userdata.tasker,reviewdata.task=userdata._id,reviewdata.type="tasker",MainService.getData(routes.insertReview,reviewdata).then(function(response){getTaskDetailsByStaus("completed")}).catch(function(err){})})},TaskerextrapriceModal:function(taskid,status){$uibModal.open({animation:!0,templateUrl:"app/site/modules/accounts/views/taskerextraprice.view.modal.tab.html",controller:"TaskerExtraViewModalInstanceCtrl",controllerAs:"TEVMI",resolve:{Taskid:function(){return taskid},status:function(){return status},DefaultCurrency:function(){return ajc.currency}}}).result.then(function(data){MainService.getData(routes.taskComplete,data).then(function(response){6==response.status?($("#ongoing").removeClass("new-active"),$("#completed").addClass("new-active"),getTaskDetailsByStaus("completed"),$translate("TASK_COMPLETED").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)})):($translate("UNABLE TO SAVE YOUR DATA").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)}),getTaskDetailsByStaus("ongoing")),ajc.currentPage=1}).catch(function(err){console.error("err= ",err)})})}})}function TaskInviteViewModalInstanceCtrl($uibModalInstance,TaskInvite,DefaultCurrency,getsettings){this.TaskInvite=TaskInvite,this.DefaultCurrency=DefaultCurrency,this.getsettings=getsettings,angular.extend(this,{ok:function(working_day,index){$uibModalInstance.close({})},cancel:function(){$uibModalInstance.dismiss("cancel")}})}function TaskDetailsCancelModalInstanceCtrl($translate,$uibModalInstance,$state,userid,status,toastr,cancelreason){var tdcmi=this;tdcmi.userid=userid,tdcmi.taskstatus=status,tdcmi.cancelreason=cancelreason,tdcmi.other=0,angular.extend(tdcmi,{ok:function(data){data.reason||data.otherreason?$uibModalInstance.close(tdcmi):$translate("REASON FIELD IS EMPTY").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})},cancel:function(){$uibModalInstance.dismiss("cancel")},otherclick:function(other){tdcmi.other=1},click:function(other){tdcmi.other=0}})}function TaskerExtraViewModalInstanceCtrl($uibModalInstance,$translate,Taskid,status,DefaultCurrency,toastr){var tevmi=this;tevmi.defaultcurrency=DefaultCurrency,tevmi.addmaterial=!1,tevmi.total=0,tevmi.choices=[],tevmi.calculateChoice=function(){if(tevmi.total=0,tevmi.newchoice)for(var i=0;i<tevmi.choices.length;i++)tevmi.newchoice.value[i]&&(tevmi.total=tevmi.total+parseFloat(tevmi.newchoice.value[i]))},tevmi.taskid=Taskid,tevmi.defaultCurrency=DefaultCurrency,tevmi.status=status;var newdata=[];angular.extend(tevmi,{cancel:function(){$uibModalInstance.dismiss("cancel")},ok:function(test,valid){if(valid||1!=test.addmaterial)if(test.newchoice&&test.choices.length>0){for(var i=0;i<test.choices.length;i++)(data={}).name=test.newchoice.name[i],data.price=parseFloat((test.newchoice.value[i]/tevmi.defaultcurrency[0].value).toFixed(2)),newdata.push(data);tevmi.newdata=newdata,$uibModalInstance.close(tevmi)}else if(1==tevmi.addmaterial)$translate("PLEASE ENTER ADD FEILD").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)});else{var data={};data.taskid=test.taskid,data.status=test.status,$uibModalInstance.close(data)}else $translate("PLEASE ENTER ALL FEILD").then(function(headline){toastr.error(headline)},function(translationId){toastr.error(headline)})},removeChoice:function(){var lastItem=tevmi.choices.length-1;0!=lastItem?(tevmi.newchoice&&(tevmi.newchoice.value[lastItem]="",tevmi.newchoice.name[lastItem]=""),tevmi.choices.pop({id:"choice"+lastItem})):(tevmi.addmaterial=!1,tevmi.newchoice.value[lastItem]="",tevmi.newchoice.name[lastItem]="",tevmi.choices.pop({id:"choice"+lastItem})),tevmi.calculateChoice()},addNewChoice:function(){var newItemNo=tevmi.choices.length+1;tevmi.choices.length>0?tevmi.newchoice&&tevmi.newchoice.name[tevmi.choices.length-1]&&tevmi.newchoice.value[tevmi.choices.length-1]&&tevmi.choices.push({id:"choice"+newItemNo}):tevmi.choices.push({id:"choice"+newItemNo}),tevmi.calculateChoice()}})}function TaskReviewModalCtrl($uibModalInstance,TaskDetails){var trem=this;trem.TaskDetails=TaskDetails,angular.extend(trem,{cancel:function(){$uibModalInstance.dismiss("cancel")},ok:function(){$uibModalInstance.close(trem)}})}function messagesCtrl(MessageserviceResolve,MessageService,CurrentuserResolve,$uibModal,toastr,$translate,swal){var msg=this;msg.messages=MessageserviceResolve.messages,msg.msgtotalItem=MessageserviceResolve.count.length,msg.currentPage=1,msg.msgitemsPerPage=2,msg.sno=1,msg.messages1=msg.messages.filter(function(value){if(value.task)return value}).map(function(value){return value}),msg.currentusertype=CurrentuserResolve.user_type,msg.currentuserid=CurrentuserResolve.user_id,msg.deletemessage=function(taskid,userid,taskerid,currentpage){var ids={};ids.taskid=taskid,ids.userid=userid,ids.taskerid=taskerid,swal({title:"Delete Conversation",text:"Are you sure you want to delete this conversation?",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, Delete!"}).then(function(response){response&&MessageService.deleteConversation(ids,msg.currentusertype).then(function(response){$translate("MESSAGE DELETED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(translationId){toastr.success(headline)}),MessageService.getMessage(msg.currentuserid,msg.currentusertype,0,3).then(function(response){msg.messages=response.messages,msg.messages1=msg.messages.filter(function(value){if(value.task)return value}).map(function(value){return value}),msg.getMessage(currentpage)},function(){})})}).catch(function(err){})},msg.msgitemsPerPage=3,msg.getMessage=function(page){msg.sno=1!=page?3*page-2:page,MessageService.getMessage(msg.currentuserid,msg.currentusertype,page,msg.msgitemsPerPage).then(function(response){response&&(msg.messages=response.messages,msg.msgtotalItem=response.count.length,msg.messages1=msg.messages.filter(function(value){if(value.task)return value}).map(function(value){return value}))})}}function chatCtrl(ChatServiceResolve,$state,toastr,$filter,AuthenticationService,TaskProfileResolve,MainService,$stateParams,socket,$scope,$rootScope,TaskServiceResolve,TaskService,CurrentuserResolve,$translate,$uibModal){function webupdatechat(data){console.log("firstcheckdata",data),chat.data.task==data.task&&chat.data.tasker._id==data.tasker&&chat.data.user._id==data.user&&(chat.messages.push(data.messages[0]),data.messages[0].from!=chat.currentUser&&(data.currentuserid=$rootScope.userId,data.usertype=$rootScope.usertype,socket.emit("single message status",data)),setTimeout(function(){$("#chatscroll").scrollTop($("#chatscroll").scrollTop()+$("#chatscroll .chat-cnt:last").position().top)},0))}function singlemessagestatus(data){chat.messages=chat.messages.map(function(message){if(message._id==data.messages[0]._id){var usertype=chat.currentusertype;"user"==usertype?message.tasker_status=2:"tasker"==usertype&&(message.user_status=2)}return message})}function messagestatus(data){chat.data.task==data.task&&chat.data.tasker._id==data.tasker&&chat.data.user._id==data.user&&(chat.messages=data.messages)}function starttyping(data){chat.data.task==data.chat.task&&chat.data.tasker._id==data.chat.tasker&&chat.data.user._id==data.chat.user&&(chat.typing.status=!0)}function stoptyping(data){chat.data.task==data.chat.task&&chat.data.tasker._id==data.chat.tasker&&chat.data.user._id==data.chat.user&&(chat.typing.status=!1)}var chat=this,user=AuthenticationService.GetCredentials();if(chat.currentusertype=CurrentuserResolve.user_type,chat.taskerDetails=TaskProfileResolve,"user"==chat.currentusertype&&(chat.CurrentType="Tasker Name",TaskServiceResolve.tasker?chat.UserName=TaskServiceResolve.tasker.username:(chat.UserName=chat.taskerDetails.username,chat.currentname=chat.taskerDetails.username),MainService.getCurrentUsers(user.currentUser.user_id).then(function(result){chat.currentUserData=result[0]},function(error){console.log("user.currentUser",user.currentUser),$translate("INIT CURRENT DATA ERROR").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})})),"tasker"==chat.currentusertype&&(chat.CurrentType="User Name",TaskServiceResolve.tasker?chat.UserName=TaskServiceResolve.user.username:(chat.UserName=chat.taskerDetails.username,chat.currentname=chat.taskerDetails.username),MainService.getCurrentTaskers(user.currentUser.user_id).then(function(result){chat.currentUserData=result[0]},function(error){console.log("user.currentUser",user.currentUser),console.log("user.error",error),$translate("INIT CURRENT DATA ERROR").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})})),chat.currentUser=user.currentUser.user_id,chat.data=ChatServiceResolve,chat.data){var data={};data.task=$stateParams.task,data.user=$stateParams.user,data.tasker=$stateParams.tasker,data.type=user.currentUser.user_type,socket.emit("message status",data)}chat.messages=ChatServiceResolve.messages||[],chat.taskinfo=TaskServiceResolve,$rootScope.$emit("notification",{user:$rootScope.userId,type:$rootScope.usertype}),chat.typing={},chat.typing.status=!1,"tasker"==user.currentUser.user_type?chat.typing.message="User is typing. . .":"user"==user.currentUser.user_type&&(chat.typing.message="Tasker is typing. . ."),chat.taskinfo.hourly_rate?chat.taskinfo.amount=parseFloat(chat.taskinfo.hourly_rate).toFixed(2):chat.taskinfo.amount=$filter("filter")(chat.taskerDetails.taskerskills,{childid:chat.taskinfo.category._id})[0].hour_rate,chat.send=function(message){if("tasker"==user.currentUser.user_type)data={user:$stateParams.user,tasker:$stateParams.tasker,message:message,task:$stateParams.task,from:chat.currentUser};else if("user"==user.currentUser.user_type)var data={user:$stateParams.user,tasker:$stateParams.tasker,message:message,task:$stateParams.task,from:chat.currentUser};message&&socket.emit("new message",data),$scope.message=""},chat.ontyping=function(message){var data={};"tasker"==user.currentUser.user_type?(data.from=$stateParams.tasker,data.to=$stateParams.user):"user"==user.currentUser.user_type&&(data.from=$stateParams.user,data.to=$stateParams.tasker),data.task=$stateParams.task,data.user=$stateParams.user,data.tasker=$stateParams.tasker,data.type=user.currentUser.user_type,socket.emit("start typing",data),lastTypingTime=(new Date).getTime(),setTimeout(function(){(new Date).getTime()-lastTypingTime>=400&&socket.emit("stop typing",data)},400)},chat.confirmatask=function(message){swal({title:"Confirm & Book",text:"Are You Sure Want To Confirm This Task.",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, Confirm!"}).then(function(response){if(response){var task={};task.tasker=$stateParams.tasker,task.user=$stateParams.user,task.task=$stateParams.task,TaskService.confirmtask(task).then(function(result){1==result.status?($translate("REQUEST HAS BEEN SENT TO TASKER SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)}),$state.go("landing",{reload:!1})):toastr.error("Unable to book this tasker")},function(error){toastr.error(error)})}}).catch(function(err){})},chat.taskerconfirmtask=function(message){swal({title:"Accept Task",text:"Are You Sure Want To Accept This Task.",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, Accept!"}).then(function(response){if(response){var task={};task.tasker=$stateParams.tasker,task.user=$stateParams.user,task.task=$stateParams.task,TaskService.taskerconfirmtask(task).then(function(result){1==result.status?($translate("TASK ACCEPTED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)}),$state.go("landing",{reload:!1})):toastr.error("Unable to accept this task")},function(error){toastr.error(error)})}}).catch(function(err){})},socket.on("webupdatechat",webupdatechat),socket.on("single message status",singlemessagestatus),socket.on("message status",messagestatus),socket.on("start typing",starttyping),socket.on("stop typing",stoptyping),$scope.$on("$destroy",function(event){socket.removeListener("webupdatechat",webupdatechat),socket.removeListener("single message status",singlemessagestatus),socket.removeListener("message status",messagestatus),socket.removeListener("start typing",starttyping),socket.removeListener("stop typing",stoptyping)})}function socket($rootScope){var socket=io.connect("/chat"),events={},that={},addCallback=function(name,callback){var event=events[name],wrappedCallback=wrapCallback(callback);return event||(event=events[name]=[]),event.push({callback:callback,wrapper:wrappedCallback}),wrappedCallback},wrapCallback=function(callback){var wrappedCallback=angular.noop;return callback&&(wrappedCallback=function(){var args=arguments;$rootScope.$apply(function(){callback.apply(socket,args)})}),wrappedCallback},listener=function(name,callback){return{bindTo:function(scope){null!==scope&&scope.$on("$destroy",function(){that.removeListener(name,callback)})}}};return{on:function(name,callback){return socket.on(name,addCallback(name,callback)),listener(name,callback)},once:function(name,callback){return socket.once(name,addCallback(name,callback)),listener(name,callback)},removeListener:function(name,callback){socket.removeListener(name,function(name,callback){var wrappedCallback,event=events[name];if(event)for(var i=event.length-1;i>=0;i--)if(event[i].callback===callback){wrappedCallback=event[i].wrapper,event.slice(i,1);break}return wrappedCallback}(name,callback))},removeAllListeners:function(name){socket.removeAllListeners(name),function(name){delete events[name]}(name)},emit:function(name,data,callback){callback?socket.emit(name,data,wrapCallback(callback)):socket.emit(name,data)}}}function MessageService($http,$q){return{saveChat:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/chat/save",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getMessage:function(currentuserid,currentusertype,page,itemsPerPage){var deferred=$q.defer(),skip=0;return page>1&&(skip=(parseInt(page)-1)*itemsPerPage),$http({method:"POST",url:"/site/chat/getmessage",data:{userId:currentuserid,currentusertype:currentusertype,skip:skip,limit:itemsPerPage}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},deletemessage:function(categoryinfo){var deferred=$q.defer();return $http({method:"POST",url:"/site/chat/deletemessage",data:categoryinfo}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},chatHistory:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/chat/chathistory",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},deleteConversation:function(chatinfo,usertype){var deferred=$q.defer();return $http({method:"POST",url:"/site/chat/deleteConversation",data:{chatinfo:chatinfo,usertype:usertype}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise}}}function notificationCtrl(NotificationsResolve,NotificationService,toastr,$rootScope,$translate,$scope,accountProfileResolve,$state,$cookieStore){var nc=this;nc.itemsPerPage=3,nc.currentPage=1,nc.totalItems=0,nc.notifications=NotificationsResolve,console.log("nc.notifications",nc.notifications),nc.notifications[0]&&(nc.totalItems=nc.notifications[0].count),$rootScope.$emit("webNotification",{user:$rootScope.userId,type:$rootScope.usertype});var data={};data.user=$rootScope.userId,data.type=$rootScope.usertype,nc.getnotification=function(){nc.notification=[],nc.getnotificationResponse=!1,NotificationService.getMessage(data,nc.currentPage,nc.itemsPerPage).then(function(data){nc.notifications=data},function(error){})};var userId=$rootScope.userId;$rootScope.usertype;console.log("accountProfileResolve",accountProfileResolve),angular.isDefined(accountProfileResolve)&&(nc.user=accountProfileResolve.result[0]),nc.user._id===userId&&"tasker"===nc.user.role&&($scope.notifyAccount=function(status){$cookieStore.put("notification_status",status),$state.go("account.job")}),nc.user._id===userId&&"user"===nc.user.role&&($scope.notifyAccount=function(status){$cookieStore.put("notification_status",status),$state.go("account.tasks")})}function NotificationService($http,$q){return{getMessage:function(data,page,itemsPerPage){if(skip=0,page>1)var skip=(parseInt(page)-1)*itemsPerPage;var deferred=$q.defer();return $http({method:"POST",url:"/site/notifications/list",data:{data:data,skip:skip,itemsCount:itemsPerPage}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise}}}function carddetailCtrl($scope,$rootScope,$window,$stateParams,$state,CarddetailResolve,CarddetailService,MainService,CurrentUserResolve,$translate,$location,$anchorScroll,toastr){var cdc=this;cdc.data=CarddetailResolve.taskdata[0],cdc.currentUser=CurrentUserResolve[0],7==cdc.data.status&&1==cdc.data.invoice.status&&(cdc.paymentStatus="Completed"),CarddetailService.paymentmode().then(function(response){cdc.paymentmode=response}),cdc.balance_amount=cdc.data.invoice.amount.balance_amount,cdc.service_tax=cdc.data.invoice.amount.service_tax,cdc.data.invoice.amount.coupon?(cdc.couponbtn=0,cdc.coupon=cdc.data.invoice.coupon):(console.log("elsees"),cdc.coupon="",cdc.couponbtn=1),cdc.couponVisible=!1,cdc.applyCoupon=function(coupon){if(void 0==coupon)$translate("ENTER VALID COUPON CODE").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)});else{var data={};data.coupon=coupon,data.task=CarddetailResolve.taskdata[0]._id,data.user=CurrentUserResolve[0]._id,CarddetailService.applyCoupon(data).then(function(response){response.length>0?7==response[0].status?($state.go("account.profile"),$translate("PAYMENT_COMPLETED").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)})):(cdc.couponVisible=!0,cdc.couponAmount=response[0].invoice.amount.coupon,cdc.couponbtn=0,cdc.data.invoice=response[0].invoice,cdc.grandtotal=response[0].invoice.amount.grand_total,0!=response[0].invoice.amount.coupon&&(cdc.grandtotal=response[0].invoice.amount.grand_total-response[0].invoice.amount.coupon),cdc.balance_amount=response[0].invoice.amount.balance_amount,cdc.service_tax=response[0].invoice.amount.service_tax,$translate("SAVED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)})):$translate(response.message).then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})},function(err){$scope.addAlert("danger",err.message)})}},cdc.removeCoupon=function(coupon){if(void 0==coupon)$translate("ENTER VALID COUPON CODE").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)});else{var data={};data.coupon=coupon,data.task=CarddetailResolve.taskdata[0]._id,data.user=CurrentUserResolve[0]._id,CarddetailService.removeCoupon(data).then(function(response){cdc.couponVisible=!1,cdc.couponbtn=1,cdc.grandtotal=response[0].invoice.amount.grand_total,cdc.balance_amount=response[0].invoice.amount.balance_amount,cdc.coupon="",cdc.data=CarddetailResolve.taskdata[0],cdc.data.invoice.amount.grand_total=response[0].invoice.amount.grand_total,cdc.data.invoice.amount.balance_amount=response[0].invoice.amount.balance_amount,cdc.data.invoice.amount.coupon=0,$translate("SAVED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)})},function(err){$scope.addAlert("danger",err.message)})}},cdc.walletpayment=function(data,coupon){var walletdata={};data.invoice.amount.total&&(data.invoice.amount.extra_amount>0&&!data.invoice.amount.discount?walletdata.amount=data.invoice.amount.total+data.invoice.amount.service_tax+data.invoice.amount.extra_amount:data.invoice.amount.discount>0&&!data.invoice.amount.extra_amount?walletdata.amount=data.invoice.amount.total+data.invoice.amount.service_tax-data.invoice.amount.discount:data.invoice.amount.extra_amount>0&&data.invoice.amount.discount>0?walletdata.amount=data.invoice.amount.total+data.invoice.amount.service_tax+data.invoice.amount.extra_amount-data.invoice.amount.discount:walletdata.amount=data.invoice.amount.total+data.invoice.amount.service_tax),walletdata.taskid=data._id,walletdata.taskerid=data.tasker._id,walletdata.userid=data.user._id,walletdata.createdat=data.createdAt,CarddetailService.walletpayment(walletdata).then(function(response){cdc.data=response,"wallet-other"==cdc.data.payment_type&&7!=cdc.data.status?(cdc.couponbtn=1,cdc.paymentStatus="Wallet money over",cdc.balance_amount=cdc.data.invoice.amount.balance_amount):0==cdc.data.status?($translate("Recharge Your Wallet").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)}),cdc.data=CarddetailResolve.taskdata[0]):(cdc.paymentStatus="completed",$state.go("account.profile"),$translate("PAYMENT_COMPLETED").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)}),CarddetailResolve.taskdata[0]._id)},function(err){err.message?$scope.addAlert("danger",err.message):$translate("Recharge Your Wallet").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})})},cdc.creditscroll=function(){$location.hash("dopaymentcredit"),$anchorScroll(),$location.url($location.path())},cdc.payment=function(isValid){isValid?(cdc.formdata=cdc.taskPayment,cdc.formdata.taskid=CarddetailResolve.taskdata[0]._id,CarddetailService.confirmtask(cdc.formdata).then(function(response){1==response.status&&($state.go("account.profile"),$translate("PAYMENT_COMPLETED").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)}),cdc.paymentStatus="completed")},function(err){err.data.message?toastr.error(err.data.message):$translate("UNABLE PROCESS YOUR PAYMENT").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})})):$translate("PLEASE ENTER THE VALID DATA").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})},cdc.couponCompltePayment=function(data){var couponCompletedata={};couponCompletedata.amount=data.invoice.amount.balance_amount,couponCompletedata.taskid=data._id,couponCompletedata.taskerid=data.tasker._id,couponCompletedata.userid=data.user._id,couponCompletedata.createdat=data.createdAt,CarddetailService.couponCompletePayment(couponCompletedata).then(function(response){response&&(cdc.data=response),cdc.paymentStatus="completed",$state.go("account.profile"),$translate("PAYMENT_COMPLETED").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)}),CarddetailResolve.taskdata[0]._id},function(err){err.message?$scope.addAlert("danger",err.message):$translate("UNABLE PROCESS YOUR PAYMENT").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})})},cdc.paypalPayment=function(data){var paymentdetails={};paymentdetails.task=data._id,paymentdetails.user=data.user._id,CarddetailService.paypalPayment(paymentdetails).then(function(response){1==response.status&&"paypal"==response.payment_mode?$window.location.href=response.redirectUrl:$translate("UNABLE PROCESS YOUR PAYMENT").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})},function(err){err.message?$scope.addAlert("danger",err.message):$translate("UNABLE PROCESS YOUR PAYMENT").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})})},cdc.payemntvalue=function(payemnt){cdc.type=payemnt}}function paypalfaileddetailCtrl($scope,$rootScope,$window,$stateParams,$state,paypaltaskid){this.taskid=paypaltaskid.task}function CarddetailService($http,$q){return{gettaskbyid:function(taskid){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/gettaskbyid",data:{task:taskid}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},confirmtask:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/confirmtask",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},walletpayment:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/paybywallet",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},applyCoupon:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/apply-coupon",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},removeCoupon:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/remove-coupon",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},paypalPayment:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/paypalPayment",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},paymentmode:function(){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/paymentmode"}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},couponCompletePayment:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/account/couponCompletePayment",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise}}}function pagesCtrl($scope,$rootScope,$location,$stateParams,PagesserviceResolve,PageService,$state,$sce,$translate,ngMeta,$cookies){var pac=this;PagesserviceResolve[0].seo&&(ngMeta.setTitle(PagesserviceResolve[0].seo.title),ngMeta.setTag("description",PagesserviceResolve[0].seo.description),ngMeta.setTag("keyword",PagesserviceResolve[0].seo.keyword)),PagesserviceResolve[0].parent?$rootScope.pageId=PagesserviceResolve[0].parent:$rootScope.pageId=PagesserviceResolve[0]._id,PagesserviceResolve[0]?(pac.data=PagesserviceResolve[0],$scope.html=pac.data.description,$rootScope.trustedHtml=$sce.trustAsHtml($scope.html),pac.getSubcategoryResponse=!0,pac.getSubcategory=function(){pac.subcategory=[],angular.isDefined(pac.categoryDatails._id)&&(pac.getSubcategoryResponse=!1,PageService.getcategory(pac.categoryDatails.slug,pac.currentPage,pac.itemsPerPage).then(function(data){data.response.ActiveCategory.subcategory.length>0&&(pac.subcategory=data.response.ActiveCategory.subcategory,pac.totalItems=data.response.ActiveCategory.totalsubcategory)},function(error){}))}):$state.go("404")}function PageService($http,$q){return{getpage:function(slug,language){var deferred=$q.defer(),data={};return data.slug=slug.slug,data.language=language,$http({method:"POST",url:"/site/pages/getpage",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise}}}function faqCtrl($scope,$rootScope,$location,$stateParams,FaqserviceResolve,FaqService,$state,$sce,$translate){this.data=FaqserviceResolve,$scope.oneAtATime=!0}function emergencyCtrl($scope,toastr,ForgotpasswordService,$stateParams,$translate,$state){var userid=$stateParams.userid;this.verifyemergencycontact=function(isValid,formData){isValid?ForgotpasswordService.verifyemergencycontact({formData:formData,userid:userid}).then(function(response){$translate("MOBILE NO VERIFIED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)}),$state.go("landing")},function(err){$translate("ERROR IN MOBILE VERIFICATION").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})}):$translate("ERROR IN MOBILE VERIFICATION").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})},ForgotpasswordService.mailverification({userid:userid}).then(function(response){$translate("MAIL VERIFIED  SUCCESSFULLY!").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)})},function(err){$translate("ERROR IN MAIL VERIFICATION").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})})}function FaqService($http,$q){return{getfaq:function(){var deferred=$q.defer();return $http({method:"GET",url:"/site/faq/getfaq"}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise}}}function pwdloginCtrl($scope,ForgotpasswordService,toastr,$translate,$stateParams){this.type=$stateParams.type,this.forgotpass=function(isValid,formData){if(isValid){var data={};data.email=formData,data.type=$stateParams.type,ForgotpasswordService.saveUserInfo(data).then(function(response){$translate("PASSWORD RESET MAIL HAS BEEN SENT TO YOUR EMAIL ID").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)})},function(err){$translate("INVALID EMAIL ID").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})})}else $translate("EMAIL IS REQUIRED").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})}}function pwdmailCtrl($scope,toastr,ForgotpasswordService,$state,$stateParams,$translate){this.forgotpassmailuser=function(isValid,formData){if(isValid){var data={};data.user=$stateParams.userid,data.reset=$stateParams.resetid,data.password=formData,data.type=$stateParams.type,ForgotpasswordService.saveUsermailpwd(data).then(function(response){$translate("PASSWORD HAS BEEN CHANGED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)}),$state.go("login",{type:"user"})},function(err){$translate("ERROR IN CHANGING PASSWORD").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})})}else $translate("ERROR IN CHANGING PASSWORD").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})}}function ForgotpasswordService($http,$q){return{saveUserInfo:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/saveforgotpasswordinfo",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},mailverification:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/mobile/mailverification",data:{data:data}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},saveUsermailpwd:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/forgotpwdmailuser",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise}}}function ForgotpwduserService($http,$q){return{otpsave:function(data){console.log("ddaattaa",data);var deferred=$q.defer();return $http({method:"POST",url:"/site/otpsave",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},resendotp:function(data){var deferred=$q.defer();return $http({method:"POST",url:"/site/resendotp",data:{data:data}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},getuserdata:function(data){console.log(data);var deferred=$q.defer();return $http({method:"POST",url:"/site/getuserdata",data:{data:data}}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise},activateUserAccount:function(data){console.log(data);var deferred=$q.defer();return $http({method:"POST",url:"/site/activateUserAccount",data:data}).then(function(data){deferred.resolve(data.data)},function(err){deferred.reject(err)}),deferred.promise}}}function otploginCtrl($scope,$state,ForgotpwduserService,toastr,$translate,$stateParams,AuthenticationService,$cookieStore,$location){var otpc=this;otpc.newstatus=!1,ForgotpwduserService.getuserdata($stateParams.id).then(function(response){otpc.user=response}),otpc.activate=function(isValid,formData){if(formData!=otpc.user.phone.number)$translate("MOBILE NUMBER IS NOT MATCH").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)});else if(formData){var data={};data.mobile=formData,data.userid=$stateParams.id,ForgotpwduserService.activateUserAccount(data).then(function(response){response.otpkey&&(otpc.newstatus=!0,"development"==response.sms&&(otpc.otp=response.otpkey))},function(err){otpc.newstatus=!0,$translate(err.message).then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})})}},otpc.otpsignup=function(isValid,otpvalue){if(otpvalue){var data={};data.otpKey=otpvalue,data.userid=$stateParams.id,ForgotpwduserService.otpsave(data).then(function(response){response?($translate("ACCOUNT VERIFIED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)}),$state.go("login",{type:"user"})):$translate("INVALID OTP").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})},function(err){$translate("INVALID EMAIL ID").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})})}else $translate("Enter OTP").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})},otpc.resendotp=function(isValid,formData){$stateParams.id?ForgotpwduserService.resendotp($stateParams.id).then(function(response){$translate("OTP RESEND SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)})},function(err){$translate("INVALID DATA").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})}):$translate("OTP IS REQUIRED").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})}}!function(){var myApplication=angular.module("handyforall.config",[]);(function(){var initInjector=angular.injector(["ng","ngCookies"]),$http=initInjector.get("$http"),$q=initInjector.get("$q"),user=initInjector.get("$cookieStore").get("siteglobals"),data={};user&&(data.user=user.currentUser.user_id,data.type=user.currentUser.user_type);var settings=$q.defer();$http({method:"POST",url:"/site/main",data:data}).then(function(data){settings.resolve(data.data)},function(err){settings.reject(err)});var settingsData=settings.promise,ipinfo=$q.defer();$http({method:"GET",url:"//ipinfo.io?token=1cc3b275647ba5"}).then(function(data){ipinfo.resolve(data.data)},function(err){ipinfo.reject(err)});var ipinfoData=ipinfo.promise;return $q.all([settingsData,ipinfoData])})().then(function(data){myApplication.constant("config",data[0]),myApplication.constant("ipinfo",data[1]),angular.element(document).ready(function(){angular.bootstrap(document,["handyforall.site"])})})}(),angular.module("handyforall.authentication",[]),angular.module("handyforall.contactus",[]),angular.module("handyforall.page",[]),angular.module("handyforall.faq",[]),angular.module("handyforall.becometasker",[]),angular.module("handyforall.category",[]),angular.module("handyforall.task",[]),angular.module("handyforall.accounts",[]),angular.module("handyforall.messages",[]),angular.module("handyforall.carddeatil",[]),angular.module("handyforall.forgotpassword",[]),angular.module("handyforall.notifications",[]),angular.module("handyforall.site",["ngAnimate","ngSanitize","ngCookies","ui.calendar","ui.validate","ui.bootstrap","ui.router","toastr","pascalprecht.translate","ngFileUpload","ngMap","ngImgCrop","slugifier","checklist-model","ngIntlTelInput","angular-sweetalert","ui.select","ngMeta","ui.slider","ngMaterial","ngMessages","afkl.lazyImage","handyforall.config","handyforall.authentication","handyforall.contactus","handyforall.faq","handyforall.becometasker","handyforall.category","handyforall.task","handyforall.page","handyforall.accounts","handyforall.messages","handyforall.carddeatil","handyforall.notifications","handyforall.forgotpassword","slickCarousel","rzModule","multipleDatePicker"]).run(["$rootScope","$state","$location","$cookieStore","$http","$stateParams","AuthenticationService","toastr","MainService","$window","socket","ngMeta","$cookieStore","$transitions",function($rootScope,$state,$location,$cookieStore,$http,$stateParams,AuthenticationService,toastr,MainService,$window,socket,ngMeta,$cookieStore,$transitions){ngMeta.init(),$rootScope.$state=$state,$rootScope.siteglobals=$cookieStore.get("siteglobals")||{},$rootScope.opensidenav=function(){$(".sidenav-wrap").css("left","0"),$("body").addClass("sidenavoverlay"),$(".sidenav-wrap").addClass("active"),$(".navbar-toggle").addClass("collapsed")},$rootScope.closesidenav=function(){$(".sidenav-wrap").css("left","-150%"),$("body").removeClass("sidenavoverlay"),$(".sidenav-wrap").removeClass("active"),$(".navbar-toggle").removeClass("collapsed")},$(document).on("click",function(e){$(".navbar-toggle:not(.collapsed)").is(e.target)||0!=$(".navbar-toggle:not(.collapsed)").has(e.target).length?$rootScope.opensidenav():$(".sidenav-wrap").is(e.target)&&$(".sidenav-wrap").has(e.target)||$rootScope.closesidenav()}),$rootScope.siteglobals.currentUser&&(console.log("$rootScope.siteglobals.currentUser",$rootScope.siteglobals.currentUser),$http.defaults.headers.common.Authorization=$rootScope.siteglobals.currentUser.authdata),$transitions.onStart({},function(trans){var toState=trans.to(),toParams=trans.params("to"),fromState=trans.from(),fromParams=trans.params("from"),userdata=AuthenticationService.GetCredentials();userdata.currentUser&&"hirestep1"==toState.name&&"tasker"==userdata.currentUser.user_type&&($state.go("login",{type:"user"}),toastr.error("Tasker Cannot  access")),"chat"==toState.name&&($rootScope.siteglobals.currentUser||$state.go("login",{type:"user"})),toState.authenticate&&!AuthenticationService.isAuthenticated()&&$state.go("login",{type:"user"}),toState.registerauthenticate&&("user"!=toParams.type&&"tasker"!=toParams.type||AuthenticationService.isAuthenticated())&&(AuthenticationService.isAuthenticated()?$state.transitionTo("landing"):$state.go("register",{type:"user"})),toState.taskerauthenticate&&AuthenticationService.isTaskerAuthenticated()&&$state.transitionTo("landing"),toState.loginauthenticate&&AuthenticationService.isAuthenticated()&&$state.transitionTo("landing"),$rootScope.currentStateHTML=toState,"login"!=toState.name&&"signupotp"!=toState.name&&"social"!=toState.name&&"register"!=toState.name&&"hirestep1"!=toState.name&&"signup"!=toState.name&&($rootScope.PreviousState=fromState,$rootScope.Previousparams=fromParams,$rootScope.currentState=toState,$rootScope.currentparams=toParams,"login"!=$rootScope.PreviousState.name&&"landing"==$rootScope.currentState.name&&($rootScope.selectedCategory={}))})}]).factory("myHttpInterceptor",function($q,$location,$rootScope,$cookieStore){return{response:function(response){return $rootScope.imgSrc=!1,404==response.status&&$location.path("/404"),response},responseError:function(rejection){return 401==rejection.status&&($cookieStore.remove("siteglobals"),$location.path("/login/user")),$q.reject(rejection)},request:function(config){return $rootScope.imgSrc="/app/site/public/images/loader.gif",config||$q.when(config)}}}).provider("routes",function(){return{$get:function(){return{landingPage:{url:"/site/landing/landingdata",method:"POST"},userRegister:{url:"/siteregister",method:"POST"},userLogin:{url:"/site",method:"POST"},userSaveaccount:{url:"/site/account/settings/save",method:"POST"},settingUrl:{method:"POST",url:"/site/account/getsettings"},seoUrl:{method:"GET",url:"/site/landing/getseosetting"},defaultCurrency:{method:"GET",url:"/site/landing/getDefaultCurrency?name="},getmaincat:{method:"POST",url:"/site/account/getmaincatname"},pdf:{method:"GET",url:"/site/account/downloadPdf"},userProfile:{method:"POST",url:"/site/account/profile"},userPassword:{method:"POST",url:"/site/account/password-change"},walletRechargeStripe:{method:"POST",url:"/site/account/updatewalletdata"},walletDetails:{method:"POST",url:"/site/account/getwalletdetails"},walletRechargePaypal:{method:"POST",url:"/site/account/updatewalletdatapaypal"},walletTransaction:{method:"POST",url:"/site/account/getuserwallettransaction"},userUpdateAcc:{method:"POST",url:"/site/account/settings/save"},userDeactiveAcc:{method:"POST",url:"/site/account/deactivateAccount"},taskList:{method:"POST",url:"/site/account/getTaskList"},taskSearchList:{method:"POST",url:"/site/account/getSearchTaskList"},userTaskDetails:{method:"POST",url:"/site/account/getTaskDetails"},userTransactions:{method:"POST",url:"/site/account/usertranscation"},userReview:{method:"POST",url:"/site/account/getuserReview"},taskCancelReason:{method:"POST",url:"/site/account/getcancelreason"},taskCancel:{method:"POST",url:"/site/account/usercanceltask"},taskReview:{method:"POST",url:"/site/account/gettaskreview"},addUserReview:{method:"POST",url:"/site/account/addReview"},taskerProfile:{method:"POST",url:"/site/account/tasker/profile"},taskerUpdateAcc:{method:"POST",url:"/site/account/tasker/settings/save"},taskerPassword:{method:"POST",url:"/site/account/tasker/password/save"},taskerDeactiveAcc:{method:"POST",url:"/site/account/deactivateTaskertAccount"},taskerReview:{method:"POST",url:"/site/account/getreview"},taskerTransactions:{method:"POST",url:"/site/account/transcationhis"},bank:{method:"POST",url:"/site/account/saveaccountinfo"},category:{method:"POST",url:"/site/account/categories/get"},usercat:{method:"POST",url:"/site/account/getcategoriesofuser"},catexp:{method:"POST",url:"/site/account/categories/get-experience"},accEdit:{method:"POST",url:"/site/account/edit"},catChild:{method:"POST",url:"/site/account/categories/getchild"},addUpdateCat:{method:"POST",url:"/site/account/updatecategoryinfo"},delCat:{method:"POST",url:"/site/account/deleteCategory"},availabity:{method:"POST",url:"/site/account/availability/save"},unavailability:{method:"POST",url:"/site/account/unavailability/save"},taskerTaskDetails:{method:"POST",url:"/site/account/getTaskDetailsByStaus"},searchTaskerTaskDetails:{method:"POST",url:"/site/account/getSearchTaskDetailsByStaus"},UpdateTaskStatus:{method:"POST",url:"/site/account/updatetaskstatus"},confirmTask:{method:"POST",url:"/site/account/taskerconfirmtask"},insertReview:{method:"POST",url:"/site/account/insertaskerReview"},taskComplete:{method:"POST",url:"/site/account/updateTaskcompletion"},getQuestion:{method:"GET",url:"/site/account/question/getQuestion"},updateAbout:{method:"POST",url:"/site/account/updateprofiledetails"},ignoreTask:{method:"POST",url:"/site/account/ignoreTask"}}}}}).config(function(ngMetaProvider,ngIntlTelInputProvider,toastrConfig){ngMetaProvider.useTitleSuffix(!0),ngIntlTelInputProvider.set({defaultCountry:""}),angular.extend(toastrConfig,{autoDismiss:!0,maxOpened:1,tapToDismiss:!0,closeButton:!0,closeHtml:'<i class="fa fa-times"></i>'})}).config(["slickCarouselConfig",function(slickCarouselConfig){slickCarouselConfig.dots=!0,slickCarouselConfig.autoplay=!1}]).config(["$translateProvider","$urlMatcherFactoryProvider",function($translateProvider,$urlMatcherFactoryProvider){$translateProvider.useStaticFilesLoader({prefix:"/uploads/languages/",suffix:".json"}),$translateProvider.useLocalStorage(),$translateProvider.preferredLanguage("en"),$translateProvider.useSanitizeValueStrategy(null),$translateProvider.fallbackLanguage("en"),$urlMatcherFactoryProvider.caseInsensitive(!1),$urlMatcherFactoryProvider.strictMode(!0)}]).factory("PreviousState",["$rootScope","$state",function($rootScope,$state){var lastHref="/",lastStateName="landing",lastParams={},event="";return $rootScope.$on("$stateChangeSuccess",function(events,toState,toParams,fromState,fromParams){event=events,lastStateName=fromState.name,lastParams=fromParams,lastHref=$state.href(lastStateName,lastParams)}),{getLastHref:function(){return lastHref},goToLastState:function(){return $state.go(lastStateName,lastParams)}}}]).config(["$stateProvider","$urlRouterProvider","$locationProvider","$httpProvider",function($stateProvider,$urlRouterProvider,$locationProvider,$httpProvider){$locationProvider.html5Mode(!0),$urlRouterProvider.when("/account",["$state",function($state,myService){$state.go("account.profile")}]).otherwise("/404"),$httpProvider.interceptors.push("myHttpInterceptor"),$stateProvider.state("landing",{url:"/",views:{content:{templateUrl:"app/site/modules/common/views/landing.html",controller:"MainCtrl",controllerAs:"MAC"}},data:{meta:{title:"Home"}},resolve:{MainserviceResolve:function(MainService,routes){return MainService.getData(routes.landingPage,{})}}}).state("morecategories",{url:"/morecategories",views:{content:{templateUrl:"app/site/modules/common/views/morecategories.html",controller:"MorecategoryCtrl",controllerAs:"MOC"}},resolve:{MorecategoryserviceResolve:function(MainService,$stateParams){return MainService.getmorecategory(0)}}}).state("category",{url:"/category/:slug",views:{content:{templateUrl:"/app/site/modules/category/views/category.html",controller:"categoryCtrl",controllerAs:"CAC"}},data:{meta:{title:"Category"}},resolve:{CategoryserviceResolve:function(CategoryService,$stateParams){return CategoryService.getcategory($stateParams.slug,0,6)}}}).state("forgotpwd",{url:"/forgot-password/:type",loginauthenticate:!0,views:{specialview:{templateUrl:"app/site/modules/common/views/forgot-password.html",controller:"pwdloginCtrl",controllerAs:"PWC"},commonview:{template:"<div></div>"}},data:{meta:{title:"Forgot Your Password"}}}).state("signupotp",{url:"/userverfication/:id",views:{commonview:{templateUrl:"app/site/modules/common/views/OTPSignup_model.html",controller:"otploginCtrl",controllerAs:"OTPC"}}}).state("forgotpwdusermail",{url:"/reset-password/:type/:userid/:resetid",loginauthenticate:!0,views:{specialview:{templateUrl:"app/site/modules/common/views/reset-password.html",controller:"pwdmailCtrl",controllerAs:"PWMC"},commonview:{template:"<div></div>"}},data:{meta:{title:"Forgot Your Password"}}}).state("page",{url:"/page/:slug",views:{content:{templateUrl:"/app/site/modules/pages/views/pages.html",controller:"pagesCtrl",controllerAs:"PAC"}},data:{meta:{title:"Page"}},resolve:{PagesserviceResolve:function(PageService,$stateParams,$rootScope,$cookieStore,MainService){var languageUpdateValue=$cookieStore.get("language");return void 0==$rootScope.language&&($rootScope.language=languageUpdateValue),PageService.getpage($stateParams,$rootScope.language)}}}).state("login",{url:"/login",loginauthenticate:!0,views:{specialview:{templateUrl:"app/site/modules/common/views/login.html",controller:"userloginCtrl",controllerAs:"ULGC"},commonview:{template:"<div></div>"}},data:{meta:{title:"User Login"}}}).state("contact-us",{url:"/contact-us",views:{content:{templateUrl:"app/site/modules/common/views/contactus.html",controller:"contactCtrl",controllerAs:"CTTC"}},data:{meta:{title:"Contact Us"}}}).state("faq",{url:"/faq",views:{content:{templateUrl:"/app/site/modules/common/views/faq.html",controller:"faqCtrl",controllerAs:"FAC"}},data:{meta:{title:"FAQ"}},resolve:{FaqserviceResolve:function(FaqService){return FaqService.getfaq()}}}).state("messages",{url:"/messages",authenticate:!0,views:{content:{templateUrl:"app/site/modules/messages/views/messages.html",controller:"messagesCtrl",controllerAs:"MSG"}},data:{meta:{title:"Messages"}},resolve:{MessageserviceResolve:function(AuthenticationService,MessageService){var user=AuthenticationService.GetCredentials();return MessageService.getMessage(user.currentUser.user_id,user.currentUser.user_type,0,3)},CurrentuserResolve:function(AuthenticationService){return AuthenticationService.GetCredentials().currentUser}}}).state("notifications",{url:"/notifications",authenticate:!0,views:{content:{templateUrl:"app/site/modules/notifications/views/notifications.html",controller:"notificationCtrl",controllerAs:"NC"}},data:{meta:{title:"Notifications"}},resolve:{NotificationsResolve:function(AuthenticationService,NotificationService){var user=AuthenticationService.GetCredentials(),data={};return data.user=user.currentUser.user_id,data.type=user.currentUser.user_type,NotificationService.getMessage(data,0,3)},accountProfileResolve:function(AuthenticationService,$rootScope,MainService,routes){var user=AuthenticationService.GetCredentials();if(user.currentUser.user_id){var userId=$rootScope.userId;if("user"==user.currentUser.user_type)return MainService.getData(routes.userProfile,{userId:userId});if("tasker"==user.currentUser.user_type)return MainService.getData(routes.taskerProfile,{userId:userId})}}}}).state("404",{url:"/404",views:{specialview:{templateUrl:"app/site/modules/common/views/404.html"},commonview:{template:"<div></div>"}},data:{meta:{title:"PageNotFound"}}}).state("chat",{url:"/chat/:task/:user/:tasker",views:{content:{templateUrl:"app/site/modules/messages/views/chat.html",controller:"chatCtrl",controllerAs:"CHAT"}},data:{meta:{title:"Messenger"}},resolve:{ChatServiceResolve:function(AuthenticationService,MessageService,$stateParams,socket){var user=AuthenticationService.GetCredentials(),data={};return data.task=$stateParams.task,data.user=$stateParams.user,data.tasker=$stateParams.tasker,data.type=user.currentUser.user_type,MessageService.chatHistory(data)},TaskServiceResolve:function(TaskService,$stateParams){return TaskService.getTaskDetailsbyid($stateParams.task)},TaskProfileResolve:function(TaskService,$stateParams){return TaskService.taskprofileinfo($stateParams.tasker)},CurrentuserResolve:function(AuthenticationService){return AuthenticationService.GetCredentials().currentUser}}}).state("register",{url:"/register",loginauthenticate:!0,views:{specialview:{templateUrl:"app/site/modules/common/views/register.html",controller:"registerCtrl",controllerAs:"RGC"},commonview:{template:"<div></div>"}},data:{meta:{title:"User SignUp"}},resolve:{CategoryserviceResolve:function(CategoryService){return CategoryService.getcategoryList()},settingsResolve:function(MainService,routes){return MainService.getData(routes.settingUrl,{})}}}).state("becometasker",{url:"/become-tasker",views:{content:{template:'<div ui-view="becometasker"></div>',controller:"registerCtrl",controllerAs:"RGC"}},data:{meta:{title:"Tasker SignUp"}},resolve:{CategoryserviceResolve:function(CategoryService){return CategoryService.getcategoryList()},settingsResolve:function(MainService,routes){return MainService.getData(routes.settingUrl,{})}}}).state("becometasker.step1",{url:"/basicinfo",taskerauthenticate:!0,views:{becometasker:{templateUrl:"app/site/modules/tasker/views/taskerinfo.html",controller:"registerCtrl",controllerAs:"RGC"}},data:{meta:{title:"Tasker SignUp"}},resolve:{CategoryserviceResolve:function(CategoryService){return CategoryService.getcategoryList()},settingsResolve:function(MainService,routes){return MainService.getData(routes.settingUrl,{})}}}).state("becometasker.step3",{url:"/basicinfo",taskerauthenticate:!0,views:{becometasker:{templateUrl:"app/site/modules/tasker/views/availabiltyInfo-step3.html"}},data:{meta:{title:"Tasker SignUp"}}}).state("becometasker.step7",{url:"/basicinfo",taskerauthenticate:!0,views:{becometasker:{templateUrl:"app/site/modules/tasker/views/imageInfo-step7.html"}},data:{meta:{title:"Tasker SignUp"}}}).state("becometasker.step8",{url:"/basicinfo",taskerauthenticate:!0,views:{becometasker:{templateUrl:"app/site/modules/tasker/views/hoursInfo-step8.html"}},data:{meta:{title:"Tasker SignUp"}}}).state("becometasker.success",{url:"/basicinfo",views:{becometasker:{templateUrl:"app/site/modules/tasker/views/thankpop.html"}},data:{meta:{title:"Tasker SignUp"}}}).state("taskerinfo",{url:"/taskerinfo",views:{content:{controller:"taskinfoCtrl",controllerAs:"TIC"}},data:{meta:{title:"Tasker SignUp"}}}).state("hirestep1",{url:"/hirestep1/:slug",views:{content:{templateUrl:"app/site/modules/task-step/views/hire-step1.html",controller:"taskCtrl",controllerAs:"TAC"}},data:{meta:{title:"Task"}},resolve:{TaskserviceResolve:function(TaskService,$stateParams,AuthenticationService){return TaskService.taskbaseinfo($stateParams.slug)},CurrentUserTaskserviceResolve:function(MainService,AuthenticationService){var user=AuthenticationService.GetCredentials();if(user.currentUser)return MainService.getCurrentUsers(user.currentUser.user_id);var data=[],datas={};return datas.addressList=[],data.push(datas),data}}}).state("search",{url:"/search/:task?&query",views:{content:{templateUrl:"app/site/modules/task-step/views/search-results.html",controller:"taskFilterCtrl",controllerAs:"TFC"}},data:{meta:{title:"Pick A Tasker"}},resolve:{SearchResolve:function(TaskService,$stateParams){return TaskService.searchTasker($stateParams.task)}}}).state("account",{url:"/account",authenticate:!0,abstract:!0,views:{content:{templateUrl:"app/site/modules/accounts/views/new-account/header.html",controller:"AccountHeaderCtrl",controllerAs:"AHC"}},data:{meta:{title:"My Account"}},resolve:{accountProfileResolve:function(AuthenticationService,$rootScope,MainService,routes){var user=AuthenticationService.GetCredentials();if(user.currentUser.user_id){var userId=$rootScope.userId;if("user"==user.currentUser.user_type)return MainService.getData(routes.userProfile,{userId:userId});if("tasker"==user.currentUser.user_type)return MainService.getData(routes.taskerProfile,{userId:userId})}},seoSettingsResolve:function(MainService,routes){return MainService.getData(routes.seoUrl,{})},settingsResolve:function(MainService,routes){return MainService.getData(routes.settingUrl,{})},defaultCurrency:function(MainService,routes){return MainService.getDefaultCurrency(void 0)}}}).state("account.profile",{url:"/profile",action:"add",controller:"AccountProfileCtrl",controllerAs:"ACC",templateUrl:"app/site/modules/accounts/views/new-account/profile.html"}).state("account.password",{url:"/password",action:"add",controller:"AccountPasswordCtrl",controllerAs:"APC",templateUrl:"app/site/modules/accounts/views/new-account/password.html"}).state("account.tasks",{url:"/tasks",action:"all",controller:"AccountTasksCtrl",controllerAs:"ATC",templateUrl:"app/site/modules/accounts/views/new-account/tasks.html"}).state("account.invites",{url:"/invites",action:"add",controller:"AccountInviteFriends",controllerAs:"AIF",templateUrl:"app/site/modules/accounts/views/new-account/invites.html"}).state("account.wallet",{url:"/wallet",action:"add",controller:"accountWalletCtrl",controllerAs:"AWC",templateUrl:"app/site/modules/accounts/views/new-account/wallet.html"}).state("account.transactions",{url:"/transactions",action:"add",controller:"AccountTransactionCtrl",controllerAs:"ATC",templateUrl:"app/site/modules/accounts/views/new-account/transation-profile.html"}).state("account.reviews",{url:"/reviews",action:"add",controller:"AccountReviewCtrl",controllerAs:"ARC",templateUrl:"app/site/modules/accounts/views/new-account/reviews.html"}).state("account.deactivate",{url:"/deactivate",action:"add",controller:"AccountDeactivateCtrl",controllerAs:"ADC",templateUrl:"app/site/modules/accounts/views/new-account/deactive.html"}).state("account.information",{url:"/information",action:"add",controller:"AccountInformationCtrl",controllerAs:"AIC",templateUrl:"app/site/modules/accounts/views/new-account/information.html"}).state("account.category",{url:"/category",action:"add",controller:"AccountCategoryCtrl",controllerAs:"ACC",templateUrl:"app/site/modules/accounts/views/new-account/category.html"}).state("account.availabity",{url:"/availabity",action:"add",controller:"AccountAvailabityCtrl",controllerAs:"AAC",templateUrl:"app/site/modules/accounts/views/new-account/availabity.html"}).state("account.unavailability",{url:"/unavailability",action:"add",controller:"AccountUnavailabilityCtrl",controllerAs:"AUC",templateUrl:"app/site/modules/accounts/views/new-account/unavailability.html"}).state("account.job",{url:"/job",action:"add",controller:"AccountTaskerJobCtrl",controllerAs:"AJC",templateUrl:"app/site/modules/accounts/views/new-account/job.html"}).state("account.about",{url:"/about",action:"add",controller:"AccountProfileCtrl",controllerAs:"ACC",templateUrl:"app/site/modules/accounts/views/new-account/about.html"}).state("carddeatil",{url:"/carddeatil/:slug",authenticate:!0,views:{content:{templateUrl:"app/site/modules/carddetail/views/carddetail.html",controller:"carddetailCtrl",controllerAs:"CDC"}},data:{meta:{title:"Payment"}},resolve:{CarddetailResolve:function(CarddetailService,$stateParams){return CarddetailService.gettaskbyid($stateParams.slug)},CurrentUserResolve:function(MainService,AuthenticationService){var user=AuthenticationService.GetCredentials();if(user.currentUser.user_id)return MainService.getCurrentUsers(user.currentUser.user_id)}}}).state("paymentsuccess",{url:"/payment-success",authenticate:!0,views:{content:{templateUrl:"app/site/modules/carddetail/views/carddetailsuccess.html"}},data:{meta:{title:"Payment"}}}).state("walletsuccess",{url:"/wallet-success",authenticate:!0,views:{content:{templateUrl:"app/site/modules/carddetail/views/walletsuccess.html"}},data:{meta:{title:"Payment"}}}).state("paymentfailed",{url:"/payment-failed/:task",authenticate:!0,views:{content:{templateUrl:"app/site/modules/carddetail/views/carddetailfailed.html",controller:"paypalfaileddetailCtrl",controllerAs:"PPDC"}},data:{meta:{title:"Payment"}},resolve:{paypaltaskid:function($stateParams){return $stateParams}}}).state("paymentfaileduser",{url:"/walletpayment-failed",authenticate:!0,views:{content:{templateUrl:"app/site/modules/carddetail/views/carddetailfaileduser.html",controller:"paypalfaileddetailCtrl",controllerAs:"PPDC"}},data:{meta:{title:"Payment"}},resolve:{paypaltaskid:function($stateParams){return $stateParams}}}).state("Deactivate",{views:{content:{controller:"DeactivateController",controllerAs:"DBC"}},data:{meta:{title:"Logout"}}}).state("taskerProfile",{url:"/tasker/:taskerId?&user/slug/task",views:{content:{templateUrl:"app/site/modules/task-step/views/tasker_profile.html",controller:"taskProfileCtrl",controllerAs:"TPC"}},data:{meta:{title:"Tasker Details"}},resolve:{TaskProfileResolve:function(TaskService,$stateParams){return TaskService.taskprofileinfo($stateParams.taskerId)}}})}]).controller("rootCtrl",function(config,$window,$scope,$rootScope,$state,AuthenticationService,MainService,socket,notify,$translate,toastr,$cookieStore,ngMeta,$sce){var rc=this,results=config;rc.title=results.response.settings.site_title,rc.getsetting=results.response.settings,rc.getsetting.logos={light:rc.getsetting.light_logo,dark:rc.getsetting.logo},$rootScope.settings=results.response.settings,$rootScope.siteurl=results.response.settings.site_url,$rootScope.site_address=results.response.settings.location,$scope.cashOption=rc.getsetting.pay_by_cash.status,rc.favicon=results.response.settings.site_url+results.response.settings.favicon,MainService.getpaymentMethod().then(function(response){$scope.payment_method=response}),ngMeta.setDefaultTag("title",results.response.seo.seo_title),ngMeta.setDefaultTag("titleSuffix"," | "+rc.title),ngMeta.setDefaultTag("keyword",results.response.seo.focus_keyword),ngMeta.setDefaultTag("description",results.response.seo.meta_description),rc.socialNetworks=results.response.social,rc.language=results.response.languages,rc.signupimg=results.response.images[0],rc.loginimage=results.response.images[3],rc.bgimage=results.response.images[1],rc.tpimg=results.response.images[4],rc.Currency=results.response.currencies,rc.sociallinks=results.response.social[0],rc.pages=results.response.pages,rc.pagescount=results.response.pages.length,rc.social=[],rc.appstore=[],rc.sociallinks.settings.link.filter(function(data){1==data.status&&rc.social.push(data)}),rc.sociallinks.settings.mobileapp.filter(function(data){1==data.status&&rc.appstore.push(data)}),rc.copyrightYear=new Date,$scope.date={format:results.response.settings.date_format+" "+results.response.settings.time_format,timezone:results.response.settings.time_zone,date_format:results.response.settings.time_format,time_format:results.response.settings.time_format},$rootScope.currency=rc.Currency.filter(function(currency){return 1==currency.default})[0],$cookieStore.get("Currency")?(rc.DefaultCurrency=$cookieStore.get("Currency"),$scope.DefaultCurrency=$cookieStore.get("Currency"),$rootScope.currency=$cookieStore.get("Currency")):(rc.DefaultCurrency=$rootScope.currency,$scope.DefaultCurrency=$rootScope.currency),results.response.user&&($rootScope.currAccAvatar=results.response.user.avatar||"/uploads/default/user.jpg"),rc.logout=function(){swal({title:"Are you sure?",text:"You will be logout from this session!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, Log Out!"}).then(function(response){var user=AuthenticationService.GetCredentials();AuthenticationService.Logout(user).then(function(data){AuthenticationService.ClearCredentials(),$translate("SUCCESSFULLY_LOGED_OFF").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)}),$state.go("landing",{},{reload:!0})})}).catch(function(err){})},rc.setDefaultCurrency=function(data){MainService.getDefaultCurrency(data).then(function(response){rc.DefaultCurrency=response[0],$scope.DefaultCurrency=response[0],$cookieStore.put("Currency",response[0]),document.body.scrollTop=document.documentElement.scrollTop=0})},rc.subscription=function(subscriptionForm,data){function clearSubscribe(){subscriptionForm.$setPristine(),subscriptionForm.$setUntouched(),subscriptionForm.email.$setValidity(),subscriptionForm.email.$setDirty(),subscriptionForm.email.$pattern()}if(data)return MainService.subscription(data).then(function(response){$translate("SUBSCRIBED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)}),clearSubscribe()},function(error){$translate("EMAIL ALREADY SUBSCRIBED").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)}),clearSubscribe()});$translate("INVALID EMAIL").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})},rc.otpverifications=function(data){data?MainService.otpverifications(data).then(function(response){console.log("responseresponseresponseresponse",response),rc.userdata=response,data==rc.userdata.email||data==rc.userdata.phone.number?$state.go("signupotp",{id:rc.userdata._id},{reload:!1}):$translate("USERNAME ALREADY ACTIVATED").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})},function(err){$translate(err.data.message).then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})}):$translate("ENTER USER NAME").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})},MainService.getDefaultLanguage().then(function(response){$cookieStore.get("language")?(rc.language_code=$cookieStore.get("language_code"),rc.DefaultLanguage=$cookieStore.get("language"),$rootScope.language=$cookieStore.get("language"),$translate.use(rc.language_code)):(rc.DefaultLanguage=response[0].name,$rootScope.language=response[0].name,$translate.use(response[0].code))}),rc.setDefaultLanguage=function(data){MainService.getDefaultLanguage(data).then(function(response){$cookieStore.put("language",response[0].name),$rootScope.language=response[0].name,$cookieStore.put("language_code",response[0].code),$translate.use(response[0].code),rc.DefaultLanguage&&(MainService.getTransalatePage($rootScope.pageId,rc.DefaultLanguage).then(function(response){0!=response.length?($scope.html=response[0].description,$rootScope.trustedHtml=$sce.trustAsHtml($scope.html)):$rootScope.translatepage="Translate language is not available"}),MainService.getTransalatePageNames(rc.DefaultLanguage).then(function(response){var matchid,translatepages=response;angular.forEach(rc.pages[0].categoryname,function(data,key){angular.forEach(translatepages,function(data1){data.parent?currentid=data.parent:currentid=data._id,matchid=data1.parent?data1.parent:data1._id,currentid==matchid&&(rc.pages[0].categoryname[key]=data1)})}),angular.forEach(rc.pages[1].categoryname,function(data,key){angular.forEach(translatepages,function(data1){matchid=data1.parent?data1.parent:data1._id,data._id==matchid&&(rc.pages[1].categoryname[key]=data1)})})}))})},$rootScope.$on("notification",function(event,data){AuthenticationService.currentmsgcount(data).then(function(response){$scope.chatCount=response})}),$rootScope.$on("webNotification",function(event,data){MainService.getNotificationsCount(data).then(function(response){$scope.notifyCount=response})}),$rootScope.$on("unreadmsg",function(event,data){AuthenticationService.unreadmsg(data).then(function(response){$scope.unreadmsgs=response})}),$scope.currentUserCredentials=AuthenticationService.GetCredentials(),""==$scope.currentUserCredentials||0==Object.keys($scope.currentUserCredentials).length?($rootScope.userId="",$rootScope.username="",$rootScope.usertype="",$rootScope.taskerStatus=""):($rootScope.userId=$scope.currentUserCredentials.currentUser.user_id,$rootScope.username=rc.username=$scope.currentUserCredentials.currentUser.username,$rootScope.usertype=$scope.currentUserCredentials.currentUser.user_type,$rootScope.taskerStatus=$scope.currentUserCredentials.currentUser.tasker_status,$rootScope.currAccAvatar=$scope.currentUserCredentials.currentUser.avatar||"/uploads/default/user.jpg",1==$rootScope.taskerStatus?$rootScope.showAlert=!1:$rootScope.showAlert=!0,socket.emit("create room",{user:$rootScope.userId}),notify.emit("join network",{user:$rootScope.userId}),$rootScope.$emit("notification",{user:$rootScope.userId,type:$rootScope.usertype}),$rootScope.$emit("webNotification",{user:$rootScope.userId,type:$rootScope.usertype}),$rootScope.$emit("unreadmsg",{user:$rootScope.userId,type:$rootScope.usertype})),$scope.tinymceOptions={plugins:"link image code",toolbar:"undo redo | bold italic | alignleft aligncenter alignright | code"},socket.on("roomcreated",function(data){$scope.socket=data}),socket.on("webupdatechat",function(data){"chat"!=$state.current.name&&($rootScope.$emit("notification",{user:$rootScope.userId,type:$rootScope.usertype}),data.receiver==$rootScope.userId&&toastr.info("Message Received","Notification"))}),notify.on("network created",function(data){$scope.socket=data}),notify.on("web notification",function(data){if("account_status"==data.message.action){var value=$rootScope.siteglobals;"Your account status is changed to Verified"==data.message.message?value.currentUser.tasker_status=1:"Your account status is changed to Unverified"==data.message.message?value.currentUser.tasker_status=2:value.currentUser.tasker_status=3,$cookieStore.put("siteglobals",value)}$rootScope.$emit("webNotification",{user:$rootScope.userId,type:$rootScope.usertype}),toastr.info(data.message.message,"Notification")}),$scope.alerts=[],$scope.alertTimeout=5e3,$scope.addAlert=function(type,msg){var alert={};alert.type=type,alert.msg=msg,$scope.alerts.push(alert)},$scope.closeAlert=function(index){$scope.alerts.splice(index,1)},$rootScope.$on("eventName",function(event,args){$scope.currentUserCredentials=AuthenticationService.GetCredentials(),$scope.cartcount=args.count,$rootScope.currAccAvatar=args.avatar||void 0!=args.avatar?args.avatar:"/uploads/default/user.jpg",""==$scope.currentUserCredentials||0==Object.keys($scope.currentUserCredentials).length?($rootScope.userId="",$rootScope.username="",$rootScope.usertype="",$rootScope.taskerStatus="",$rootScope.currAccAvatar=""):(console.log($scope.currentUserCredentials.currentUser),$rootScope.userId=$scope.currentUserCredentials.currentUser.user_id,$rootScope.username=$scope.currentUserCredentials.currentUser.username,$rootScope.usertype=$scope.currentUserCredentials.currentUser.user_type,$rootScope.taskerStatus=$scope.currentUserCredentials.currentUser.tasker_status,$rootScope.currAccAvatar=$scope.currentUserCredentials.currentUser.avatar)})}).controller("taskinfoCtrl",function($scope,$uibModal,$filter){var tic=this;tic.workingDays=[{day:"Sunday",fromTime:0,toTime:0,wholeDay:!1},{day:"Monday",fromTime:0,toTime:0,wholeDay:!1},{day:"Tuesday",fromTime:0,toTime:0,wholeDay:!1},{day:"Wednesday",fromTime:0,toTime:0,wholeDay:!1},{day:"Thursday",fromTime:0,toTime:0,wholeDay:!1},{day:"Friday",fromTime:0,toTime:0,wholeDay:!1},{day:"Saturday",fromTime:0,toTime:0,wholeDay:!1}],tic.addTaskerAvailability=function(workingdays){tic.taskerAvailabilityData=[],angular.forEach(workingdays,function(days){days.selected&&tic.taskerAvailabilityData.push({day:days.day,from:$filter("date")(days.fromTime,"hh:mm:a"),to:$filter("date")(days.toTime,"hh:mm:a"),wholeDay:days.wholeDay})}),console.log("tic.taskerAvailabilityData",tic.taskerAvailabilityData)},tic.checkboxClick=function(group,$event){$event.stopPropagation()},$scope.addCategory=function(category){$uibModal.open({animation:!0,templateUrl:"app/site/modules/tasker/views/addcategory.html",windowClass:"addcatpop"})},$scope.Thankpop=function(category){$uibModal.open({animation:!0,templateUrl:"app/site/modules/tasker/views/thankpop.html",windowClass:"thankpop"})}}).controller("MainCtrl",function($scope,$location,$rootScope,$http,toastr,MainserviceResolve,MainService,$state,$translate,$cookieStore,swal,AuthenticationService,$cookieStore,ngMeta){var mac=this;mac.myInterval=9e3,mac.data=MainserviceResolve,mac.postheader=mac.data.response[1].PostHeader,mac.paymentprice=mac.data.response[5].Paymentprice,mac.peoplecomment=mac.data.response[6].Peoplecomment,mac.banner=mac.data.response[3].Banner,mac.lan_backgroundimg=mac.banner[0].image,mac.lan_bannername=mac.banner[0].name,mac.lan_bannerdes=mac.banner[0].description,mac.site_title=mac.data.response[2].Settings[1].settings.seo_title,ngMeta.setTitle(mac.site_title),$scope.getLocation=function(data){return MainService.searchSuggestions(data).then(function(response){return response},function(error){return error})},mac.subscription=function(subscriptionForm,data){function clearSubscribe(){mac.email="",subscriptionForm.$setPristine(),subscriptionForm.$setUntouched(),subscriptionForm.email.$setValidity(),subscriptionForm.email.$setDirty(),subscriptionForm.email.$pattern()}if(data)return MainService.subscription(data).then(function(response){$translate("SUBSCRIBED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)}),clearSubscribe()},function(error){$translate("EMAIL ALREADY SUBSCRIBED").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)}),clearSubscribe()});$translate("INVALID EMAIL").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})},$scope.searchData={},$rootScope.selectedCategory&&($scope.searchData.parent=$rootScope.selectedCategory.parent,$scope.searchData.child=$rootScope.selectedCategory.child),mac.getsubcategory=function(parentid){return MainService.getsubcategory(parentid).then(function(response){return $scope.searchData.child=null,mac.subcategorydata=response,response},function(error){return error})},mac.onfocusSubCat=function(){$scope.searchData.parent?mac.subcategorydata[0]||$translate("NO SUB CATEGORY FOUND FOR THIS CATEGORY").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)}):($scope.$broadcast("UiSelectParentCategory"),$translate("PLEASE CHOOSE A CATEGORY").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)}))},$scope.changeparent=function(data){return MainService.searchchildSuggestions(data).then(function(response){$scope.childcat=response},function(error){return error})},$scope.search=function(data){var ca=$cookieStore.get("text");$rootScope.selectedCategory=data,ca&&$cookieStore.remove("text"),data.parent?($cookieStore.remove("task_details"),data.child?$state.go("hirestep1",{slug:data.child.slug}):$state.go("category",{slug:data.parent.slug})):$translate("PLEASE CHOOSE A CATEGORY").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})}}).controller("tskheadprofCtrl",function($scope){$scope.shownav=function(){$scope.shwnav=!0}}).controller("MorecategoryCtrl",function(MorecategoryserviceResolve){this.count=4,this.data=MorecategoryserviceResolve}).controller("DatepickerDemoCtrl",function($scope){$scope.today=function(){$scope.dt=new Date},$scope.today(),$scope.clear=function(){$scope.dt=null},$scope.disabled=function(date,mode){return"day"===mode&&(0===date.getDay()||6===date.getDay())},$scope.toggleMin=function(){$scope.minDate=$scope.minDate?null:new Date},$scope.toggleMin(),$scope.open=function($event){$event.preventDefault(),$event.stopPropagation(),$scope.opened=!0},$scope.dateOptions={formatYear:"yy",startingDay:1,class:"datepicker"},$scope.formats=["dd-MMMM-yyyy","yyyy/MM/dd","dd.MM.yyyy","shortDate"],$scope.format=$scope.formats[0]}).controller("SlickController",function($scope,$rootScope,$timeout){$scope.slickbrand={method:{},dots:!1,infinite:!1,slidesToShow:3,slidesToScroll:1,speed:300,responsive:[{breakpoint:1024,settings:{slidesToShow:1,slidesToScroll:1,infinite:!0,dots:!0}},{breakpoint:1023,settings:{slidesToShow:2,slidesToScroll:2}},{breakpoint:767,settings:{slidesToShow:1,slidesToScroll:1}}]},$timeout(function(){$rootScope.viewLoaded=!0})}).controller("DatepickerDobCtrl",function($scope){$scope.today=function(){$scope.dt=new Date},$scope.today(),$scope.disabled=function(date,mode){return"day"===mode&&(0===date.getDay()||6===date.getDay())},$scope.toggleMin=function(){$scope.minDate=$scope.minDate?null:new Date(1945,1,1)},$scope.toggleMin(),$scope.open=function($event){$event.preventDefault(),$event.stopPropagation(),$scope.opened=!0},$scope.dateOptions={formatYear:"yy",startingDay:1,class:"datepicker"},$scope.formats=["dd-MM-yyyy","yyyy/MM/dd","dd.MM.yyyy","shortDate"],$scope.format=$scope.formats[0]}).filter("clock",function(){return function(timestamp,date){return moment.tz(timestamp,date.timezone).format(date.format)}}).filter("money",["$filter",function(filter){var currencyFilter=filter("currency");return function(amount,data){var calAmount=amount*data.value;return currencyFilter(calAmount,data.symbol+" ",2)}}]).filter("clocksettings",function(){return function(timestamp,format,timezone){return moment.tz(timestamp,timezone).format(format)}}).directive("submitValidate",function(){return{require:"form",restrict:"A",link:function(scope,element,attributes){var $element=angular.element(element);$element.on("submit",function(e){$element.find(".ng-pristine").removeClass("ng-pristine").addClass("ng-dirty");var form=scope[attributes.name];angular.forEach(form,function(formElement,fieldName){"$"!==fieldName[0]&&(formElement.$pristine=!1,formElement.$dirty=!0)},this),form.$setDirty(),scope.$apply()})}}}).directive("taskAction",function(){return{restrict:"EA",link:function(scope,element,attributes){var $element=angular.element(element);$element.on("click",function(e){$(".action-space").not($element.parents(".slidetd").find(".action-space")).hide().removeClass("clickd"),$element.parents(".slidetd").find(".action-space").hasClass("clickd")?$element.parents(".slidetd").find(".action-space").hide().removeClass("clickd"):$element.parents(".slidetd").find(".action-space").show().addClass("clickd"),e.preventDefault()})}}}).directive("stringToNumber",function(){return{require:"ngModel",link:function(scope,element,attrs,ngModel){ngModel.$parsers.push(function(value){return""+value}),ngModel.$formatters.push(function(value){if(value)return parseFloat(value.replace(",",""))})}}}).directive("errSrc",function(){return{restrict:"A",link:function(scope,element,attrs){var defaultImg="user"==attrs.errSrc?"uploads/default/user.jpg":"uploads/default/noimage.jpg";attrs.ngSrc||attrs.$set("src",defaultImg),element.bind("error",function(){attrs.src!=attrs.errSrc&&(attrs.errSrc=defaultImg,attrs.$set("src",attrs.errSrc))})}}}).directive("checkFileSize",function(){return{link:function(scope,elem,attr,ctrl){$(elem).bind("change",function(){})}}}).filter("encodeURIComponent",function($window){return $window.encodeURIComponent}).filter("decodeURIComponent",function($window){return $window.decodeURIComponent}).directive("numbersOnly",function(){return{require:"ngModel",link:function(scope,element,attr,ngModelCtrl){ngModelCtrl.$parsers.push(function(text){if(text){var transformedInput=text.replace(/[^0-9]/g,"");return transformedInput!==text&&(ngModelCtrl.$setViewValue(transformedInput),ngModelCtrl.$render()),transformedInput}})}}}).directive("allowOnlyNumbers",function(){return{restrict:"A",link:function(scope,elm,attrs,ctrl){elm.on("keydown",function(event){return 64!=event.which&&16!=event.which&&(event.which>=48&&event.which<=57||(event.which>=96&&event.which<=105||([8,13,27,37,38,39,40,9,190,110].indexOf(event.which)>-1||(event.preventDefault(),!1))))})}}}).directive("scroll",function($timeout){return{restrict:"A",link:function(scope,element,attr){scope.$watchCollection(attr.scroll,function(newVal){$timeout(function(){element[0].scrollTop=element[0].scrollHeight})})}}}).directive("logo",function($window){return{restrict:"E",template:"<img style='width: auto;max-height: 45px;' src='{{default}}' class='mob-lg'>",scope:{logos:"=images",view:"=view"},controller:function($scope){$scope.$watch("view",function(newview,oldview){"landing"==newview?($scope.default=$scope.logos.light,angular.element($window).bind("scroll",function(event){this.pageYOffset>100?$scope.default=$scope.logos.dark:$scope.default=$scope.logos.light,$(".handy-home-header .navbar").toggleClass("fixed",this.pageYOffset>100),$scope.$apply()})):(angular.element($window).off("scroll"),$scope.default=$scope.logos.dark)},!0)}}}).directive("lazyerr",function(){return{restrict:"A",link:function(scope,element,attrs){return attrs.$observe("afklLazyImageLoaded",function(value){})}}}).directive("tooltip",function(){return{restrict:"A",link:function(scope,element,attrs){$(element).hover(function(){},function(){})}}}).directive("disallowSpaces",function(){return{restrict:"A",link:function($scope,$element){$element.bind("input",function(){$(this).val($(this).val().replace(/ /g,""))})}}}).directive("backButton",["$window",function($window){return{restrict:"A",link:function(scope,elem,attrs){elem.bind("click",function(){$window.history.back()})}}}]);app=angular.module("handyforall.site");app.factory("MainService",MainService);(app=angular.module("handyforall.site")).factory("notify",notify),angular.module("handyforall.authentication").controller("registerCtrl",registerCtrl).controller("DeactivateController",DeactivateController).controller("userloginCtrl",userloginCtrl).controller("taskerloginCtrl",taskerloginCtrl),taskerloginCtrl.$inject=["$scope","$rootScope","$location","AuthenticationService","$state","toastr","$cookieStore","socket","$translate"],userloginCtrl.$inject=["$scope","$http","$rootScope","$uibModal","$location","AuthenticationService","$state","toastr","$cookieStore","socket","PreviousState","$window","$translate","MainService","routes","$stateParams"],registerCtrl.$inject=["$scope","$compile","$rootScope","uiCalendarConfig","$uibModal","CategoryserviceResolve","$location","AuthenticationService","$state","$filter","toastr","$cookieStore","$stateParams","$translate","accountService","NgMap","$timeout","MainService","routes","settingsResolve"],DeactivateController.$inject=["$scope","$rootScope","$location","AuthenticationService","$state","$filter","toastr","$cookieStore"],angular.module("handyforall.becometasker").controller("ModalInstanceWorkingDayCtrl11",function($scope,$uibModalInstance,DaysData,WorkingDays,workingTimes,selectedIndex){$scope.WorkingDays=angular.copy(WorkingDays[selectedIndex]),$scope.workingTimes=workingTimes,$scope.days=DaysData,$scope.ok=function(){1==$scope.WorkingDays.hour.morning||1==$scope.WorkingDays.hour.afternoon||1==$scope.WorkingDays.hour.evening?$scope.WorkingDays.not_working=!1:$scope.WorkingDays.not_working=!0,$uibModalInstance.close($scope.WorkingDays,selectedIndex)},$scope.cancel=function(WorkingDays){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").directive("cropImgChange",function(){return{restrict:"A",link:function(scope,element,attrs){var onChangeHandler=scope.$eval(attrs.cropImgChange);element.bind("change",onChangeHandler)}}}),angular.module("handyforall.authentication").controller("ModalInstancecategory",function(accountService,$uibModalInstance,experiences,user,toastr,categories,category,selectedCat,defaultcurrency,$translate){var acm=this;acm.user=user,acm.selectedCat=selectedCat,acm.categories=categories,acm.defaultcurrency=defaultcurrency,acm.experiences=experiences,acm.selectedCategoryData={},category?(acm.mode="Edit",accountService.getChild(category).then(function(response){acm.MinimumAmount=response.commision,acm.ratetype=response.ratetype})):(acm.mode="Add",acm.categories=acm.categories.filter(function(obj){return-1===acm.selectedCat.indexOf(obj._id)}));for(var i=0;i<acm.user.taskerskills.length;i++)acm.user.taskerskills[i].childid==category&&(acm.selectedCategoryData=angular.copy(acm.user.taskerskills[i]));acm.onChangeCategory=function(category){acm.category=acm.categories.filter(function(obj){return obj._id===category})[0]},acm.onChangeCategoryChild=function(category){accountService.getChild(category).then(function(response){acm.MinimumAmount=response.commision,acm.ratetype=response.ratetype})},acm.ok=function(valid){valid?("Flat"==acm.ratetype&&(acm.selectedCategoryData.hour_rate=acm.MinimumAmount),acm.selectedCategoryData.mode=acm.mode,$uibModalInstance.close(acm.selectedCategoryData)):toastr.error("Please enter all values")},acm.cancel=function(){$uibModalInstance.dismiss("cancel")}});(app=angular.module("handyforall.authentication")).factory("AuthenticationService",AuthenticationService),AuthenticationService.$inject=["$http","$cookieStore","$rootScope","toastr","$q","$cookies","Upload","socket","notify"],angular.module("handyforall.site").directive("submitValidate",function(){return{require:"form",restrict:"A",link:function(scope,element,attributes){var $element=angular.element(element);$element.on("submit",function(e){$element.find(".ng-pristine").removeClass("ng-pristine").addClass("ng-dirty");var form=scope[attributes.name];angular.forEach(form,function(formElement,fieldName){"$"!==fieldName[0]&&(formElement.$pristine=!1,formElement.$dirty=!0)},this),form.$setDirty(),scope.$apply()})}}}),angular.module("handyforall.site").directive("onBlurValidation",function(){return{restrict:"A",require:"?ngModel",link:function(scope,elm,attr,ctrl){ctrl&&(elm.on("focus",function(){elm.addClass("has-focus"),scope.$apply(function(){ctrl.hasFocus=!0})}),elm.on("blur",function(){elm.removeClass("has-focus"),elm.addClass("has-visited"),scope.$apply(function(){ctrl.hasFocus=!1,ctrl.hasVisited=!0})}),elm.closest("form").on("submit",function(){elm.addClass("has-visited"),scope.$apply(function(){ctrl.hasFocus=!1,ctrl.hasVisited=!0})}))}}}),angular.module("checklist-model",[]).directive("checklistModel",["$parse","$compile",function($parse,$compile){function contains(arr,item,comparator){if(angular.isArray(arr))for(var i=arr.length;i--;)if(comparator(arr[i],item))return!0;return!1}return{restrict:"A",priority:1e3,terminal:!0,scope:!0,compile:function(tElement,tAttrs){if(("INPUT"!==tElement[0].tagName||"checkbox"!==tAttrs.type)&&"MD-CHECKBOX"!==tElement[0].tagName&&!tAttrs.btnCheckbox)throw'checklist-model should be applied to `input[type="checkbox"]` or `md-checkbox`.';if(!tAttrs.checklistValue&&!tAttrs.value)throw"You should provide `value` or `checklist-value`.";return tAttrs.ngModel||tAttrs.$set("ngModel","checked"),function(scope,elem,attrs){function setValueInChecklistModel(value,checked){var current=getter(scope.$parent);angular.isFunction(setter)&&(!0===checked?setter(scope.$parent,function(arr,item,comparator){return arr=angular.isArray(arr)?arr:[],contains(arr,item,comparator)||arr.push(item),arr}(current,value,comparator)):setter(scope.$parent,function(arr,item,comparator){if(angular.isArray(arr))for(var i=arr.length;i--;)if(comparator(arr[i],item)){arr.splice(i,1);break}return arr}(current,value,comparator)))}function setChecked(newArr,oldArr){checklistBeforeChange&&!1===checklistBeforeChange(scope)?setValueInChecklistModel(value,scope[attrs.ngModel]):scope[attrs.ngModel]=contains(newArr,value,comparator)}var checklistModel=attrs.checklistModel;attrs.$set("checklistModel",null),$compile(elem)(scope),attrs.$set("checklistModel",checklistModel);var getter=$parse(checklistModel),setter=getter.assign,checklistChange=$parse(attrs.checklistChange),checklistBeforeChange=$parse(attrs.checklistBeforeChange),value=attrs.checklistValue?$parse(attrs.checklistValue)(scope.$parent):attrs.value,comparator=angular.equals;if(attrs.hasOwnProperty("checklistComparator"))if("."==attrs.checklistComparator[0]){var comparatorExpression=attrs.checklistComparator.substring(1);comparator=function(a,b){return a[comparatorExpression]===b[comparatorExpression]}}else comparator=$parse(attrs.checklistComparator)(scope.$parent);scope.$watch(attrs.ngModel,function(newValue,oldValue){newValue!==oldValue&&(checklistBeforeChange&&!1===checklistBeforeChange(scope)?scope[attrs.ngModel]=contains(getter(scope.$parent),value,comparator):(setValueInChecklistModel(value,newValue),checklistChange&&checklistChange(scope)))}),angular.isFunction(scope.$parent.$watchCollection)?scope.$parent.$watchCollection(checklistModel,setChecked):scope.$parent.$watch(checklistModel,setChecked,!0)}}}}]),angular.module("ngIntlTelInput",[]),angular.module("ngIntlTelInput").provider("ngIntlTelInput",function(){var me=this,props={};me.set=function(obj){if("object"==typeof obj)for(var key in obj)props[key]=obj[key]},me.$get=["$log",function($log){return Object.create(me,{init:{value:function(elm){window.intlTelInputUtils||$log.warn("intlTelInputUtils is not defined. Formatting and validation will not work."),elm.intlTelInput(props)}}})}]}),angular.module("ngIntlTelInput").directive("ngIntlTelInput",["ngIntlTelInput","$log","$http","ipinfo",function(ngIntlTelInput,$log,$http,ipinfo){return{restrict:"A",require:"ngModel",scope:{country:"@"},link:function(scope,elm,attr,ctrl){attr.type&&"text"!==attr.type&&"tel"!==attr.type||"INPUT"!==elm[0].tagName?$log.warn("ng-intl-tel-input can only be applied to a *text* or *tel* input"):(ctrl.$validators.ngIntlTelInput=function(value){return!(value||elm[0].value.length>0)||elm.intlTelInput("isValidNumber")},ctrl.$parsers.push(function(value){var phone={};return phone.code="+"+elm.intlTelInput("getSelectedCountryData").dialCode,phone.number=elm.intlTelInput("getNumber"),phone.number=phone.number.replace(phone.code,""),phone}),ctrl.$formatters.push(function(phone){var countryCode=ipinfo&&ipinfo.country?ipinfo.country:"";return ngIntlTelInput.set({defaultCountry:countryCode}),ngIntlTelInput.init(elm),phone?(elm.intlTelInput("setNumber",phone.code+phone.number),phone.number):void 0}))}}}]),angular.module("handyforall.becometasker").controller("becomeTaskerCtrl",becomeTaskerCtrl),becomeTaskerCtrl.$inject=["$scope","$compile","uiCalendarConfig","$uibModal","$state","$cookieStore","CategoryserviceResolve","$filter","toastr","AuthenticationService","$rootScope","$location","accountService","$translate","NgMap","$timeout"],angular.module("handyforall.becometasker").controller("ModalInstanceWorkingDayCtrl",function($scope,$uibModalInstance,DaysData,WorkingDays,workingTimes,selectedIndex){$scope.WorkingDays=angular.copy(WorkingDays[selectedIndex]),$scope.workingTimes=workingTimes,$scope.days=DaysData,$scope.ok=function(){1==$scope.WorkingDays.hour.morning||1==$scope.WorkingDays.hour.afternoon||1==$scope.WorkingDays.hour.evening?$scope.WorkingDays.not_working=!1:$scope.WorkingDays.not_working=!0,$uibModalInstance.close($scope.WorkingDays,selectedIndex)},$scope.cancel=function(WorkingDays){console.log("NTR"),$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").directive("cropImgChange",function(){return{restrict:"A",link:function(scope,element,attrs){var onChangeHandler=scope.$eval(attrs.cropImgChange);element.bind("change",onChangeHandler)}}}),angular.module("handyforall.contactus").controller("contactCtrl",contactCtrl),contactCtrl.$inject=["$scope","ContactService","$rootScope","$location","$filter","$state","toastr","$translate","$sce"];(app=angular.module("handyforall.category")).factory("ContactService",ContactService),angular.module("handyforall.category").controller("categoryCtrl",categoryCtrl),categoryCtrl.$inject=["$scope","$rootScope","$location","$stateParams","CategoryserviceResolve","CategoryService","$state","$translate","ngMeta","$cookieStore"];(app=angular.module("handyforall.category")).factory("CategoryService",CategoryService),angular.module("handyforall.task").controller("taskCtrl",taskCtrl),taskCtrl.$inject=["$scope","$rootScope","$location","$stateParams","$uibModal","TaskService","TaskserviceResolve","toastr","$state","AuthenticationService","CurrentUserTaskserviceResolve","MainService","$translate","ngMeta","$cookieStore"],angular.module("handyforall.task").controller("taskProfileCtrl",taskProfileCtrl),taskProfileCtrl.$inject=["$scope","$rootScope","$location","$stateParams","$uibModal","TaskService","TaskProfileResolve","toastr","$state","$translate","$cookieStore"],angular.module("handyforall.task").controller("ConfirmtaskModel",function($uibModalInstance){this.ok=function(){$uibModalInstance.close("ok")},this.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.task").controller("taskFilterCtrl",taskFilterCtrl),taskFilterCtrl.$inject=["$scope","$rootScope","$location","$stateParams","SearchResolve","TaskService","toastr","$state","$filter","AuthenticationService","$modal","MainService","$translate","ngMeta","NgMap","$scope","$q","$log","$uibModal","swal","$cookieStore"],angular.module("handyforall.task").directive("setClassWhenAtTop",function($window){var $win=angular.element($window);return{restrict:"A",link:function(scope,element,attrs){var topClass=attrs.setClassWhenAtTop,offsetTop=element.offset().top;$win.on("scroll",function(e){$win.scrollTop()>=offsetTop?element.addClass(topClass):element.removeClass(topClass)})}}});(app=angular.module("handyforall.task")).factory("TaskService",TaskService),angular.module("handyforall.accounts").controller("TaskPayModalInstanceCtrl",function($scope,$filter,$uibModalInstance,Taskinfobyid,updatingstatus){var tpm=this;tpm.user=Taskinfobyid.taskdata[0].user,tpm.taskid=Taskinfobyid.taskdata[0]._id,tpm.status=updatingstatus,tpm.bookingid=Taskinfobyid.taskdata[0].booking_id,tpm.taskname=Taskinfobyid.taskdata[0].category.name,tpm.admincommision=Taskinfobyid.settingsdata.settings.admin_commission,tpm.servicetax=Taskinfobyid.settingsdata.settings.service_tax,tpm.minimumamount=Taskinfobyid.settingsdata.settings.minimum_amount,tpm.taskdescription=Taskinfobyid.taskdata[0].task_description,tpm.hourlyrate=$filter("filter")(Taskinfobyid.taskdata[0].tasker.taskerskills,{childid:Taskinfobyid.taskdata[0].category._id}),tpm.totalhour1=function(){tpm.total=tpm.hourlyrate[0].hour_rate,tpm.totalhour>1?(tpm.newtotal=parseInt(tpm.minimumamount)+parseInt(tpm.total)*(parseInt(tpm.totalhour)-1),tpm.taxamount=parseInt(tpm.newtotal)*(parseInt(tpm.servicetax)/100),tpm.adminamount=parseInt(tpm.newtotal)*(parseInt(tpm.admincommision)/100),tpm.commisionamount=parseInt(tpm.adminamount)+parseInt(tpm.taxamount),tpm.grandtotal=parseInt(tpm.newtotal)+parseInt(tpm.commisionamount)):tpm.totalhour<=1?(tpm.newtotal=parseInt(tpm.minimumamount),tpm.taxamount=parseInt(tpm.minimumamount)*(parseInt(tpm.servicetax)/100),tpm.adminamount=parseInt(tpm.minimumamount)*(parseInt(tpm.admincommision)/100),tpm.commisionamount=parseInt(tpm.adminamount)+parseInt(tpm.taxamount),tpm.grandtotal=parseInt(tpm.minimumamount)+parseInt(tpm.commisionamount)):tpm.grandtotal=parseInt(tpm.total)},tpm.ok=function(){$uibModalInstance.close(tpm)},tpm.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").controller("DeactivateCtrl",function($uibModalInstance,user,$state){var decm=this;decm.user=user,decm.userid=decm.user._id,decm.ok=function(){$uibModalInstance.close(decm.userid),$state.go("Deactivate")},decm.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").controller("CategoriesModalInstanceCtrl",function(accountService,$uibModalInstance,experiences,user,toastr,categories,category,defaultcurrency,$translate){var acm=this;acm.role=category?"Edit":"New",acm.user=user,acm.defaultcurrency=defaultcurrency,acm.categories=categories,acm.experiences=experiences,acm.category=acm.categories.filter(function(obj){return obj._id===category})[0],acm.selectedCategoryData={},acm.selectedCategoryData.skills=[],acm.selectedCategoryData.hour_rate=0,acm.category?acm.mode="EDIT":acm.mode="ADD";for(var i=0;i<acm.user.taskerskills.length;i++)acm.user.taskerskills[i].childid==category&&(acm.selectedCategoryData=acm.user.taskerskills[i]);acm.selectedCategoryData.userid=acm.user._id,acm.onChangeCategory=function(category){acm.category=acm.categories.filter(function(obj){return obj._id===category})[0]},acm.onChangeCategoryChild=function(category){accountService.getChild(category).then(function(response){acm.MinimumAmount=response.commision}),acm.category=acm.user.taskerskills.filter(function(obj){if(obj.childid!==category)return obj._id===category;$translate("ALREADY THE CATEGORY IS EXISTS").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)}),$uibModalInstance.dismiss("cancel")})[0]},acm.selectedCategoryData.childid&&accountService.getChild(acm.selectedCategoryData.childid).then(function(response){acm.MinimumAmount=response.commision}),acm.selectedCategoryData.hour_rate=parseFloat((acm.selectedCategoryData.hour_rate*acm.defaultcurrency[0].value).toFixed(2)),acm.ok=function(valid){valid?$uibModalInstance.close(acm.selectedCategoryData):$translate("FORM IS INVALID").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})},acm.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").controller("AvailabilityModalInstanceCtrl",function($scope,$uibModalInstance,workingDays,workingTimes,DaysData,selectedIndex){$scope.WorkingDays=workingDays[selectedIndex],$scope.workingTimes=workingTimes,$scope.days=DaysData,$scope.ok=function(){1==$scope.WorkingDays.hour.morning||1==$scope.WorkingDays.hour.afternoon||1==$scope.WorkingDays.hour.evening?$scope.WorkingDays.not_working=!1:$scope.WorkingDays.not_working=!0,$uibModalInstance.close($scope.WorkingDays,selectedIndex)},$scope.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").controller("TaskInviteViewModalInstanceCtrl",function($uibModalInstance,TaskInvite,DefaultCurrency,getsettings){this.TaskInvite=TaskInvite,this.DefaultCurrency=DefaultCurrency,this.getsettings=getsettings,this.ok=function(working_day,index){$uibModalInstance.close({})},this.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").controller("TaskerExtraViewModalInstanceCtrl",function($uibModalInstance,$translate,Taskid,status,DefaultCurrency,accountService,toastr){var tevmi=this;tevmi.defaultcurrency=DefaultCurrency,tevmi.addmaterial=!1,tevmi.total=0,tevmi.choices=[],tevmi.addNewChoice=function(){var newItemNo=tevmi.choices.length+1;tevmi.choices.push({id:"choice"+newItemNo}),tevmi.calculateChoice()},tevmi.calculateChoice=function(){if(tevmi.total=0,tevmi.newchoice)for(var i=0;i<tevmi.choices.length;i++)tevmi.newchoice.value[i]&&(tevmi.total=tevmi.total+parseFloat(tevmi.newchoice.value[i]))},tevmi.removeChoice=function(){var lastItem=tevmi.choices.length-1;0!=lastItem?(tevmi.newchoice.value[lastItem]="",tevmi.newchoice.name[lastItem]="",tevmi.choices.pop({id:"choice"+lastItem})):(tevmi.addmaterial=!1,tevmi.newchoice.value[lastItem]="",tevmi.newchoice.name[lastItem]="",tevmi.choices.pop({id:"choice"+lastItem})),tevmi.calculateChoice()},tevmi.taskid=Taskid,tevmi.defaultCurrency=DefaultCurrency,tevmi.status=status;var newdata=[];tevmi.ok=function(test,valid){if(valid)if(test.newchoice){for(var i=0;i<test.choices.length;i++){(data={}).name=test.newchoice.name[i],data.price=parseFloat((test.newchoice.value[i]/tevmi.defaultcurrency[0].value).toFixed(2)),newdata.push(data)}tevmi.newdata=newdata,$uibModalInstance.close(tevmi)}else{var data={};data.taskid=test.taskid,data.status=test.status,$uibModalInstance.close(data)}else $translate("PLEASE ENTER ALL FEILD").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})},tevmi.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").controller("TaskDetailsViewModalInstanceCtrl",function($uibModalInstance,TaskDetails,DefaultCurrency){this.TaskDetails=TaskDetails,this.DefaultCurrency=DefaultCurrency,this.taskdescription=TaskDetails.task_description,this.ok=function(){$uibModalInstance.close()},this.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").controller("TaskDetailsViewforstatusModalInstanceCtrl",function($uibModalInstance,TaskDetails,defaultcurrency){this.defaultcurrency=defaultcurrency,this.TaskDetails=TaskDetails;var a=TaskDetails.invoice.worked_hours,hours=Math.trunc(a/60),minutes=a%60;this.Task_time=0==hours?.1==minutes?minutes+" min":minutes+" mins":hours+" hours "+minutes+" mins",this.taskdescription=TaskDetails.task_description,this.ok=function(){$uibModalInstance.close()},this.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").controller("TaskDetailsIgnoreModalInstanceCtrl",function($translate,$uibModalInstance,$state,userid,status,toastr,cancelreason){var tdimi=this;tdimi.userid=userid,tdimi.taskstatus=status,tdimi.cancelreason=cancelreason,tdimi.other=0,tdimi.ok=function(data){data.reason?$uibModalInstance.close(tdimi):$translate("REASON FIELD IS EMPTY").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})},tdimi.cancel=function(){$uibModalInstance.dismiss("cancel")},tdimi.otherclick=function(other){tdimi.other=1},tdimi.click=function(other){tdimi.other=0}}),angular.module("handyforall.accounts").controller("WalletRechargeModal",function($uibModalInstance,$state,$translate,Rechargeamount,toastr){var wrm=this;wrm.rechargeamount=Rechargeamount;var walletamount=wrm.rechargeamount.data.replace(/,/g,""),currencyvalue=wrm.rechargeamount.currencyvalue,result=parseFloat(walletamount)/parseFloat(currencyvalue),walletamount="";wrm.walletamount=result.toFixed(2),wrm.ok=function(isValid){1==isValid?$uibModalInstance.close(wrm):$translate("FORM IS INVALID").then(function(headline){toastr.error(headline)},function(headline){toastr.error(headline)})},wrm.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").controller("TaskDetailsconfirmModalInstanceCtrl",function($uibModalInstance,$state,taskid,status,taskerid){var tdcmi=this;tdcmi.taskid=taskid,tdcmi.taskstatus=status,tdcmi.taskerid=taskerid,tdcmi.ok=function(){$uibModalInstance.close(tdcmi)},tdcmi.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").controller("DeleteCategoriesModalInstanceCtrl",function($uibModalInstance,user,category,categoryname,$translate,toastr){this.category=category,this.user=user;var categoryinfo={};categoryinfo.userid=user._id,categoryinfo.categoryid=category,categoryinfo.categoryname=categoryname,this.ok=function(){$uibModalInstance.close(categoryinfo),$translate("CATEGORY DELETED SUCCESSFULLY").then(function(headline){toastr.success(headline)},function(headline){toastr.success(headline)})},this.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").controller("DisputeReviewModalInstanceCtrl",function($uibModalInstance,TaskDetails,accountService,status,$state){var dnm=this;dnm.indexValue=TaskDetails._id,dnm.ststusvalue=status,dnm.ok=function(){accountService.disputeUpdateTask(dnm.indexValue,dnm.ststusvalue).then(function(response){$state.reload()},function(err){}),$uibModalInstance.close(dnm.review)},dnm.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").controller("TaskReviewModalCtrl",function($uibModalInstance,TaskDetails){var trem=this;trem.TaskDetails=TaskDetails,trem.ok=function(){$uibModalInstance.close(trem.review)},trem.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").controller("TaskReviewModalSave",function($uibModalInstance){var trem=this;trem.ok=function(){$uibModalInstance.close(trem.review)},trem.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").controller("TaskTranscationViewModal",function($scope,task,$uibModalInstance,accountService,TaskDetails,defaultcurrency,getsettings,getmaincatname){var trems=this;trems.TaskDetails=TaskDetails,trems.task=task,trems.maincategoryname=getmaincatname.name,trems.defaultcurrency=defaultcurrency,trems.getsettings=getsettings,trems.downloadPdf=function(){accountService.downloadPdf(trems.TaskDetails.bookingid).then(function(response){})},trems.ok=function(){$uibModalInstance.close(trems.review)},trems.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").controller("TaskUserTranscationViewModal",function($scope,task,$uibModalInstance,accountService,TaskDetails,defaultcurrency,getsettings,getmaincatname){var trems=this;trems.TaskDetails=TaskDetails,trems.task=task,trems.maincategoryname=getmaincatname.name,trems.defaultcurrency=defaultcurrency,trems.getsettings=getsettings,(trems.TaskDetails.invoice.amount.total+trems.TaskDetails.invoice.amount.service_tax)*trems.defaultcurrency[0].value>trems.TaskDetails.invoice.amount.coupon*trems.defaultcurrency[0].value?(trems.checkvalue="big",trems.total=(((trems.TaskDetails.invoice.amount.total+trems.TaskDetails.invoice.amount.service_tax+trems.TaskDetails.invoice.amount.extra_amount)*trems.defaultcurrency[0].value-trems.TaskDetails.invoice.amount.coupon)*trems.defaultcurrency[0].value).toFixed(2)):(trems.checkvalue="small",trems.total=((trems.TaskDetails.invoice.amount.extra_amount+trems.TaskDetails.invoice.amount.service_tax)*trems.defaultcurrency[0].value).toFixed(2)),trems.downloadPdf=function(){accountService.downloadPdf(trems.TaskDetails.bookingid).then(function(response){})},trems.ok=function(){$uibModalInstance.close(trems.review)},trems.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").controller("addReviewModal",function($uibModalInstance,TaskDetails,$scope,$state){var arm=this;arm.user=TaskDetails.user,arm.tasker=TaskDetails.tasker._id,arm.task=TaskDetails._id,arm.type="user",arm.ok=function(){$uibModalInstance.close(arm),$state.go("account.profile")},arm.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").controller("reviewModelCtrl",function($uibModalInstance,data,role){var rmc=this;rmc.reviewData=data,rmc.role=role,rmc.ok=function(){$uibModalInstance.close(rmc)},rmc.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.accounts").directive("cropImgChange",function(){return{restrict:"A",link:function(scope,element,attrs){var onChangeHandler=scope.$eval(attrs.cropImgChange);element.bind("change",onChangeHandler)}}});(app=angular.module("handyforall.accounts")).factory("accountService",accountService),angular.module("handyforall.accounts").controller("accountWalletCtrl",accountWalletCtrl).controller("WalletRechargeModal",WalletRechargeModal),accountWalletCtrl.$inject=["$scope","$rootScope","toastr","$window","$stateParams","MainService","routes","$uibModal","$translate"],WalletRechargeModal.$inject=["$uibModalInstance","$state","$translate","Rechargeamount","toastr"],angular.module("handyforall.accounts").controller("AccountPasswordCtrl",AccountPasswordCtrl),AccountPasswordCtrl.$inject=["$scope","$rootScope","toastr","MainService","routes","$state","$translate"],angular.module("handyforall.accounts").controller("AccountTasksCtrl",AccountTasksCtrl).controller("TaskViewModalInstanceCtrl",TaskViewModalInstanceCtrl).controller("TaskCancelModalInstanceCtrl",TaskCancelModalInstanceCtrl).controller("AddReviewModalInstanceCtrl",AddReviewModalInstanceCtrl).controller("TaskDetailsViewforstatusModalInstanceCtrl",TaskDetailsViewforstatusModalInstanceCtrl),AccountTasksCtrl.$inject=["$scope","$rootScope","toastr","$stateParams","MainService","accountService","routes","$uibModal","$state","$cookieStore"],TaskViewModalInstanceCtrl.$inject=["$uibModalInstance","TaskDetails","DefaultCurrency"],TaskCancelModalInstanceCtrl.$inject=["$uibModalInstance","userid","status","cancelreason","toastr","$translate"],AddReviewModalInstanceCtrl.$inject=["$uibModalInstance","TaskDetails","$scope","$state"],TaskDetailsViewforstatusModalInstanceCtrl.$inject=["$uibModalInstance","TaskDetails","defaultcurrency"],angular.module("handyforall.accounts").controller("AccountProfileCtrl",AccountProfileCtrl).controller("OTPModelCtrl",OTPModelCtrl),AccountProfileCtrl.$inject=["$scope","$rootScope","$translate","MainService","routes","toastr","AuthenticationService","$cookieStore","$state","$uibModal"],OTPModelCtrl.$inject=["$scope","$rootScope","toastr","$uibModalInstance","MainService"],angular.module("handyforall.accounts").controller("AccountInviteFriends",AccountInviteFriends),AccountInviteFriends.$inject=["$scope","$rootScope","$state","MainService","routes","$window"],angular.module("handyforall.accounts").controller("AccountDeactivateCtrl",AccountDeactivateCtrl).controller("DeactivateModalCtrl",DeactivateModalCtrl),AccountDeactivateCtrl.$inject=["$scope","$rootScope","$state","MainService","routes","toastr","$translate","$uibModal","swal","AuthenticationService"],DeactivateModalCtrl.$inject=["$scope","$rootScope","$state","toastr","$translate","$uibModalInstance","userResolve"],angular.module("handyforall.accounts").controller("AccountTransactionCtrl",AccountTransactionCtrl).controller("TaskUserTranscationViewModalCtrl",TaskUserTranscationViewModalCtrl).controller("TaskTranscationViewModalCtrl",TaskUserTranscationViewModalCtrl),AccountTransactionCtrl.$inject=["$scope","$rootScope","$state","MainService","routes","toastr","$translate","$uibModal"],TaskUserTranscationViewModalCtrl.$inject=["$scope","task","$uibModalInstance","TaskDetails","defaultcurrency","getsettings","getmaincatname","MainService","routes"],TaskTranscationViewModalCtrl.$inject=["$scope","task","$uibModalInstance","TaskDetails","defaultcurrency","getsettings","getmaincatname","MainService","routes"],angular.module("handyforall.accounts").controller("AccountReviewCtrl",AccountReviewCtrl).controller("ReviewModelCtrl",ReviewModelCtrl),AccountReviewCtrl.$inject=["$scope","$rootScope","$state","MainService","routes","$uibModal","toastr"],ReviewModelCtrl.$inject=["$scope","$rootScope","$state","MainService","routes","toastr","$uibModalInstance","data","role"],angular.module("handyforall.accounts").controller("AccountHeaderCtrl",AccountHeaderCtrl),AccountHeaderCtrl.$inject=["$scope","$rootScope","$state","toastr","accountProfileResolve","seoSettingsResolve","settingsResolve","defaultCurrency","$cookieStore"],angular.module("handyforall.accounts").controller("AccountInformationCtrl",AccountInformationCtrl),AccountInformationCtrl.$inject=["$scope","$rootScope","$state","toastr","$translate","MainService","routes"],angular.module("handyforall.accounts").controller("AccountCategoryCtrl",AccountCategoryCtrl).controller("CategoriesModalInstanceCtrl",CategoriesModalInstanceCtrl),AccountCategoryCtrl.$inject=["$scope","$rootScope","$state","toastr","MainService","routes","$uibModal","$translate"],CategoriesModalInstanceCtrl.$inject=["$scope","$rootScope","$state","toastr","MainService","routes","experiences","defaultcurrency","user","categories","category","$uibModalInstance","$translate"],angular.module("handyforall.accounts").controller("AccountAvailabityCtrl",AccountAvailabityCtrl),AccountAvailabityCtrl.$inject=["$scope","$rootScope","$state","toastr","MainService","routes","$uibModal","$translate","$filter"],angular.module("handyforall.accounts").controller("AccountUnavailabilityCtrl",AccountUnavailabilityCtrl),AccountUnavailabilityCtrl.$inject=["$scope","$rootScope","$state","toastr","MainService","routes","$uibModal","$translate","$filter"],angular.module("handyforall.authentication").controller("UnavailabilityModalCtrl",function($rootScope,$uibModalInstance,toastr,$translate,MainService){var uamic=this;uamic.wholeday=!1,uamic.unavailableTimingSlotList=[{slot:0,time:"12AM - 1AM",selected:!1},{slot:1,time:"1AM - 2AM",selected:!1},{slot:2,time:"2AM - 3AM",selected:!1},{slot:3,time:"3AM - 4AM",selected:!1},{slot:4,time:"4AM - 5AM",selected:!1},{slot:5,time:"5AM - 6AM",selected:!1},{slot:6,time:"6AM - 7AM",selected:!1},{slot:7,time:"7AM - 8AM",selected:!1},{slot:8,time:"8AM - 9AM",selected:!1},{slot:9,time:"9AM - 10AM",selected:!1},{slot:10,time:"10AM - 11AM",selected:!1},{slot:11,time:"11AM - 12PM",selected:!1},{slot:12,time:"12PM - 1PM",selected:!1},{slot:13,time:"1PM - 2PM",selected:!1},{slot:14,time:"2PM - 3PM",selected:!1},{slot:15,time:"3PM - 4PM",selected:!1},{slot:16,time:"4PM - 5PM",selected:!1},{slot:17,time:"5PM - 6PM",selected:!1},{slot:18,time:"6PM - 7PM",selected:!1},{slot:19,time:"7PM - 8PM",selected:!1},{slot:20,time:"8PM - 9PM",selected:!1},{slot:21,time:"9PM - 10PM",selected:!1},{slot:22,time:"10PM - 11PM",selected:!1},{slot:23,time:"11PM - 12AM",selected:!1}],uamic.ok=function(){$uibModalInstance.close(uamic)},uamic.cancel=function(){$uibModalInstance.close()}}),angular.module("handyforall.accounts").controller("AccountTaskerJobCtrl",AccountTaskerJobCtrl).controller("TaskInviteViewModalInstanceCtrl",TaskInviteViewModalInstanceCtrl).controller("TaskDetailsCancelModalInstanceCtrl",TaskDetailsCancelModalInstanceCtrl).controller("TaskerExtraViewModalInstanceCtrl",TaskerExtraViewModalInstanceCtrl).controller("TaskReviewModalCtrl",TaskReviewModalCtrl),AccountTaskerJobCtrl.$inject=["$scope","$rootScope","$state","toastr","$uibModal","$translate","MainService","routes","$cookieStore"],TaskInviteViewModalInstanceCtrl.$inject=["$uibModalInstance","TaskInvite","DefaultCurrency","getsettings"],TaskDetailsCancelModalInstanceCtrl.$inject=["$translate","$uibModalInstance","$state","userid","status","toastr","cancelreason"],TaskerExtraViewModalInstanceCtrl.$inject=["$uibModalInstance","$translate","Taskid","status","DefaultCurrency","toastr"],TaskReviewModalCtrl.$inject=["$uibModalInstance","TaskDetails"],angular.module("handyforall.messages").controller("messagesCtrl",messagesCtrl),messagesCtrl.$inject=["MessageserviceResolve","MessageService","CurrentuserResolve","$uibModal","toastr","$translate","swal"],angular.module("handyforall.messages").controller("deletemessageCtrl",function($uibModalInstance,idinfo){idinfo.from=idinfo.from,idinfo.to=idinfo.to,this.ok=function(){$uibModalInstance.close(idinfo)},this.cancel=function(){$uibModalInstance.dismiss("cancel")}}),angular.module("handyforall.messages").controller("chatCtrl",chatCtrl),chatCtrl.$inject=["ChatServiceResolve","$state","toastr","$filter","AuthenticationService","TaskProfileResolve","MainService","$stateParams","socket","$scope","$rootScope","TaskServiceResolve","TaskService","CurrentuserResolve","$translate","$uibModal"],angular.module("handyforall.messages").controller("ConfirmtaskModel",function($uibModalInstance){this.ok=function(){$uibModalInstance.close("ok")},this.cancel=function(){$uibModalInstance.dismiss("cancel")}});(app=angular.module("handyforall.messages")).factory("socket",socket);(app=angular.module("handyforall.messages")).factory("MessageService",MessageService),angular.module("handyforall.notifications").controller("notificationCtrl",notificationCtrl),notificationCtrl.$inject=["NotificationsResolve","NotificationService","toastr","$rootScope","$translate","$scope","accountProfileResolve","$state","$cookieStore"];(app=angular.module("handyforall.notifications")).factory("NotificationService",NotificationService),angular.module("handyforall.category").controller("carddetailCtrl",carddetailCtrl),carddetailCtrl.$inject=["$scope","$rootScope","$window","$stateParams","$state","CarddetailResolve","CarddetailService","MainService","CurrentUserResolve","$translate","$location","$anchorScroll","toastr"],angular.module("handyforall.category").controller("paypalfaileddetailCtrl",paypalfaileddetailCtrl),paypalfaileddetailCtrl.$inject=["$scope","$rootScope","$window","$stateParams","$state","paypaltaskid"];(app=angular.module("handyforall.carddeatil")).factory("CarddetailService",CarddetailService),angular.module("handyforall.page").controller("pagesCtrl",pagesCtrl),pagesCtrl.$inject=["$scope","$rootScope","$location","$stateParams","PagesserviceResolve","PageService","$state","$sce","$translate","ngMeta","$cookies"];(app=angular.module("handyforall.category")).factory("PageService",PageService),angular.module("handyforall.faq").controller("faqCtrl",faqCtrl),faqCtrl.$inject=["$scope","$rootScope","$location","$stateParams","FaqserviceResolve","FaqService","$state","$sce","$translate"],angular.module("handyforall.forgotpassword").controller("emergencyCtrl",emergencyCtrl),emergencyCtrl.$inject=["$scope","toastr","ForgotpasswordService","$stateParams","$translate","$state"];(app=angular.module("handyforall.faq")).factory("FaqService",FaqService),angular.module("handyforall.forgotpassword").controller("pwdloginCtrl",pwdloginCtrl),pwdloginCtrl.$inject=["$scope","ForgotpasswordService","toastr","$translate","$stateParams"],angular.module("handyforall.forgotpassword").controller("pwdmailCtrl",pwdmailCtrl),pwdmailCtrl.$inject=["$scope","toastr","ForgotpasswordService","$state","$stateParams","$translate"];(app=angular.module("handyforall.authentication")).factory("ForgotpasswordService",ForgotpasswordService);var app;(app=angular.module("handyforall.authentication")).factory("ForgotpwduserService",ForgotpwduserService),angular.module("handyforall.forgotpassword").controller("otploginCtrl",otploginCtrl),otploginCtrl.$inject=["$scope","$state","ForgotpwduserService","toastr","$translate","$stateParams","AuthenticationService","$cookieStore","$location"];